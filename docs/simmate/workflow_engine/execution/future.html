<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.2"/>
    <title>simmate.workflow_engine.execution.future API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../execution.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;simmate.workflow_engine.execution</a>

<a href="https://github.com/jacksund/simmate">            <img src="https://github.com/jacksund/simmate/blob/main/src/simmate/website/static_files/images/simmate-logo.svg?raw=true" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#DjangoFuture">DjangoFuture</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DjangoFuture.__init__">DjangoFuture</a>
                        </li>
                        <li>
                                <a class="function" href="#DjangoFuture.cancel">cancel</a>
                        </li>
                        <li>
                                <a class="function" href="#DjangoFuture.cancelled">cancelled</a>
                        </li>
                        <li>
                                <a class="function" href="#DjangoFuture.running">running</a>
                        </li>
                        <li>
                                <a class="function" href="#DjangoFuture.done">done</a>
                        </li>
                        <li>
                                <a class="function" href="#DjangoFuture.result">result</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CancelledError">CancelledError</a>
                            <ul class="memberlist">
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/jacksund/simmate/tree/main/src/simmate/workflow_engine/execution/future.py">Edit on GitHub</a>
                    <h1 class="modulename">
<a href="./../../../simmate.html">simmate</a><wbr>.<a href="./../../workflow_engine.html">workflow_engine</a><wbr>.<a href="./../execution.html">execution</a><wbr>.future    </h1>

                
                        <input id="future-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="future-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="c1"># import pickle</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">import</span> <span class="nn">cloudpickle</span>  <span class="c1"># needed to serialize Prefect workflow runs and tasks</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="c1"># from concurrent.futures import Future # No need to inherit at the moment</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">simmate.workflow_engine.execution.database</span> <span class="kn">import</span> <span class="n">WorkItem</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="c1"># class based on...</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="c1"># https://docs.python.org/3/library/concurrent.futures.html</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="c1"># Some methods still need to be added, but I have no need for them yet.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="c1"># locking rows is done by...</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="c1"># https://docs.djangoproject.com/en/3.1/ref/models/querysets/#select-for-update</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="k">class</span> <span class="nc">DjangoFuture</span><span class="p">:</span>  <span class="c1"># (Future)</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>        <span class="c1"># This is the WorkItem personal key which tells us which row in the table</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>        <span class="c1"># we should loook at.</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pk</span> <span class="o">=</span> <span class="n">pk</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">        Attempt to cancel the call. If the call is currently being executed or</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">        finished running and cannot be cancelled then the method will return</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">        False, otherwise the call will be cancelled and the method will return</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        True.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>        <span class="c1"># Query the WorkItem, lock it for editting, and check the status.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_for_update</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>        <span class="c1"># check if the status is *not* PENDING</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>            <span class="c1"># if so, the job is already running or finished, in which case</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>            <span class="c1"># we can&#39;t cancel it.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>            <span class="c1"># If it is still pending, we can go ahead and cancel it.</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>            <span class="c1"># This does not delete the task from the queue database though</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>            <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>            <span class="n">workitem</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    <span class="k">def</span> <span class="nf">cancelled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">        Return True if the call was successfully cancelled.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="c1"># check the status and indicate whether it is CANCELED or not</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="k">def</span> <span class="nf">running</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        Return True if the call is currently being executed and cannot be cancelled.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>        <span class="c1"># check the status and indicate whether it is RUNNING or not</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="nf">done</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        Return True if the call was successfully cancelled or finished running.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        <span class="c1"># check the status and indicate whether it is FINISHED or CANCELED</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;F&quot;</span> <span class="ow">or</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sleep_step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">        Return the value returned by the call. If the call hasn’t yet completed</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        then this method will wait up to timeout seconds. If the call hasn’t</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        completed in timeout seconds, then a concurrent.futures.TimeoutError</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        will be raised. timeout can be an int or float. If timeout is not</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        specified or None, there is no limit to the wait time.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        If the future is cancelled before completing then CancelledError</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        will be raised.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        If the call raised, this method will raise the same exception.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="c1"># if no timeout was set, use infinity so we wait forever.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">timeout</span><span class="p">:</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>            <span class="n">timeout</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="c1"># Loop endlessly until the job completes or we timeout</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="k">while</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">timeout</span><span class="p">:</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>            <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>            <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span>  <span class="c1"># FINISHED</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>                <span class="c1"># grab the result, unpickle it, and return it</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">workitem</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>                <span class="c1"># if the result is an Error or Exception, raise it</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>                    <span class="k">raise</span> <span class="n">result</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>                <span class="c1"># otherwise return the result as-s</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>                    <span class="k">return</span> <span class="n">result</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>  <span class="c1"># CANCELED</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                <span class="k">raise</span> <span class="n">CancelledError</span><span class="p">(</span><span class="s2">&quot;This item was cancelled and has no result&quot;</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;P&quot;</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span>  <span class="c1"># PENDING or RUNNING</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                <span class="c1"># sleep the set amount before restarting the while loop</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_step</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="c1"># if the loop exits and we reached this line, then we&#39;ve hit the timeout</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;The time-limit to wait for this result has been exceeded&quot;</span><span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="k">class</span> <span class="nc">CancelledError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="k">pass</span>
</span></pre></div>


            </section>
                <section id="DjangoFuture">
                            <input id="DjangoFuture-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DjangoFuture</span>:

                <label class="view-source-button" for="DjangoFuture-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DjangoFuture"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DjangoFuture-21"><a href="#DjangoFuture-21"><span class="linenos"> 21</span></a><span class="k">class</span> <span class="nc">DjangoFuture</span><span class="p">:</span>  <span class="c1"># (Future)</span>
</span><span id="DjangoFuture-22"><a href="#DjangoFuture-22"><span class="linenos"> 22</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
</span><span id="DjangoFuture-23"><a href="#DjangoFuture-23"><span class="linenos"> 23</span></a>
</span><span id="DjangoFuture-24"><a href="#DjangoFuture-24"><span class="linenos"> 24</span></a>        <span class="c1"># This is the WorkItem personal key which tells us which row in the table</span>
</span><span id="DjangoFuture-25"><a href="#DjangoFuture-25"><span class="linenos"> 25</span></a>        <span class="c1"># we should loook at.</span>
</span><span id="DjangoFuture-26"><a href="#DjangoFuture-26"><span class="linenos"> 26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pk</span> <span class="o">=</span> <span class="n">pk</span>
</span><span id="DjangoFuture-27"><a href="#DjangoFuture-27"><span class="linenos"> 27</span></a>
</span><span id="DjangoFuture-28"><a href="#DjangoFuture-28"><span class="linenos"> 28</span></a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DjangoFuture-29"><a href="#DjangoFuture-29"><span class="linenos"> 29</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture-30"><a href="#DjangoFuture-30"><span class="linenos"> 30</span></a><span class="sd">        Attempt to cancel the call. If the call is currently being executed or</span>
</span><span id="DjangoFuture-31"><a href="#DjangoFuture-31"><span class="linenos"> 31</span></a><span class="sd">        finished running and cannot be cancelled then the method will return</span>
</span><span id="DjangoFuture-32"><a href="#DjangoFuture-32"><span class="linenos"> 32</span></a><span class="sd">        False, otherwise the call will be cancelled and the method will return</span>
</span><span id="DjangoFuture-33"><a href="#DjangoFuture-33"><span class="linenos"> 33</span></a><span class="sd">        True.</span>
</span><span id="DjangoFuture-34"><a href="#DjangoFuture-34"><span class="linenos"> 34</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture-35"><a href="#DjangoFuture-35"><span class="linenos"> 35</span></a>        <span class="c1"># Query the WorkItem, lock it for editting, and check the status.</span>
</span><span id="DjangoFuture-36"><a href="#DjangoFuture-36"><span class="linenos"> 36</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_for_update</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture-37"><a href="#DjangoFuture-37"><span class="linenos"> 37</span></a>
</span><span id="DjangoFuture-38"><a href="#DjangoFuture-38"><span class="linenos"> 38</span></a>        <span class="c1"># check if the status is *not* PENDING</span>
</span><span id="DjangoFuture-39"><a href="#DjangoFuture-39"><span class="linenos"> 39</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
</span><span id="DjangoFuture-40"><a href="#DjangoFuture-40"><span class="linenos"> 40</span></a>            <span class="c1"># if so, the job is already running or finished, in which case</span>
</span><span id="DjangoFuture-41"><a href="#DjangoFuture-41"><span class="linenos"> 41</span></a>            <span class="c1"># we can&#39;t cancel it.</span>
</span><span id="DjangoFuture-42"><a href="#DjangoFuture-42"><span class="linenos"> 42</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="DjangoFuture-43"><a href="#DjangoFuture-43"><span class="linenos"> 43</span></a>
</span><span id="DjangoFuture-44"><a href="#DjangoFuture-44"><span class="linenos"> 44</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture-45"><a href="#DjangoFuture-45"><span class="linenos"> 45</span></a>            <span class="c1"># If it is still pending, we can go ahead and cancel it.</span>
</span><span id="DjangoFuture-46"><a href="#DjangoFuture-46"><span class="linenos"> 46</span></a>            <span class="c1"># This does not delete the task from the queue database though</span>
</span><span id="DjangoFuture-47"><a href="#DjangoFuture-47"><span class="linenos"> 47</span></a>            <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
</span><span id="DjangoFuture-48"><a href="#DjangoFuture-48"><span class="linenos"> 48</span></a>            <span class="n">workitem</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="DjangoFuture-49"><a href="#DjangoFuture-49"><span class="linenos"> 49</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="DjangoFuture-50"><a href="#DjangoFuture-50"><span class="linenos"> 50</span></a>
</span><span id="DjangoFuture-51"><a href="#DjangoFuture-51"><span class="linenos"> 51</span></a>    <span class="k">def</span> <span class="nf">cancelled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DjangoFuture-52"><a href="#DjangoFuture-52"><span class="linenos"> 52</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture-53"><a href="#DjangoFuture-53"><span class="linenos"> 53</span></a><span class="sd">        Return True if the call was successfully cancelled.</span>
</span><span id="DjangoFuture-54"><a href="#DjangoFuture-54"><span class="linenos"> 54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture-55"><a href="#DjangoFuture-55"><span class="linenos"> 55</span></a>        <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="DjangoFuture-56"><a href="#DjangoFuture-56"><span class="linenos"> 56</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture-57"><a href="#DjangoFuture-57"><span class="linenos"> 57</span></a>
</span><span id="DjangoFuture-58"><a href="#DjangoFuture-58"><span class="linenos"> 58</span></a>        <span class="c1"># check the status and indicate whether it is CANCELED or not</span>
</span><span id="DjangoFuture-59"><a href="#DjangoFuture-59"><span class="linenos"> 59</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
</span><span id="DjangoFuture-60"><a href="#DjangoFuture-60"><span class="linenos"> 60</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="DjangoFuture-61"><a href="#DjangoFuture-61"><span class="linenos"> 61</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture-62"><a href="#DjangoFuture-62"><span class="linenos"> 62</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="DjangoFuture-63"><a href="#DjangoFuture-63"><span class="linenos"> 63</span></a>
</span><span id="DjangoFuture-64"><a href="#DjangoFuture-64"><span class="linenos"> 64</span></a>    <span class="k">def</span> <span class="nf">running</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DjangoFuture-65"><a href="#DjangoFuture-65"><span class="linenos"> 65</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture-66"><a href="#DjangoFuture-66"><span class="linenos"> 66</span></a><span class="sd">        Return True if the call is currently being executed and cannot be cancelled.</span>
</span><span id="DjangoFuture-67"><a href="#DjangoFuture-67"><span class="linenos"> 67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture-68"><a href="#DjangoFuture-68"><span class="linenos"> 68</span></a>        <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="DjangoFuture-69"><a href="#DjangoFuture-69"><span class="linenos"> 69</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture-70"><a href="#DjangoFuture-70"><span class="linenos"> 70</span></a>
</span><span id="DjangoFuture-71"><a href="#DjangoFuture-71"><span class="linenos"> 71</span></a>        <span class="c1"># check the status and indicate whether it is RUNNING or not</span>
</span><span id="DjangoFuture-72"><a href="#DjangoFuture-72"><span class="linenos"> 72</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span>
</span><span id="DjangoFuture-73"><a href="#DjangoFuture-73"><span class="linenos"> 73</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="DjangoFuture-74"><a href="#DjangoFuture-74"><span class="linenos"> 74</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture-75"><a href="#DjangoFuture-75"><span class="linenos"> 75</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="DjangoFuture-76"><a href="#DjangoFuture-76"><span class="linenos"> 76</span></a>
</span><span id="DjangoFuture-77"><a href="#DjangoFuture-77"><span class="linenos"> 77</span></a>    <span class="k">def</span> <span class="nf">done</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DjangoFuture-78"><a href="#DjangoFuture-78"><span class="linenos"> 78</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture-79"><a href="#DjangoFuture-79"><span class="linenos"> 79</span></a><span class="sd">        Return True if the call was successfully cancelled or finished running.</span>
</span><span id="DjangoFuture-80"><a href="#DjangoFuture-80"><span class="linenos"> 80</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture-81"><a href="#DjangoFuture-81"><span class="linenos"> 81</span></a>        <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="DjangoFuture-82"><a href="#DjangoFuture-82"><span class="linenos"> 82</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture-83"><a href="#DjangoFuture-83"><span class="linenos"> 83</span></a>
</span><span id="DjangoFuture-84"><a href="#DjangoFuture-84"><span class="linenos"> 84</span></a>        <span class="c1"># check the status and indicate whether it is FINISHED or CANCELED</span>
</span><span id="DjangoFuture-85"><a href="#DjangoFuture-85"><span class="linenos"> 85</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;F&quot;</span> <span class="ow">or</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
</span><span id="DjangoFuture-86"><a href="#DjangoFuture-86"><span class="linenos"> 86</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="DjangoFuture-87"><a href="#DjangoFuture-87"><span class="linenos"> 87</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture-88"><a href="#DjangoFuture-88"><span class="linenos"> 88</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="DjangoFuture-89"><a href="#DjangoFuture-89"><span class="linenos"> 89</span></a>
</span><span id="DjangoFuture-90"><a href="#DjangoFuture-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sleep_step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="DjangoFuture-91"><a href="#DjangoFuture-91"><span class="linenos"> 91</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture-92"><a href="#DjangoFuture-92"><span class="linenos"> 92</span></a><span class="sd">        Return the value returned by the call. If the call hasn’t yet completed</span>
</span><span id="DjangoFuture-93"><a href="#DjangoFuture-93"><span class="linenos"> 93</span></a><span class="sd">        then this method will wait up to timeout seconds. If the call hasn’t</span>
</span><span id="DjangoFuture-94"><a href="#DjangoFuture-94"><span class="linenos"> 94</span></a><span class="sd">        completed in timeout seconds, then a concurrent.futures.TimeoutError</span>
</span><span id="DjangoFuture-95"><a href="#DjangoFuture-95"><span class="linenos"> 95</span></a><span class="sd">        will be raised. timeout can be an int or float. If timeout is not</span>
</span><span id="DjangoFuture-96"><a href="#DjangoFuture-96"><span class="linenos"> 96</span></a><span class="sd">        specified or None, there is no limit to the wait time.</span>
</span><span id="DjangoFuture-97"><a href="#DjangoFuture-97"><span class="linenos"> 97</span></a>
</span><span id="DjangoFuture-98"><a href="#DjangoFuture-98"><span class="linenos"> 98</span></a><span class="sd">        If the future is cancelled before completing then CancelledError</span>
</span><span id="DjangoFuture-99"><a href="#DjangoFuture-99"><span class="linenos"> 99</span></a><span class="sd">        will be raised.</span>
</span><span id="DjangoFuture-100"><a href="#DjangoFuture-100"><span class="linenos">100</span></a>
</span><span id="DjangoFuture-101"><a href="#DjangoFuture-101"><span class="linenos">101</span></a><span class="sd">        If the call raised, this method will raise the same exception.</span>
</span><span id="DjangoFuture-102"><a href="#DjangoFuture-102"><span class="linenos">102</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture-103"><a href="#DjangoFuture-103"><span class="linenos">103</span></a>        <span class="c1"># if no timeout was set, use infinity so we wait forever.</span>
</span><span id="DjangoFuture-104"><a href="#DjangoFuture-104"><span class="linenos">104</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">timeout</span><span class="p">:</span>
</span><span id="DjangoFuture-105"><a href="#DjangoFuture-105"><span class="linenos">105</span></a>            <span class="n">timeout</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
</span><span id="DjangoFuture-106"><a href="#DjangoFuture-106"><span class="linenos">106</span></a>
</span><span id="DjangoFuture-107"><a href="#DjangoFuture-107"><span class="linenos">107</span></a>        <span class="c1"># Loop endlessly until the job completes or we timeout</span>
</span><span id="DjangoFuture-108"><a href="#DjangoFuture-108"><span class="linenos">108</span></a>        <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DjangoFuture-109"><a href="#DjangoFuture-109"><span class="linenos">109</span></a>
</span><span id="DjangoFuture-110"><a href="#DjangoFuture-110"><span class="linenos">110</span></a>        <span class="k">while</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">timeout</span><span class="p">:</span>
</span><span id="DjangoFuture-111"><a href="#DjangoFuture-111"><span class="linenos">111</span></a>            <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="DjangoFuture-112"><a href="#DjangoFuture-112"><span class="linenos">112</span></a>            <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture-113"><a href="#DjangoFuture-113"><span class="linenos">113</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span>
</span><span id="DjangoFuture-114"><a href="#DjangoFuture-114"><span class="linenos">114</span></a>
</span><span id="DjangoFuture-115"><a href="#DjangoFuture-115"><span class="linenos">115</span></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span>  <span class="c1"># FINISHED</span>
</span><span id="DjangoFuture-116"><a href="#DjangoFuture-116"><span class="linenos">116</span></a>                <span class="c1"># grab the result, unpickle it, and return it</span>
</span><span id="DjangoFuture-117"><a href="#DjangoFuture-117"><span class="linenos">117</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">workitem</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</span><span id="DjangoFuture-118"><a href="#DjangoFuture-118"><span class="linenos">118</span></a>                <span class="c1"># if the result is an Error or Exception, raise it</span>
</span><span id="DjangoFuture-119"><a href="#DjangoFuture-119"><span class="linenos">119</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>
</span><span id="DjangoFuture-120"><a href="#DjangoFuture-120"><span class="linenos">120</span></a>                    <span class="k">raise</span> <span class="n">result</span>
</span><span id="DjangoFuture-121"><a href="#DjangoFuture-121"><span class="linenos">121</span></a>                <span class="c1"># otherwise return the result as-s</span>
</span><span id="DjangoFuture-122"><a href="#DjangoFuture-122"><span class="linenos">122</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture-123"><a href="#DjangoFuture-123"><span class="linenos">123</span></a>                    <span class="k">return</span> <span class="n">result</span>
</span><span id="DjangoFuture-124"><a href="#DjangoFuture-124"><span class="linenos">124</span></a>
</span><span id="DjangoFuture-125"><a href="#DjangoFuture-125"><span class="linenos">125</span></a>            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>  <span class="c1"># CANCELED</span>
</span><span id="DjangoFuture-126"><a href="#DjangoFuture-126"><span class="linenos">126</span></a>                <span class="k">raise</span> <span class="n">CancelledError</span><span class="p">(</span><span class="s2">&quot;This item was cancelled and has no result&quot;</span><span class="p">)</span>
</span><span id="DjangoFuture-127"><a href="#DjangoFuture-127"><span class="linenos">127</span></a>
</span><span id="DjangoFuture-128"><a href="#DjangoFuture-128"><span class="linenos">128</span></a>            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;P&quot;</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span>  <span class="c1"># PENDING or RUNNING</span>
</span><span id="DjangoFuture-129"><a href="#DjangoFuture-129"><span class="linenos">129</span></a>                <span class="c1"># sleep the set amount before restarting the while loop</span>
</span><span id="DjangoFuture-130"><a href="#DjangoFuture-130"><span class="linenos">130</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_step</span><span class="p">)</span>
</span><span id="DjangoFuture-131"><a href="#DjangoFuture-131"><span class="linenos">131</span></a>
</span><span id="DjangoFuture-132"><a href="#DjangoFuture-132"><span class="linenos">132</span></a>        <span class="c1"># if the loop exits and we reached this line, then we&#39;ve hit the timeout</span>
</span><span id="DjangoFuture-133"><a href="#DjangoFuture-133"><span class="linenos">133</span></a>        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;The time-limit to wait for this result has been exceeded&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            <div id="DjangoFuture.__init__" class="classattr">
                                        <input id="DjangoFuture.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DjangoFuture</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pk</span></span>)</span>

                <label class="view-source-button" for="DjangoFuture.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DjangoFuture.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DjangoFuture.__init__-22"><a href="#DjangoFuture.__init__-22"><span class="linenos">22</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
</span><span id="DjangoFuture.__init__-23"><a href="#DjangoFuture.__init__-23"><span class="linenos">23</span></a>
</span><span id="DjangoFuture.__init__-24"><a href="#DjangoFuture.__init__-24"><span class="linenos">24</span></a>        <span class="c1"># This is the WorkItem personal key which tells us which row in the table</span>
</span><span id="DjangoFuture.__init__-25"><a href="#DjangoFuture.__init__-25"><span class="linenos">25</span></a>        <span class="c1"># we should loook at.</span>
</span><span id="DjangoFuture.__init__-26"><a href="#DjangoFuture.__init__-26"><span class="linenos">26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pk</span> <span class="o">=</span> <span class="n">pk</span>
</span></pre></div>


    

                            </div>
                            <div id="DjangoFuture.cancel" class="classattr">
                                        <input id="DjangoFuture.cancel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cancel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="DjangoFuture.cancel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DjangoFuture.cancel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DjangoFuture.cancel-28"><a href="#DjangoFuture.cancel-28"><span class="linenos">28</span></a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DjangoFuture.cancel-29"><a href="#DjangoFuture.cancel-29"><span class="linenos">29</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture.cancel-30"><a href="#DjangoFuture.cancel-30"><span class="linenos">30</span></a><span class="sd">        Attempt to cancel the call. If the call is currently being executed or</span>
</span><span id="DjangoFuture.cancel-31"><a href="#DjangoFuture.cancel-31"><span class="linenos">31</span></a><span class="sd">        finished running and cannot be cancelled then the method will return</span>
</span><span id="DjangoFuture.cancel-32"><a href="#DjangoFuture.cancel-32"><span class="linenos">32</span></a><span class="sd">        False, otherwise the call will be cancelled and the method will return</span>
</span><span id="DjangoFuture.cancel-33"><a href="#DjangoFuture.cancel-33"><span class="linenos">33</span></a><span class="sd">        True.</span>
</span><span id="DjangoFuture.cancel-34"><a href="#DjangoFuture.cancel-34"><span class="linenos">34</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture.cancel-35"><a href="#DjangoFuture.cancel-35"><span class="linenos">35</span></a>        <span class="c1"># Query the WorkItem, lock it for editting, and check the status.</span>
</span><span id="DjangoFuture.cancel-36"><a href="#DjangoFuture.cancel-36"><span class="linenos">36</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_for_update</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture.cancel-37"><a href="#DjangoFuture.cancel-37"><span class="linenos">37</span></a>
</span><span id="DjangoFuture.cancel-38"><a href="#DjangoFuture.cancel-38"><span class="linenos">38</span></a>        <span class="c1"># check if the status is *not* PENDING</span>
</span><span id="DjangoFuture.cancel-39"><a href="#DjangoFuture.cancel-39"><span class="linenos">39</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
</span><span id="DjangoFuture.cancel-40"><a href="#DjangoFuture.cancel-40"><span class="linenos">40</span></a>            <span class="c1"># if so, the job is already running or finished, in which case</span>
</span><span id="DjangoFuture.cancel-41"><a href="#DjangoFuture.cancel-41"><span class="linenos">41</span></a>            <span class="c1"># we can&#39;t cancel it.</span>
</span><span id="DjangoFuture.cancel-42"><a href="#DjangoFuture.cancel-42"><span class="linenos">42</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="DjangoFuture.cancel-43"><a href="#DjangoFuture.cancel-43"><span class="linenos">43</span></a>
</span><span id="DjangoFuture.cancel-44"><a href="#DjangoFuture.cancel-44"><span class="linenos">44</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture.cancel-45"><a href="#DjangoFuture.cancel-45"><span class="linenos">45</span></a>            <span class="c1"># If it is still pending, we can go ahead and cancel it.</span>
</span><span id="DjangoFuture.cancel-46"><a href="#DjangoFuture.cancel-46"><span class="linenos">46</span></a>            <span class="c1"># This does not delete the task from the queue database though</span>
</span><span id="DjangoFuture.cancel-47"><a href="#DjangoFuture.cancel-47"><span class="linenos">47</span></a>            <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
</span><span id="DjangoFuture.cancel-48"><a href="#DjangoFuture.cancel-48"><span class="linenos">48</span></a>            <span class="n">workitem</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="DjangoFuture.cancel-49"><a href="#DjangoFuture.cancel-49"><span class="linenos">49</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Attempt to cancel the call. If the call is currently being executed or
finished running and cannot be cancelled then the method will return
False, otherwise the call will be cancelled and the method will return
True.</p>
</div>


                            </div>
                            <div id="DjangoFuture.cancelled" class="classattr">
                                        <input id="DjangoFuture.cancelled-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cancelled</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="DjangoFuture.cancelled-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DjangoFuture.cancelled"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DjangoFuture.cancelled-51"><a href="#DjangoFuture.cancelled-51"><span class="linenos">51</span></a>    <span class="k">def</span> <span class="nf">cancelled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DjangoFuture.cancelled-52"><a href="#DjangoFuture.cancelled-52"><span class="linenos">52</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture.cancelled-53"><a href="#DjangoFuture.cancelled-53"><span class="linenos">53</span></a><span class="sd">        Return True if the call was successfully cancelled.</span>
</span><span id="DjangoFuture.cancelled-54"><a href="#DjangoFuture.cancelled-54"><span class="linenos">54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture.cancelled-55"><a href="#DjangoFuture.cancelled-55"><span class="linenos">55</span></a>        <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="DjangoFuture.cancelled-56"><a href="#DjangoFuture.cancelled-56"><span class="linenos">56</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture.cancelled-57"><a href="#DjangoFuture.cancelled-57"><span class="linenos">57</span></a>
</span><span id="DjangoFuture.cancelled-58"><a href="#DjangoFuture.cancelled-58"><span class="linenos">58</span></a>        <span class="c1"># check the status and indicate whether it is CANCELED or not</span>
</span><span id="DjangoFuture.cancelled-59"><a href="#DjangoFuture.cancelled-59"><span class="linenos">59</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
</span><span id="DjangoFuture.cancelled-60"><a href="#DjangoFuture.cancelled-60"><span class="linenos">60</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="DjangoFuture.cancelled-61"><a href="#DjangoFuture.cancelled-61"><span class="linenos">61</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture.cancelled-62"><a href="#DjangoFuture.cancelled-62"><span class="linenos">62</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the call was successfully cancelled.</p>
</div>


                            </div>
                            <div id="DjangoFuture.running" class="classattr">
                                        <input id="DjangoFuture.running-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">running</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="DjangoFuture.running-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DjangoFuture.running"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DjangoFuture.running-64"><a href="#DjangoFuture.running-64"><span class="linenos">64</span></a>    <span class="k">def</span> <span class="nf">running</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DjangoFuture.running-65"><a href="#DjangoFuture.running-65"><span class="linenos">65</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture.running-66"><a href="#DjangoFuture.running-66"><span class="linenos">66</span></a><span class="sd">        Return True if the call is currently being executed and cannot be cancelled.</span>
</span><span id="DjangoFuture.running-67"><a href="#DjangoFuture.running-67"><span class="linenos">67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture.running-68"><a href="#DjangoFuture.running-68"><span class="linenos">68</span></a>        <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="DjangoFuture.running-69"><a href="#DjangoFuture.running-69"><span class="linenos">69</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture.running-70"><a href="#DjangoFuture.running-70"><span class="linenos">70</span></a>
</span><span id="DjangoFuture.running-71"><a href="#DjangoFuture.running-71"><span class="linenos">71</span></a>        <span class="c1"># check the status and indicate whether it is RUNNING or not</span>
</span><span id="DjangoFuture.running-72"><a href="#DjangoFuture.running-72"><span class="linenos">72</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span>
</span><span id="DjangoFuture.running-73"><a href="#DjangoFuture.running-73"><span class="linenos">73</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="DjangoFuture.running-74"><a href="#DjangoFuture.running-74"><span class="linenos">74</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture.running-75"><a href="#DjangoFuture.running-75"><span class="linenos">75</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the call is currently being executed and cannot be cancelled.</p>
</div>


                            </div>
                            <div id="DjangoFuture.done" class="classattr">
                                        <input id="DjangoFuture.done-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">done</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="DjangoFuture.done-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DjangoFuture.done"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DjangoFuture.done-77"><a href="#DjangoFuture.done-77"><span class="linenos">77</span></a>    <span class="k">def</span> <span class="nf">done</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DjangoFuture.done-78"><a href="#DjangoFuture.done-78"><span class="linenos">78</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture.done-79"><a href="#DjangoFuture.done-79"><span class="linenos">79</span></a><span class="sd">        Return True if the call was successfully cancelled or finished running.</span>
</span><span id="DjangoFuture.done-80"><a href="#DjangoFuture.done-80"><span class="linenos">80</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture.done-81"><a href="#DjangoFuture.done-81"><span class="linenos">81</span></a>        <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="DjangoFuture.done-82"><a href="#DjangoFuture.done-82"><span class="linenos">82</span></a>        <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture.done-83"><a href="#DjangoFuture.done-83"><span class="linenos">83</span></a>
</span><span id="DjangoFuture.done-84"><a href="#DjangoFuture.done-84"><span class="linenos">84</span></a>        <span class="c1"># check the status and indicate whether it is FINISHED or CANCELED</span>
</span><span id="DjangoFuture.done-85"><a href="#DjangoFuture.done-85"><span class="linenos">85</span></a>        <span class="k">if</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;F&quot;</span> <span class="ow">or</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
</span><span id="DjangoFuture.done-86"><a href="#DjangoFuture.done-86"><span class="linenos">86</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="DjangoFuture.done-87"><a href="#DjangoFuture.done-87"><span class="linenos">87</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture.done-88"><a href="#DjangoFuture.done-88"><span class="linenos">88</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Return True if the call was successfully cancelled or finished running.</p>
</div>


                            </div>
                            <div id="DjangoFuture.result" class="classattr">
                                        <input id="DjangoFuture.result-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">result</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">timeout</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">sleep_step</span><span class="o">=</span><span class="mf">0.1</span></span>)</span>

                <label class="view-source-button" for="DjangoFuture.result-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DjangoFuture.result"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DjangoFuture.result-90"><a href="#DjangoFuture.result-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sleep_step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="DjangoFuture.result-91"><a href="#DjangoFuture.result-91"><span class="linenos"> 91</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DjangoFuture.result-92"><a href="#DjangoFuture.result-92"><span class="linenos"> 92</span></a><span class="sd">        Return the value returned by the call. If the call hasn’t yet completed</span>
</span><span id="DjangoFuture.result-93"><a href="#DjangoFuture.result-93"><span class="linenos"> 93</span></a><span class="sd">        then this method will wait up to timeout seconds. If the call hasn’t</span>
</span><span id="DjangoFuture.result-94"><a href="#DjangoFuture.result-94"><span class="linenos"> 94</span></a><span class="sd">        completed in timeout seconds, then a concurrent.futures.TimeoutError</span>
</span><span id="DjangoFuture.result-95"><a href="#DjangoFuture.result-95"><span class="linenos"> 95</span></a><span class="sd">        will be raised. timeout can be an int or float. If timeout is not</span>
</span><span id="DjangoFuture.result-96"><a href="#DjangoFuture.result-96"><span class="linenos"> 96</span></a><span class="sd">        specified or None, there is no limit to the wait time.</span>
</span><span id="DjangoFuture.result-97"><a href="#DjangoFuture.result-97"><span class="linenos"> 97</span></a>
</span><span id="DjangoFuture.result-98"><a href="#DjangoFuture.result-98"><span class="linenos"> 98</span></a><span class="sd">        If the future is cancelled before completing then CancelledError</span>
</span><span id="DjangoFuture.result-99"><a href="#DjangoFuture.result-99"><span class="linenos"> 99</span></a><span class="sd">        will be raised.</span>
</span><span id="DjangoFuture.result-100"><a href="#DjangoFuture.result-100"><span class="linenos">100</span></a>
</span><span id="DjangoFuture.result-101"><a href="#DjangoFuture.result-101"><span class="linenos">101</span></a><span class="sd">        If the call raised, this method will raise the same exception.</span>
</span><span id="DjangoFuture.result-102"><a href="#DjangoFuture.result-102"><span class="linenos">102</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DjangoFuture.result-103"><a href="#DjangoFuture.result-103"><span class="linenos">103</span></a>        <span class="c1"># if no timeout was set, use infinity so we wait forever.</span>
</span><span id="DjangoFuture.result-104"><a href="#DjangoFuture.result-104"><span class="linenos">104</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">timeout</span><span class="p">:</span>
</span><span id="DjangoFuture.result-105"><a href="#DjangoFuture.result-105"><span class="linenos">105</span></a>            <span class="n">timeout</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
</span><span id="DjangoFuture.result-106"><a href="#DjangoFuture.result-106"><span class="linenos">106</span></a>
</span><span id="DjangoFuture.result-107"><a href="#DjangoFuture.result-107"><span class="linenos">107</span></a>        <span class="c1"># Loop endlessly until the job completes or we timeout</span>
</span><span id="DjangoFuture.result-108"><a href="#DjangoFuture.result-108"><span class="linenos">108</span></a>        <span class="n">time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DjangoFuture.result-109"><a href="#DjangoFuture.result-109"><span class="linenos">109</span></a>
</span><span id="DjangoFuture.result-110"><a href="#DjangoFuture.result-110"><span class="linenos">110</span></a>        <span class="k">while</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">timeout</span><span class="p">:</span>
</span><span id="DjangoFuture.result-111"><a href="#DjangoFuture.result-111"><span class="linenos">111</span></a>            <span class="c1"># I don&#39;t use a lock to check the status here</span>
</span><span id="DjangoFuture.result-112"><a href="#DjangoFuture.result-112"><span class="linenos">112</span></a>            <span class="n">workitem</span> <span class="o">=</span> <span class="n">WorkItem</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
</span><span id="DjangoFuture.result-113"><a href="#DjangoFuture.result-113"><span class="linenos">113</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">workitem</span><span class="o">.</span><span class="n">status</span>
</span><span id="DjangoFuture.result-114"><a href="#DjangoFuture.result-114"><span class="linenos">114</span></a>
</span><span id="DjangoFuture.result-115"><a href="#DjangoFuture.result-115"><span class="linenos">115</span></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span>  <span class="c1"># FINISHED</span>
</span><span id="DjangoFuture.result-116"><a href="#DjangoFuture.result-116"><span class="linenos">116</span></a>                <span class="c1"># grab the result, unpickle it, and return it</span>
</span><span id="DjangoFuture.result-117"><a href="#DjangoFuture.result-117"><span class="linenos">117</span></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">workitem</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</span><span id="DjangoFuture.result-118"><a href="#DjangoFuture.result-118"><span class="linenos">118</span></a>                <span class="c1"># if the result is an Error or Exception, raise it</span>
</span><span id="DjangoFuture.result-119"><a href="#DjangoFuture.result-119"><span class="linenos">119</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>
</span><span id="DjangoFuture.result-120"><a href="#DjangoFuture.result-120"><span class="linenos">120</span></a>                    <span class="k">raise</span> <span class="n">result</span>
</span><span id="DjangoFuture.result-121"><a href="#DjangoFuture.result-121"><span class="linenos">121</span></a>                <span class="c1"># otherwise return the result as-s</span>
</span><span id="DjangoFuture.result-122"><a href="#DjangoFuture.result-122"><span class="linenos">122</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="DjangoFuture.result-123"><a href="#DjangoFuture.result-123"><span class="linenos">123</span></a>                    <span class="k">return</span> <span class="n">result</span>
</span><span id="DjangoFuture.result-124"><a href="#DjangoFuture.result-124"><span class="linenos">124</span></a>
</span><span id="DjangoFuture.result-125"><a href="#DjangoFuture.result-125"><span class="linenos">125</span></a>            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>  <span class="c1"># CANCELED</span>
</span><span id="DjangoFuture.result-126"><a href="#DjangoFuture.result-126"><span class="linenos">126</span></a>                <span class="k">raise</span> <span class="n">CancelledError</span><span class="p">(</span><span class="s2">&quot;This item was cancelled and has no result&quot;</span><span class="p">)</span>
</span><span id="DjangoFuture.result-127"><a href="#DjangoFuture.result-127"><span class="linenos">127</span></a>
</span><span id="DjangoFuture.result-128"><a href="#DjangoFuture.result-128"><span class="linenos">128</span></a>            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;P&quot;</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;R&quot;</span><span class="p">:</span>  <span class="c1"># PENDING or RUNNING</span>
</span><span id="DjangoFuture.result-129"><a href="#DjangoFuture.result-129"><span class="linenos">129</span></a>                <span class="c1"># sleep the set amount before restarting the while loop</span>
</span><span id="DjangoFuture.result-130"><a href="#DjangoFuture.result-130"><span class="linenos">130</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_step</span><span class="p">)</span>
</span><span id="DjangoFuture.result-131"><a href="#DjangoFuture.result-131"><span class="linenos">131</span></a>
</span><span id="DjangoFuture.result-132"><a href="#DjangoFuture.result-132"><span class="linenos">132</span></a>        <span class="c1"># if the loop exits and we reached this line, then we&#39;ve hit the timeout</span>
</span><span id="DjangoFuture.result-133"><a href="#DjangoFuture.result-133"><span class="linenos">133</span></a>        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;The time-limit to wait for this result has been exceeded&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the value returned by the call. If the call hasn’t yet completed
then this method will wait up to timeout seconds. If the call hasn’t
completed in timeout seconds, then a concurrent.futures.TimeoutError
will be raised. timeout can be an int or float. If timeout is not
specified or None, there is no limit to the wait time.</p>

<p>If the future is cancelled before completing then CancelledError
will be raised.</p>

<p>If the call raised, this method will raise the same exception.</p>
</div>


                            </div>
                </section>
                <section id="CancelledError">
                            <input id="CancelledError-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CancelledError</span><wbr>(<span class="base">builtins.Exception</span>):

                <label class="view-source-button" for="CancelledError-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CancelledError"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CancelledError-136"><a href="#CancelledError-136"><span class="linenos">136</span></a><span class="k">class</span> <span class="nc">CancelledError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="CancelledError-137"><a href="#CancelledError-137"><span class="linenos">137</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Common base class for all non-exit exceptions.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="CancelledError.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="CancelledError.with_traceback" class="function">with_traceback</dd>
                <dd id="CancelledError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>