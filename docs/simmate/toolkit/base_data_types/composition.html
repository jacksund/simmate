<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.2"/>
    <title>simmate.toolkit.base_data_types.composition API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../base_data_types.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;simmate.toolkit.base_data_types</a>

<a href="https://github.com/jacksund/simmate">            <img src="https://github.com/jacksund/simmate/blob/main/src/simmate/website/static_files/images/simmate-logo.svg?raw=true" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#Composition">Composition</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Composition.radii_estimate">radii_estimate</a>
                        </li>
                        <li>
                                <a class="function" href="#Composition.volume_estimate">volume_estimate</a>
                        </li>
                        <li>
                                <a class="function" href="#Composition.distance_matrix_estimate">distance_matrix_estimate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Composition.chemical_subsystems">chemical_subsystems</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/jacksund/simmate/tree/main/src/simmate/toolkit/base_data_types/composition.py">Edit on GitHub</a>
                    <h1 class="modulename">
<a href="./../../../simmate.html">simmate</a><wbr>.<a href="./../../toolkit.html">toolkit</a><wbr>.<a href="./../base_data_types.html">base_data_types</a><wbr>.composition    </h1>

                        <div class="docstring"><p>This module defines the Composition class.</p>

<p>It is a very basic extension PyMatGen's core Composition class, as it only adds
a few extra methods and does not change any other usage. Note that this class
is currently NOT used by Simmate's Structure class. For Simmate, 
Structure.composition will still return a pymatgen composition object.</p>
</div>

                        <input id="composition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="composition-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">This module defines the Composition class.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">It is a very basic extension PyMatGen&#39;s core Composition class, as it only adds</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">a few extra methods and does not change any other usage. Note that this class</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">is currently NOT used by Simmate&#39;s Structure class. For Simmate, </span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">Structure.composition will still return a pymatgen composition object.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">import</span> <span class="nn">itertools</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">import</span> <span class="nn">numpy</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span> <span class="nn">pymatgen.core</span> <span class="kn">import</span> <span class="n">Composition</span> <span class="k">as</span> <span class="n">PymatgenComposition</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="k">class</span> <span class="nc">Composition</span><span class="p">(</span><span class="n">PymatgenComposition</span><span class="p">):</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    <span class="c1"># Leave docstring blank and just inherit from pymatgen</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>    <span class="k">def</span> <span class="nf">radii_estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">):</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">        Gives the reported radii for each element in the composition.</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">        - `radius_method` :</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">            Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">            The default is &quot;ionic&quot;.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        #### Returns</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">        - `radii` :</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">            A list of radii in the same order as composition.elements</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>        <span class="c1"># change the list of elements to radii list (atomic/vdw/metallic/ionic)</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>        <span class="k">if</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;atomic&quot;</span><span class="p">:</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">atomic_radius</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;atomic_calculated&quot;</span><span class="p">:</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">atomic_radius_calculated</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;van_der_waals&quot;</span><span class="p">:</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">van_der_waals_radius</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;metallic&quot;</span><span class="p">:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>                <span class="n">element</span><span class="o">.</span><span class="n">metallic_radius</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">is_metal</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>            <span class="p">]</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;ionic&quot;</span><span class="p">:</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>            <span class="c1"># In order to predict the radius here, we first need to predict the</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>            <span class="c1"># oxidation states. Note that this prediction changes composition to</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>            <span class="c1"># be made of Specie objects instead of Element objects.</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>            <span class="c1"># By converting to the reduced_composition first, we see a massive speed</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>            <span class="c1"># up -- this is done with max_sites=-1</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>            <span class="n">composition_oxi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_charges_from_oxi_state_guesses</span><span class="p">(</span><span class="n">max_sites</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>            <span class="c1"># Now we can grab the predicted radii</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>            <span class="c1"># If the estimated oxidation state is zero OR if the predicted oxidation</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>            <span class="c1"># state does not have an available radius (e.g H+ doesn&#39;t have a reported</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>            <span class="c1"># radius in our dataset), I grab the atomic radius.</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>            <span class="c1"># BUG: This will print a lot of warnings when the ionic radius doesn&#39;t exist.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>            <span class="c1"># I expect these warnings, so I choose to suppress them here.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>  <span class="c1"># dont print the warnings!</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>                <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">composition_oxi</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>                    <span class="c1"># attempt to grab the radius</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>                    <span class="n">radius</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">ionic_radius</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>                    <span class="c1"># if the radius is None, then we have an error and should grab</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>                    <span class="c1"># the atomic radius instead</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>                        <span class="c1"># note the .element is because we have our element</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>                        <span class="c1"># variable as a Specie object right now.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>                        <span class="n">radius</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">atomic_radius</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>                    <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="c1"># Some methods above might not give a radius for elements. For example,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="c1"># N will not provide a Metallic radius. In cases like this, we should let</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="c1"># the user know.</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">radius_method</span><span class="si">}</span><span class="s2"> radius_method is not allowed for one or more&quot;</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>                <span class="s2">&quot; of the elements in composition&quot;</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>            <span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="c1"># this returns a list of radii, where the order is assumed the same as the</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="c1"># order of elements in composition</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="k">return</span> <span class="n">radii</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="nf">volume_estimate</span><span class="p">(</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">,</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="n">packing_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.35</span><span class="p">,</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="p">):</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        Gives a predicted lattice volume using the reported radii for each</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        element in the composition.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        - `radius_method` :</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">            Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">            The default is &quot;ionic&quot;.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        - `packing_factor` :</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">            Scaling value for the volume in relation to predict ionic radii.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">            A value of 1 means the total volume will be exactly same as the sum</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">            of all spheres. Larger values will give smaller volumes. The</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">            default is 1.35, which is 74% packing efficiency (hexagonal packing).</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        #### Returns</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        - `total_volume` :</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">            the estimated volume for a unitcell of this composition</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="c1"># grab a list of radii (assumed to be in order of elements in composition)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii_estimate</span><span class="p">(</span><span class="n">radius_method</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="c1"># take the radii and find the corresponding spherical volume for each atom type</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="n">volumes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">]</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="c1"># find the total volume of all spheres in the composition</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="n">total_volume</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>            <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">*</span> <span class="n">volume</span> <span class="k">for</span> <span class="n">element</span><span class="p">,</span> <span class="n">volume</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">volumes</span><span class="p">)]</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="c1"># based on the packing of these spheres, we want to scale the volume of the</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="c1"># lattice better packing corresponds to a lower packing_factor</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="n">total_volume</span> <span class="o">*=</span> <span class="n">packing_factor</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="n">total_volume</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="nf">distance_matrix_estimate</span><span class="p">(</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">,</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="n">packing_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="p">):</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        Gives the estimated element-element distances using the reported radii</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">        for each element in the composition.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        For example, Mg-O-F would give a symmetric matrix like...</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">        |    | Mg   | O    | F    |</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">        | Mg | 1.5  | 1.05 | 1.   |</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">        | O  | 1.05 | 0.6  | 0.55 |</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        | F  | 1.   | 0.55 | 0.5  |</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">        - `radius_method` :</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">            Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">            The default is &quot;ionic&quot;.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">        - `packing_factor` :</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">            Scaling value for the volume in relation to predict ionic radii.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">            A value of 1 means the total volume will be exactly same as the sum</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">            of all spheres. Larger values will give smaller volumes. Because this</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">            method is commonly used to define minimum possible distances for</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">            random structure creation, we make the default 0.5.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        #### Returns</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        - `element_distance_matrix` :</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">            A matrix of element-element distances</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="c1"># grab a list of radii (assumed to be in order of elements in composition)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii_estimate</span><span class="p">(</span><span class="n">radius_method</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="c1"># multiply the radii by some factor that you want limit the overlap by</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="c1"># for example, if we don&#39;t want sites any closer than 50% their radii so</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="c1"># we can set factor=0.5.</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="c1"># Note, float() strips the unit (ang) from the value to avoid errors.</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">packing_factor</span><span class="p">)</span> <span class="k">for</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">]</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="c1"># Create the element distance matrix</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="c1"># There doesn&#39;t seem to be an easy way to get iterools.product() to a matrix</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="c1"># so I iterate through the possible combinations manually.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="c1"># OPTIMIZE: note this is really a symmetrical matrix so I&#39;m actually caclulating</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="c1"># things twice.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="k">for</span> <span class="n">radius1</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>            <span class="k">for</span> <span class="n">radius2</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                <span class="n">limit</span> <span class="o">=</span> <span class="n">radius1</span> <span class="o">+</span> <span class="n">radius2</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>            <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="c1"># convert the result matrix of list matrix to a numpy array before returning</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="n">element_distance_matrix</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="k">return</span> <span class="n">element_distance_matrix</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>    <span class="nd">@property</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>    <span class="k">def</span> <span class="nf">chemical_subsystems</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">        Returns all chemical systems of this composition&#39;s chemical system.</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">        For example, Y2C has the chemical system &quot;Y-C&quot; and would return</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">        [&quot;Y&quot;, &quot;C&quot;, &quot;C-Y&quot;]. Note that the returned list has elements of a given</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">        system in alphabetical order (i.e. it gives &quot;C-Y&quot; and not &quot;Y-C&quot;)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">        #### Returns</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">        - `subsystems`:</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">            A list of chemical systems that make up the input chemical system.</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="c1"># TODO: this will may be better located elsewhere. Maybe even as a method for</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="c1"># the Composition class.</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>        <span class="c1"># Convert the system to a list of elements</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="n">system_cleaned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemical_system</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="c1"># Now generate all unique combinations of these elements. Because we also</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="c1"># want combinations of different sizes (nelements = 1, 2, ... N), then we</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="c1"># put this in a for-loop.</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="n">subsystems</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">system_cleaned</span><span class="p">)):</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>            <span class="c1"># i is the size of combination we want. We now ask for each unique combo</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>            <span class="c1"># of elements at this given size.</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">system_cleaned</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>                <span class="c1"># Combo will be a tuple of elements that we then convert back to a</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>                <span class="c1"># chemical system. We also sort this alphabetically.</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                <span class="c1">#   ex: (&quot;Y&quot;, &quot;C&quot;, &quot;F&quot;) ---&gt; &quot;C-F-Y&quot;</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                <span class="n">subsystem</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">combo</span><span class="p">))</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                <span class="n">subsystems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subsystem</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="k">return</span> <span class="n">subsystems</span>
</span></pre></div>


            </section>
                <section id="Composition">
                            <input id="Composition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Composition</span><wbr>(<span class="base">pymatgen.core.composition.Composition</span>):

                <label class="view-source-button" for="Composition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Composition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Composition-22"><a href="#Composition-22"><span class="linenos"> 22</span></a><span class="k">class</span> <span class="nc">Composition</span><span class="p">(</span><span class="n">PymatgenComposition</span><span class="p">):</span>
</span><span id="Composition-23"><a href="#Composition-23"><span class="linenos"> 23</span></a>    <span class="c1"># Leave docstring blank and just inherit from pymatgen</span>
</span><span id="Composition-24"><a href="#Composition-24"><span class="linenos"> 24</span></a>
</span><span id="Composition-25"><a href="#Composition-25"><span class="linenos"> 25</span></a>    <span class="k">def</span> <span class="nf">radii_estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">):</span>
</span><span id="Composition-26"><a href="#Composition-26"><span class="linenos"> 26</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Composition-27"><a href="#Composition-27"><span class="linenos"> 27</span></a><span class="sd">        Gives the reported radii for each element in the composition.</span>
</span><span id="Composition-28"><a href="#Composition-28"><span class="linenos"> 28</span></a>
</span><span id="Composition-29"><a href="#Composition-29"><span class="linenos"> 29</span></a><span class="sd">        #### Parameters</span>
</span><span id="Composition-30"><a href="#Composition-30"><span class="linenos"> 30</span></a>
</span><span id="Composition-31"><a href="#Composition-31"><span class="linenos"> 31</span></a><span class="sd">        - `radius_method` :</span>
</span><span id="Composition-32"><a href="#Composition-32"><span class="linenos"> 32</span></a><span class="sd">            Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.</span>
</span><span id="Composition-33"><a href="#Composition-33"><span class="linenos"> 33</span></a><span class="sd">            The default is &quot;ionic&quot;.</span>
</span><span id="Composition-34"><a href="#Composition-34"><span class="linenos"> 34</span></a>
</span><span id="Composition-35"><a href="#Composition-35"><span class="linenos"> 35</span></a><span class="sd">        #### Returns</span>
</span><span id="Composition-36"><a href="#Composition-36"><span class="linenos"> 36</span></a>
</span><span id="Composition-37"><a href="#Composition-37"><span class="linenos"> 37</span></a><span class="sd">        - `radii` :</span>
</span><span id="Composition-38"><a href="#Composition-38"><span class="linenos"> 38</span></a><span class="sd">            A list of radii in the same order as composition.elements</span>
</span><span id="Composition-39"><a href="#Composition-39"><span class="linenos"> 39</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Composition-40"><a href="#Composition-40"><span class="linenos"> 40</span></a>
</span><span id="Composition-41"><a href="#Composition-41"><span class="linenos"> 41</span></a>        <span class="c1"># change the list of elements to radii list (atomic/vdw/metallic/ionic)</span>
</span><span id="Composition-42"><a href="#Composition-42"><span class="linenos"> 42</span></a>        <span class="k">if</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;atomic&quot;</span><span class="p">:</span>
</span><span id="Composition-43"><a href="#Composition-43"><span class="linenos"> 43</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">atomic_radius</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="Composition-44"><a href="#Composition-44"><span class="linenos"> 44</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;atomic_calculated&quot;</span><span class="p">:</span>
</span><span id="Composition-45"><a href="#Composition-45"><span class="linenos"> 45</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">atomic_radius_calculated</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="Composition-46"><a href="#Composition-46"><span class="linenos"> 46</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;van_der_waals&quot;</span><span class="p">:</span>
</span><span id="Composition-47"><a href="#Composition-47"><span class="linenos"> 47</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">van_der_waals_radius</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="Composition-48"><a href="#Composition-48"><span class="linenos"> 48</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;metallic&quot;</span><span class="p">:</span>
</span><span id="Composition-49"><a href="#Composition-49"><span class="linenos"> 49</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Composition-50"><a href="#Composition-50"><span class="linenos"> 50</span></a>                <span class="n">element</span><span class="o">.</span><span class="n">metallic_radius</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">is_metal</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Composition-51"><a href="#Composition-51"><span class="linenos"> 51</span></a>                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span>
</span><span id="Composition-52"><a href="#Composition-52"><span class="linenos"> 52</span></a>            <span class="p">]</span>
</span><span id="Composition-53"><a href="#Composition-53"><span class="linenos"> 53</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;ionic&quot;</span><span class="p">:</span>
</span><span id="Composition-54"><a href="#Composition-54"><span class="linenos"> 54</span></a>            <span class="c1"># In order to predict the radius here, we first need to predict the</span>
</span><span id="Composition-55"><a href="#Composition-55"><span class="linenos"> 55</span></a>            <span class="c1"># oxidation states. Note that this prediction changes composition to</span>
</span><span id="Composition-56"><a href="#Composition-56"><span class="linenos"> 56</span></a>            <span class="c1"># be made of Specie objects instead of Element objects.</span>
</span><span id="Composition-57"><a href="#Composition-57"><span class="linenos"> 57</span></a>            <span class="c1"># By converting to the reduced_composition first, we see a massive speed</span>
</span><span id="Composition-58"><a href="#Composition-58"><span class="linenos"> 58</span></a>            <span class="c1"># up -- this is done with max_sites=-1</span>
</span><span id="Composition-59"><a href="#Composition-59"><span class="linenos"> 59</span></a>            <span class="n">composition_oxi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_charges_from_oxi_state_guesses</span><span class="p">(</span><span class="n">max_sites</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Composition-60"><a href="#Composition-60"><span class="linenos"> 60</span></a>            <span class="c1"># Now we can grab the predicted radii</span>
</span><span id="Composition-61"><a href="#Composition-61"><span class="linenos"> 61</span></a>            <span class="c1"># If the estimated oxidation state is zero OR if the predicted oxidation</span>
</span><span id="Composition-62"><a href="#Composition-62"><span class="linenos"> 62</span></a>            <span class="c1"># state does not have an available radius (e.g H+ doesn&#39;t have a reported</span>
</span><span id="Composition-63"><a href="#Composition-63"><span class="linenos"> 63</span></a>            <span class="c1"># radius in our dataset), I grab the atomic radius.</span>
</span><span id="Composition-64"><a href="#Composition-64"><span class="linenos"> 64</span></a>            <span class="c1"># BUG: This will print a lot of warnings when the ionic radius doesn&#39;t exist.</span>
</span><span id="Composition-65"><a href="#Composition-65"><span class="linenos"> 65</span></a>            <span class="c1"># I expect these warnings, so I choose to suppress them here.</span>
</span><span id="Composition-66"><a href="#Composition-66"><span class="linenos"> 66</span></a>            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
</span><span id="Composition-67"><a href="#Composition-67"><span class="linenos"> 67</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>  <span class="c1"># dont print the warnings!</span>
</span><span id="Composition-68"><a href="#Composition-68"><span class="linenos"> 68</span></a>                <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Composition-69"><a href="#Composition-69"><span class="linenos"> 69</span></a>                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">composition_oxi</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
</span><span id="Composition-70"><a href="#Composition-70"><span class="linenos"> 70</span></a>                    <span class="c1"># attempt to grab the radius</span>
</span><span id="Composition-71"><a href="#Composition-71"><span class="linenos"> 71</span></a>                    <span class="n">radius</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">ionic_radius</span>
</span><span id="Composition-72"><a href="#Composition-72"><span class="linenos"> 72</span></a>                    <span class="c1"># if the radius is None, then we have an error and should grab</span>
</span><span id="Composition-73"><a href="#Composition-73"><span class="linenos"> 73</span></a>                    <span class="c1"># the atomic radius instead</span>
</span><span id="Composition-74"><a href="#Composition-74"><span class="linenos"> 74</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Composition-75"><a href="#Composition-75"><span class="linenos"> 75</span></a>                        <span class="c1"># note the .element is because we have our element</span>
</span><span id="Composition-76"><a href="#Composition-76"><span class="linenos"> 76</span></a>                        <span class="c1"># variable as a Specie object right now.</span>
</span><span id="Composition-77"><a href="#Composition-77"><span class="linenos"> 77</span></a>                        <span class="n">radius</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">atomic_radius</span>
</span><span id="Composition-78"><a href="#Composition-78"><span class="linenos"> 78</span></a>                    <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</span><span id="Composition-79"><a href="#Composition-79"><span class="linenos"> 79</span></a>        <span class="c1"># Some methods above might not give a radius for elements. For example,</span>
</span><span id="Composition-80"><a href="#Composition-80"><span class="linenos"> 80</span></a>        <span class="c1"># N will not provide a Metallic radius. In cases like this, we should let</span>
</span><span id="Composition-81"><a href="#Composition-81"><span class="linenos"> 81</span></a>        <span class="c1"># the user know.</span>
</span><span id="Composition-82"><a href="#Composition-82"><span class="linenos"> 82</span></a>        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="Composition-83"><a href="#Composition-83"><span class="linenos"> 83</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="Composition-84"><a href="#Composition-84"><span class="linenos"> 84</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">radius_method</span><span class="si">}</span><span class="s2"> radius_method is not allowed for one or more&quot;</span>
</span><span id="Composition-85"><a href="#Composition-85"><span class="linenos"> 85</span></a>                <span class="s2">&quot; of the elements in composition&quot;</span>
</span><span id="Composition-86"><a href="#Composition-86"><span class="linenos"> 86</span></a>            <span class="p">)</span>
</span><span id="Composition-87"><a href="#Composition-87"><span class="linenos"> 87</span></a>        <span class="c1"># this returns a list of radii, where the order is assumed the same as the</span>
</span><span id="Composition-88"><a href="#Composition-88"><span class="linenos"> 88</span></a>        <span class="c1"># order of elements in composition</span>
</span><span id="Composition-89"><a href="#Composition-89"><span class="linenos"> 89</span></a>        <span class="k">return</span> <span class="n">radii</span>
</span><span id="Composition-90"><a href="#Composition-90"><span class="linenos"> 90</span></a>
</span><span id="Composition-91"><a href="#Composition-91"><span class="linenos"> 91</span></a>    <span class="k">def</span> <span class="nf">volume_estimate</span><span class="p">(</span>
</span><span id="Composition-92"><a href="#Composition-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Composition-93"><a href="#Composition-93"><span class="linenos"> 93</span></a>        <span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">,</span>
</span><span id="Composition-94"><a href="#Composition-94"><span class="linenos"> 94</span></a>        <span class="n">packing_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.35</span><span class="p">,</span>
</span><span id="Composition-95"><a href="#Composition-95"><span class="linenos"> 95</span></a>    <span class="p">):</span>
</span><span id="Composition-96"><a href="#Composition-96"><span class="linenos"> 96</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Composition-97"><a href="#Composition-97"><span class="linenos"> 97</span></a><span class="sd">        Gives a predicted lattice volume using the reported radii for each</span>
</span><span id="Composition-98"><a href="#Composition-98"><span class="linenos"> 98</span></a><span class="sd">        element in the composition.</span>
</span><span id="Composition-99"><a href="#Composition-99"><span class="linenos"> 99</span></a>
</span><span id="Composition-100"><a href="#Composition-100"><span class="linenos">100</span></a><span class="sd">        #### Parameters</span>
</span><span id="Composition-101"><a href="#Composition-101"><span class="linenos">101</span></a>
</span><span id="Composition-102"><a href="#Composition-102"><span class="linenos">102</span></a><span class="sd">        - `radius_method` :</span>
</span><span id="Composition-103"><a href="#Composition-103"><span class="linenos">103</span></a><span class="sd">            Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.</span>
</span><span id="Composition-104"><a href="#Composition-104"><span class="linenos">104</span></a><span class="sd">            The default is &quot;ionic&quot;.</span>
</span><span id="Composition-105"><a href="#Composition-105"><span class="linenos">105</span></a><span class="sd">        - `packing_factor` :</span>
</span><span id="Composition-106"><a href="#Composition-106"><span class="linenos">106</span></a><span class="sd">            Scaling value for the volume in relation to predict ionic radii.</span>
</span><span id="Composition-107"><a href="#Composition-107"><span class="linenos">107</span></a><span class="sd">            A value of 1 means the total volume will be exactly same as the sum</span>
</span><span id="Composition-108"><a href="#Composition-108"><span class="linenos">108</span></a><span class="sd">            of all spheres. Larger values will give smaller volumes. The</span>
</span><span id="Composition-109"><a href="#Composition-109"><span class="linenos">109</span></a><span class="sd">            default is 1.35, which is 74% packing efficiency (hexagonal packing).</span>
</span><span id="Composition-110"><a href="#Composition-110"><span class="linenos">110</span></a>
</span><span id="Composition-111"><a href="#Composition-111"><span class="linenos">111</span></a><span class="sd">        #### Returns</span>
</span><span id="Composition-112"><a href="#Composition-112"><span class="linenos">112</span></a>
</span><span id="Composition-113"><a href="#Composition-113"><span class="linenos">113</span></a><span class="sd">        - `total_volume` :</span>
</span><span id="Composition-114"><a href="#Composition-114"><span class="linenos">114</span></a><span class="sd">            the estimated volume for a unitcell of this composition</span>
</span><span id="Composition-115"><a href="#Composition-115"><span class="linenos">115</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Composition-116"><a href="#Composition-116"><span class="linenos">116</span></a>
</span><span id="Composition-117"><a href="#Composition-117"><span class="linenos">117</span></a>        <span class="c1"># grab a list of radii (assumed to be in order of elements in composition)</span>
</span><span id="Composition-118"><a href="#Composition-118"><span class="linenos">118</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii_estimate</span><span class="p">(</span><span class="n">radius_method</span><span class="p">)</span>
</span><span id="Composition-119"><a href="#Composition-119"><span class="linenos">119</span></a>
</span><span id="Composition-120"><a href="#Composition-120"><span class="linenos">120</span></a>        <span class="c1"># take the radii and find the corresponding spherical volume for each atom type</span>
</span><span id="Composition-121"><a href="#Composition-121"><span class="linenos">121</span></a>        <span class="n">volumes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">]</span>
</span><span id="Composition-122"><a href="#Composition-122"><span class="linenos">122</span></a>
</span><span id="Composition-123"><a href="#Composition-123"><span class="linenos">123</span></a>        <span class="c1"># find the total volume of all spheres in the composition</span>
</span><span id="Composition-124"><a href="#Composition-124"><span class="linenos">124</span></a>        <span class="n">total_volume</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
</span><span id="Composition-125"><a href="#Composition-125"><span class="linenos">125</span></a>            <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">*</span> <span class="n">volume</span> <span class="k">for</span> <span class="n">element</span><span class="p">,</span> <span class="n">volume</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">volumes</span><span class="p">)]</span>
</span><span id="Composition-126"><a href="#Composition-126"><span class="linenos">126</span></a>        <span class="p">)</span>
</span><span id="Composition-127"><a href="#Composition-127"><span class="linenos">127</span></a>        <span class="c1"># based on the packing of these spheres, we want to scale the volume of the</span>
</span><span id="Composition-128"><a href="#Composition-128"><span class="linenos">128</span></a>        <span class="c1"># lattice better packing corresponds to a lower packing_factor</span>
</span><span id="Composition-129"><a href="#Composition-129"><span class="linenos">129</span></a>        <span class="n">total_volume</span> <span class="o">*=</span> <span class="n">packing_factor</span>
</span><span id="Composition-130"><a href="#Composition-130"><span class="linenos">130</span></a>
</span><span id="Composition-131"><a href="#Composition-131"><span class="linenos">131</span></a>        <span class="k">return</span> <span class="n">total_volume</span>
</span><span id="Composition-132"><a href="#Composition-132"><span class="linenos">132</span></a>
</span><span id="Composition-133"><a href="#Composition-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">distance_matrix_estimate</span><span class="p">(</span>
</span><span id="Composition-134"><a href="#Composition-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Composition-135"><a href="#Composition-135"><span class="linenos">135</span></a>        <span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">,</span>
</span><span id="Composition-136"><a href="#Composition-136"><span class="linenos">136</span></a>        <span class="n">packing_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="Composition-137"><a href="#Composition-137"><span class="linenos">137</span></a>    <span class="p">):</span>
</span><span id="Composition-138"><a href="#Composition-138"><span class="linenos">138</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Composition-139"><a href="#Composition-139"><span class="linenos">139</span></a><span class="sd">        Gives the estimated element-element distances using the reported radii</span>
</span><span id="Composition-140"><a href="#Composition-140"><span class="linenos">140</span></a><span class="sd">        for each element in the composition.</span>
</span><span id="Composition-141"><a href="#Composition-141"><span class="linenos">141</span></a>
</span><span id="Composition-142"><a href="#Composition-142"><span class="linenos">142</span></a><span class="sd">        For example, Mg-O-F would give a symmetric matrix like...</span>
</span><span id="Composition-143"><a href="#Composition-143"><span class="linenos">143</span></a>
</span><span id="Composition-144"><a href="#Composition-144"><span class="linenos">144</span></a><span class="sd">        |    | Mg   | O    | F    |</span>
</span><span id="Composition-145"><a href="#Composition-145"><span class="linenos">145</span></a><span class="sd">        | Mg | 1.5  | 1.05 | 1.   |</span>
</span><span id="Composition-146"><a href="#Composition-146"><span class="linenos">146</span></a><span class="sd">        | O  | 1.05 | 0.6  | 0.55 |</span>
</span><span id="Composition-147"><a href="#Composition-147"><span class="linenos">147</span></a><span class="sd">        | F  | 1.   | 0.55 | 0.5  |</span>
</span><span id="Composition-148"><a href="#Composition-148"><span class="linenos">148</span></a>
</span><span id="Composition-149"><a href="#Composition-149"><span class="linenos">149</span></a><span class="sd">        #### Parameters</span>
</span><span id="Composition-150"><a href="#Composition-150"><span class="linenos">150</span></a>
</span><span id="Composition-151"><a href="#Composition-151"><span class="linenos">151</span></a><span class="sd">        - `radius_method` :</span>
</span><span id="Composition-152"><a href="#Composition-152"><span class="linenos">152</span></a><span class="sd">            Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.</span>
</span><span id="Composition-153"><a href="#Composition-153"><span class="linenos">153</span></a><span class="sd">            The default is &quot;ionic&quot;.</span>
</span><span id="Composition-154"><a href="#Composition-154"><span class="linenos">154</span></a><span class="sd">        - `packing_factor` :</span>
</span><span id="Composition-155"><a href="#Composition-155"><span class="linenos">155</span></a><span class="sd">            Scaling value for the volume in relation to predict ionic radii.</span>
</span><span id="Composition-156"><a href="#Composition-156"><span class="linenos">156</span></a><span class="sd">            A value of 1 means the total volume will be exactly same as the sum</span>
</span><span id="Composition-157"><a href="#Composition-157"><span class="linenos">157</span></a><span class="sd">            of all spheres. Larger values will give smaller volumes. Because this</span>
</span><span id="Composition-158"><a href="#Composition-158"><span class="linenos">158</span></a><span class="sd">            method is commonly used to define minimum possible distances for</span>
</span><span id="Composition-159"><a href="#Composition-159"><span class="linenos">159</span></a><span class="sd">            random structure creation, we make the default 0.5.</span>
</span><span id="Composition-160"><a href="#Composition-160"><span class="linenos">160</span></a>
</span><span id="Composition-161"><a href="#Composition-161"><span class="linenos">161</span></a><span class="sd">        #### Returns</span>
</span><span id="Composition-162"><a href="#Composition-162"><span class="linenos">162</span></a>
</span><span id="Composition-163"><a href="#Composition-163"><span class="linenos">163</span></a><span class="sd">        - `element_distance_matrix` :</span>
</span><span id="Composition-164"><a href="#Composition-164"><span class="linenos">164</span></a><span class="sd">            A matrix of element-element distances</span>
</span><span id="Composition-165"><a href="#Composition-165"><span class="linenos">165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Composition-166"><a href="#Composition-166"><span class="linenos">166</span></a>
</span><span id="Composition-167"><a href="#Composition-167"><span class="linenos">167</span></a>        <span class="c1"># grab a list of radii (assumed to be in order of elements in composition)</span>
</span><span id="Composition-168"><a href="#Composition-168"><span class="linenos">168</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii_estimate</span><span class="p">(</span><span class="n">radius_method</span><span class="p">)</span>
</span><span id="Composition-169"><a href="#Composition-169"><span class="linenos">169</span></a>
</span><span id="Composition-170"><a href="#Composition-170"><span class="linenos">170</span></a>        <span class="c1"># multiply the radii by some factor that you want limit the overlap by</span>
</span><span id="Composition-171"><a href="#Composition-171"><span class="linenos">171</span></a>        <span class="c1"># for example, if we don&#39;t want sites any closer than 50% their radii so</span>
</span><span id="Composition-172"><a href="#Composition-172"><span class="linenos">172</span></a>        <span class="c1"># we can set factor=0.5.</span>
</span><span id="Composition-173"><a href="#Composition-173"><span class="linenos">173</span></a>        <span class="c1"># Note, float() strips the unit (ang) from the value to avoid errors.</span>
</span><span id="Composition-174"><a href="#Composition-174"><span class="linenos">174</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">packing_factor</span><span class="p">)</span> <span class="k">for</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">]</span>
</span><span id="Composition-175"><a href="#Composition-175"><span class="linenos">175</span></a>
</span><span id="Composition-176"><a href="#Composition-176"><span class="linenos">176</span></a>        <span class="c1"># Create the element distance matrix</span>
</span><span id="Composition-177"><a href="#Composition-177"><span class="linenos">177</span></a>        <span class="c1"># There doesn&#39;t seem to be an easy way to get iterools.product() to a matrix</span>
</span><span id="Composition-178"><a href="#Composition-178"><span class="linenos">178</span></a>        <span class="c1"># so I iterate through the possible combinations manually.</span>
</span><span id="Composition-179"><a href="#Composition-179"><span class="linenos">179</span></a>        <span class="c1"># OPTIMIZE: note this is really a symmetrical matrix so I&#39;m actually caclulating</span>
</span><span id="Composition-180"><a href="#Composition-180"><span class="linenos">180</span></a>        <span class="c1"># things twice.</span>
</span><span id="Composition-181"><a href="#Composition-181"><span class="linenos">181</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Composition-182"><a href="#Composition-182"><span class="linenos">182</span></a>        <span class="k">for</span> <span class="n">radius1</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="Composition-183"><a href="#Composition-183"><span class="linenos">183</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Composition-184"><a href="#Composition-184"><span class="linenos">184</span></a>            <span class="k">for</span> <span class="n">radius2</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="Composition-185"><a href="#Composition-185"><span class="linenos">185</span></a>                <span class="n">limit</span> <span class="o">=</span> <span class="n">radius1</span> <span class="o">+</span> <span class="n">radius2</span>
</span><span id="Composition-186"><a href="#Composition-186"><span class="linenos">186</span></a>                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
</span><span id="Composition-187"><a href="#Composition-187"><span class="linenos">187</span></a>            <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="Composition-188"><a href="#Composition-188"><span class="linenos">188</span></a>        <span class="c1"># convert the result matrix of list matrix to a numpy array before returning</span>
</span><span id="Composition-189"><a href="#Composition-189"><span class="linenos">189</span></a>        <span class="n">element_distance_matrix</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="Composition-190"><a href="#Composition-190"><span class="linenos">190</span></a>        <span class="k">return</span> <span class="n">element_distance_matrix</span>
</span><span id="Composition-191"><a href="#Composition-191"><span class="linenos">191</span></a>
</span><span id="Composition-192"><a href="#Composition-192"><span class="linenos">192</span></a>    <span class="nd">@property</span>
</span><span id="Composition-193"><a href="#Composition-193"><span class="linenos">193</span></a>    <span class="k">def</span> <span class="nf">chemical_subsystems</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="Composition-194"><a href="#Composition-194"><span class="linenos">194</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Composition-195"><a href="#Composition-195"><span class="linenos">195</span></a><span class="sd">        Returns all chemical systems of this composition&#39;s chemical system.</span>
</span><span id="Composition-196"><a href="#Composition-196"><span class="linenos">196</span></a>
</span><span id="Composition-197"><a href="#Composition-197"><span class="linenos">197</span></a><span class="sd">        For example, Y2C has the chemical system &quot;Y-C&quot; and would return</span>
</span><span id="Composition-198"><a href="#Composition-198"><span class="linenos">198</span></a><span class="sd">        [&quot;Y&quot;, &quot;C&quot;, &quot;C-Y&quot;]. Note that the returned list has elements of a given</span>
</span><span id="Composition-199"><a href="#Composition-199"><span class="linenos">199</span></a><span class="sd">        system in alphabetical order (i.e. it gives &quot;C-Y&quot; and not &quot;Y-C&quot;)</span>
</span><span id="Composition-200"><a href="#Composition-200"><span class="linenos">200</span></a>
</span><span id="Composition-201"><a href="#Composition-201"><span class="linenos">201</span></a><span class="sd">        #### Returns</span>
</span><span id="Composition-202"><a href="#Composition-202"><span class="linenos">202</span></a>
</span><span id="Composition-203"><a href="#Composition-203"><span class="linenos">203</span></a><span class="sd">        - `subsystems`:</span>
</span><span id="Composition-204"><a href="#Composition-204"><span class="linenos">204</span></a><span class="sd">            A list of chemical systems that make up the input chemical system.</span>
</span><span id="Composition-205"><a href="#Composition-205"><span class="linenos">205</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Composition-206"><a href="#Composition-206"><span class="linenos">206</span></a>
</span><span id="Composition-207"><a href="#Composition-207"><span class="linenos">207</span></a>        <span class="c1"># TODO: this will may be better located elsewhere. Maybe even as a method for</span>
</span><span id="Composition-208"><a href="#Composition-208"><span class="linenos">208</span></a>        <span class="c1"># the Composition class.</span>
</span><span id="Composition-209"><a href="#Composition-209"><span class="linenos">209</span></a>
</span><span id="Composition-210"><a href="#Composition-210"><span class="linenos">210</span></a>        <span class="c1"># Convert the system to a list of elements</span>
</span><span id="Composition-211"><a href="#Composition-211"><span class="linenos">211</span></a>        <span class="n">system_cleaned</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemical_system</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
</span><span id="Composition-212"><a href="#Composition-212"><span class="linenos">212</span></a>
</span><span id="Composition-213"><a href="#Composition-213"><span class="linenos">213</span></a>        <span class="c1"># Now generate all unique combinations of these elements. Because we also</span>
</span><span id="Composition-214"><a href="#Composition-214"><span class="linenos">214</span></a>        <span class="c1"># want combinations of different sizes (nelements = 1, 2, ... N), then we</span>
</span><span id="Composition-215"><a href="#Composition-215"><span class="linenos">215</span></a>        <span class="c1"># put this in a for-loop.</span>
</span><span id="Composition-216"><a href="#Composition-216"><span class="linenos">216</span></a>        <span class="n">subsystems</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Composition-217"><a href="#Composition-217"><span class="linenos">217</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">system_cleaned</span><span class="p">)):</span>
</span><span id="Composition-218"><a href="#Composition-218"><span class="linenos">218</span></a>            <span class="c1"># i is the size of combination we want. We now ask for each unique combo</span>
</span><span id="Composition-219"><a href="#Composition-219"><span class="linenos">219</span></a>            <span class="c1"># of elements at this given size.</span>
</span><span id="Composition-220"><a href="#Composition-220"><span class="linenos">220</span></a>            <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">system_cleaned</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Composition-221"><a href="#Composition-221"><span class="linenos">221</span></a>                <span class="c1"># Combo will be a tuple of elements that we then convert back to a</span>
</span><span id="Composition-222"><a href="#Composition-222"><span class="linenos">222</span></a>                <span class="c1"># chemical system. We also sort this alphabetically.</span>
</span><span id="Composition-223"><a href="#Composition-223"><span class="linenos">223</span></a>                <span class="c1">#   ex: (&quot;Y&quot;, &quot;C&quot;, &quot;F&quot;) ---&gt; &quot;C-F-Y&quot;</span>
</span><span id="Composition-224"><a href="#Composition-224"><span class="linenos">224</span></a>                <span class="n">subsystem</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">combo</span><span class="p">))</span>
</span><span id="Composition-225"><a href="#Composition-225"><span class="linenos">225</span></a>                <span class="n">subsystems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subsystem</span><span class="p">)</span>
</span><span id="Composition-226"><a href="#Composition-226"><span class="linenos">226</span></a>        <span class="k">return</span> <span class="n">subsystems</span>
</span></pre></div>


            <div class="docstring"><p>Represents a Composition, which is essentially a {element:amount} mapping
type. Composition is written to be immutable and hashable,
unlike a standard Python dict.</p>

<p>Note that the key can be either an Element or a Species. Elements and Species
are treated differently. i.e., a Fe2+ is not the same as a Fe3+ Species and
would be put in separate keys. This differentiation is deliberate to
support using Composition to determine the fraction of a particular Species.</p>

<p>Works almost completely like a standard python dictionary, except that
__getitem__ is overridden to return 0 when an element is not found.
(somewhat like a defaultdict, except it is immutable).</p>

<p>Also adds more convenience methods relevant to compositions, e.g.,
get_fraction.</p>

<p>It should also be noted that many Composition related functionality takes
in a standard string as a convenient input. For example,
even though the internal representation of a Fe2O3 composition is
{Element("Fe"): 2, Element("O"): 3}, you can obtain the amount of Fe
simply by comp["Fe"] instead of the more verbose comp[Element("Fe")].</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">comp</span> <span class="o">=</span> <span class="n">Composition</span><span class="p">(</span><span class="s2">&quot;LiFePO4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comp</span><span class="o">.</span><span class="n">get_atomic_fraction</span><span class="p">(</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;Li&quot;</span><span class="p">))</span>
<span class="go">0.14285714285714285</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comp</span><span class="o">.</span><span class="n">num_atoms</span>
<span class="go">7.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comp</span><span class="o">.</span><span class="n">reduced_formula</span>
<span class="go">&#39;LiFePO4&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comp</span><span class="o">.</span><span class="n">formula</span>
<span class="go">&#39;Li1 Fe1 P1 O4&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comp</span><span class="o">.</span><span class="n">get_wt_fraction</span><span class="p">(</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;Li&quot;</span><span class="p">))</span>
<span class="go">0.04399794666951898</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">comp</span><span class="o">.</span><span class="n">num_atoms</span>
<span class="go">7.0</span>
</code></pre></div>
</div>


                            <div id="Composition.radii_estimate" class="classattr">
                                        <input id="Composition.radii_estimate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">radii_estimate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ionic&#39;</span></span>)</span>

                <label class="view-source-button" for="Composition.radii_estimate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Composition.radii_estimate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Composition.radii_estimate-25"><a href="#Composition.radii_estimate-25"><span class="linenos">25</span></a>    <span class="k">def</span> <span class="nf">radii_estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">):</span>
</span><span id="Composition.radii_estimate-26"><a href="#Composition.radii_estimate-26"><span class="linenos">26</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Composition.radii_estimate-27"><a href="#Composition.radii_estimate-27"><span class="linenos">27</span></a><span class="sd">        Gives the reported radii for each element in the composition.</span>
</span><span id="Composition.radii_estimate-28"><a href="#Composition.radii_estimate-28"><span class="linenos">28</span></a>
</span><span id="Composition.radii_estimate-29"><a href="#Composition.radii_estimate-29"><span class="linenos">29</span></a><span class="sd">        #### Parameters</span>
</span><span id="Composition.radii_estimate-30"><a href="#Composition.radii_estimate-30"><span class="linenos">30</span></a>
</span><span id="Composition.radii_estimate-31"><a href="#Composition.radii_estimate-31"><span class="linenos">31</span></a><span class="sd">        - `radius_method` :</span>
</span><span id="Composition.radii_estimate-32"><a href="#Composition.radii_estimate-32"><span class="linenos">32</span></a><span class="sd">            Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.</span>
</span><span id="Composition.radii_estimate-33"><a href="#Composition.radii_estimate-33"><span class="linenos">33</span></a><span class="sd">            The default is &quot;ionic&quot;.</span>
</span><span id="Composition.radii_estimate-34"><a href="#Composition.radii_estimate-34"><span class="linenos">34</span></a>
</span><span id="Composition.radii_estimate-35"><a href="#Composition.radii_estimate-35"><span class="linenos">35</span></a><span class="sd">        #### Returns</span>
</span><span id="Composition.radii_estimate-36"><a href="#Composition.radii_estimate-36"><span class="linenos">36</span></a>
</span><span id="Composition.radii_estimate-37"><a href="#Composition.radii_estimate-37"><span class="linenos">37</span></a><span class="sd">        - `radii` :</span>
</span><span id="Composition.radii_estimate-38"><a href="#Composition.radii_estimate-38"><span class="linenos">38</span></a><span class="sd">            A list of radii in the same order as composition.elements</span>
</span><span id="Composition.radii_estimate-39"><a href="#Composition.radii_estimate-39"><span class="linenos">39</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Composition.radii_estimate-40"><a href="#Composition.radii_estimate-40"><span class="linenos">40</span></a>
</span><span id="Composition.radii_estimate-41"><a href="#Composition.radii_estimate-41"><span class="linenos">41</span></a>        <span class="c1"># change the list of elements to radii list (atomic/vdw/metallic/ionic)</span>
</span><span id="Composition.radii_estimate-42"><a href="#Composition.radii_estimate-42"><span class="linenos">42</span></a>        <span class="k">if</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;atomic&quot;</span><span class="p">:</span>
</span><span id="Composition.radii_estimate-43"><a href="#Composition.radii_estimate-43"><span class="linenos">43</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">atomic_radius</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="Composition.radii_estimate-44"><a href="#Composition.radii_estimate-44"><span class="linenos">44</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;atomic_calculated&quot;</span><span class="p">:</span>
</span><span id="Composition.radii_estimate-45"><a href="#Composition.radii_estimate-45"><span class="linenos">45</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">atomic_radius_calculated</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="Composition.radii_estimate-46"><a href="#Composition.radii_estimate-46"><span class="linenos">46</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;van_der_waals&quot;</span><span class="p">:</span>
</span><span id="Composition.radii_estimate-47"><a href="#Composition.radii_estimate-47"><span class="linenos">47</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">van_der_waals_radius</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
</span><span id="Composition.radii_estimate-48"><a href="#Composition.radii_estimate-48"><span class="linenos">48</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;metallic&quot;</span><span class="p">:</span>
</span><span id="Composition.radii_estimate-49"><a href="#Composition.radii_estimate-49"><span class="linenos">49</span></a>            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Composition.radii_estimate-50"><a href="#Composition.radii_estimate-50"><span class="linenos">50</span></a>                <span class="n">element</span><span class="o">.</span><span class="n">metallic_radius</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">is_metal</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Composition.radii_estimate-51"><a href="#Composition.radii_estimate-51"><span class="linenos">51</span></a>                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span>
</span><span id="Composition.radii_estimate-52"><a href="#Composition.radii_estimate-52"><span class="linenos">52</span></a>            <span class="p">]</span>
</span><span id="Composition.radii_estimate-53"><a href="#Composition.radii_estimate-53"><span class="linenos">53</span></a>        <span class="k">elif</span> <span class="n">radius_method</span> <span class="o">==</span> <span class="s2">&quot;ionic&quot;</span><span class="p">:</span>
</span><span id="Composition.radii_estimate-54"><a href="#Composition.radii_estimate-54"><span class="linenos">54</span></a>            <span class="c1"># In order to predict the radius here, we first need to predict the</span>
</span><span id="Composition.radii_estimate-55"><a href="#Composition.radii_estimate-55"><span class="linenos">55</span></a>            <span class="c1"># oxidation states. Note that this prediction changes composition to</span>
</span><span id="Composition.radii_estimate-56"><a href="#Composition.radii_estimate-56"><span class="linenos">56</span></a>            <span class="c1"># be made of Specie objects instead of Element objects.</span>
</span><span id="Composition.radii_estimate-57"><a href="#Composition.radii_estimate-57"><span class="linenos">57</span></a>            <span class="c1"># By converting to the reduced_composition first, we see a massive speed</span>
</span><span id="Composition.radii_estimate-58"><a href="#Composition.radii_estimate-58"><span class="linenos">58</span></a>            <span class="c1"># up -- this is done with max_sites=-1</span>
</span><span id="Composition.radii_estimate-59"><a href="#Composition.radii_estimate-59"><span class="linenos">59</span></a>            <span class="n">composition_oxi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_charges_from_oxi_state_guesses</span><span class="p">(</span><span class="n">max_sites</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Composition.radii_estimate-60"><a href="#Composition.radii_estimate-60"><span class="linenos">60</span></a>            <span class="c1"># Now we can grab the predicted radii</span>
</span><span id="Composition.radii_estimate-61"><a href="#Composition.radii_estimate-61"><span class="linenos">61</span></a>            <span class="c1"># If the estimated oxidation state is zero OR if the predicted oxidation</span>
</span><span id="Composition.radii_estimate-62"><a href="#Composition.radii_estimate-62"><span class="linenos">62</span></a>            <span class="c1"># state does not have an available radius (e.g H+ doesn&#39;t have a reported</span>
</span><span id="Composition.radii_estimate-63"><a href="#Composition.radii_estimate-63"><span class="linenos">63</span></a>            <span class="c1"># radius in our dataset), I grab the atomic radius.</span>
</span><span id="Composition.radii_estimate-64"><a href="#Composition.radii_estimate-64"><span class="linenos">64</span></a>            <span class="c1"># BUG: This will print a lot of warnings when the ionic radius doesn&#39;t exist.</span>
</span><span id="Composition.radii_estimate-65"><a href="#Composition.radii_estimate-65"><span class="linenos">65</span></a>            <span class="c1"># I expect these warnings, so I choose to suppress them here.</span>
</span><span id="Composition.radii_estimate-66"><a href="#Composition.radii_estimate-66"><span class="linenos">66</span></a>            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
</span><span id="Composition.radii_estimate-67"><a href="#Composition.radii_estimate-67"><span class="linenos">67</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>  <span class="c1"># dont print the warnings!</span>
</span><span id="Composition.radii_estimate-68"><a href="#Composition.radii_estimate-68"><span class="linenos">68</span></a>                <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Composition.radii_estimate-69"><a href="#Composition.radii_estimate-69"><span class="linenos">69</span></a>                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">composition_oxi</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
</span><span id="Composition.radii_estimate-70"><a href="#Composition.radii_estimate-70"><span class="linenos">70</span></a>                    <span class="c1"># attempt to grab the radius</span>
</span><span id="Composition.radii_estimate-71"><a href="#Composition.radii_estimate-71"><span class="linenos">71</span></a>                    <span class="n">radius</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">ionic_radius</span>
</span><span id="Composition.radii_estimate-72"><a href="#Composition.radii_estimate-72"><span class="linenos">72</span></a>                    <span class="c1"># if the radius is None, then we have an error and should grab</span>
</span><span id="Composition.radii_estimate-73"><a href="#Composition.radii_estimate-73"><span class="linenos">73</span></a>                    <span class="c1"># the atomic radius instead</span>
</span><span id="Composition.radii_estimate-74"><a href="#Composition.radii_estimate-74"><span class="linenos">74</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">radius</span><span class="p">:</span>
</span><span id="Composition.radii_estimate-75"><a href="#Composition.radii_estimate-75"><span class="linenos">75</span></a>                        <span class="c1"># note the .element is because we have our element</span>
</span><span id="Composition.radii_estimate-76"><a href="#Composition.radii_estimate-76"><span class="linenos">76</span></a>                        <span class="c1"># variable as a Specie object right now.</span>
</span><span id="Composition.radii_estimate-77"><a href="#Composition.radii_estimate-77"><span class="linenos">77</span></a>                        <span class="n">radius</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">atomic_radius</span>
</span><span id="Composition.radii_estimate-78"><a href="#Composition.radii_estimate-78"><span class="linenos">78</span></a>                    <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</span><span id="Composition.radii_estimate-79"><a href="#Composition.radii_estimate-79"><span class="linenos">79</span></a>        <span class="c1"># Some methods above might not give a radius for elements. For example,</span>
</span><span id="Composition.radii_estimate-80"><a href="#Composition.radii_estimate-80"><span class="linenos">80</span></a>        <span class="c1"># N will not provide a Metallic radius. In cases like this, we should let</span>
</span><span id="Composition.radii_estimate-81"><a href="#Composition.radii_estimate-81"><span class="linenos">81</span></a>        <span class="c1"># the user know.</span>
</span><span id="Composition.radii_estimate-82"><a href="#Composition.radii_estimate-82"><span class="linenos">82</span></a>        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="Composition.radii_estimate-83"><a href="#Composition.radii_estimate-83"><span class="linenos">83</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="Composition.radii_estimate-84"><a href="#Composition.radii_estimate-84"><span class="linenos">84</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">radius_method</span><span class="si">}</span><span class="s2"> radius_method is not allowed for one or more&quot;</span>
</span><span id="Composition.radii_estimate-85"><a href="#Composition.radii_estimate-85"><span class="linenos">85</span></a>                <span class="s2">&quot; of the elements in composition&quot;</span>
</span><span id="Composition.radii_estimate-86"><a href="#Composition.radii_estimate-86"><span class="linenos">86</span></a>            <span class="p">)</span>
</span><span id="Composition.radii_estimate-87"><a href="#Composition.radii_estimate-87"><span class="linenos">87</span></a>        <span class="c1"># this returns a list of radii, where the order is assumed the same as the</span>
</span><span id="Composition.radii_estimate-88"><a href="#Composition.radii_estimate-88"><span class="linenos">88</span></a>        <span class="c1"># order of elements in composition</span>
</span><span id="Composition.radii_estimate-89"><a href="#Composition.radii_estimate-89"><span class="linenos">89</span></a>        <span class="k">return</span> <span class="n">radii</span>
</span></pre></div>


            <div class="docstring"><p>Gives the reported radii for each element in the composition.</p>

<h4 id="parameters">Parameters</h4>

<ul>
<li><code>radius_method</code> :
Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.
The default is "ionic".</li>
</ul>

<h4 id="returns">Returns</h4>

<ul>
<li><code>radii</code> :
A list of radii in the same order as composition.elements</li>
</ul>
</div>


                            </div>
                            <div id="Composition.volume_estimate" class="classattr">
                                        <input id="Composition.volume_estimate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">volume_estimate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ionic&#39;</span>, </span><span class="param"><span class="n">packing_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.35</span></span>)</span>

                <label class="view-source-button" for="Composition.volume_estimate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Composition.volume_estimate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Composition.volume_estimate-91"><a href="#Composition.volume_estimate-91"><span class="linenos"> 91</span></a>    <span class="k">def</span> <span class="nf">volume_estimate</span><span class="p">(</span>
</span><span id="Composition.volume_estimate-92"><a href="#Composition.volume_estimate-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Composition.volume_estimate-93"><a href="#Composition.volume_estimate-93"><span class="linenos"> 93</span></a>        <span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">,</span>
</span><span id="Composition.volume_estimate-94"><a href="#Composition.volume_estimate-94"><span class="linenos"> 94</span></a>        <span class="n">packing_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.35</span><span class="p">,</span>
</span><span id="Composition.volume_estimate-95"><a href="#Composition.volume_estimate-95"><span class="linenos"> 95</span></a>    <span class="p">):</span>
</span><span id="Composition.volume_estimate-96"><a href="#Composition.volume_estimate-96"><span class="linenos"> 96</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Composition.volume_estimate-97"><a href="#Composition.volume_estimate-97"><span class="linenos"> 97</span></a><span class="sd">        Gives a predicted lattice volume using the reported radii for each</span>
</span><span id="Composition.volume_estimate-98"><a href="#Composition.volume_estimate-98"><span class="linenos"> 98</span></a><span class="sd">        element in the composition.</span>
</span><span id="Composition.volume_estimate-99"><a href="#Composition.volume_estimate-99"><span class="linenos"> 99</span></a>
</span><span id="Composition.volume_estimate-100"><a href="#Composition.volume_estimate-100"><span class="linenos">100</span></a><span class="sd">        #### Parameters</span>
</span><span id="Composition.volume_estimate-101"><a href="#Composition.volume_estimate-101"><span class="linenos">101</span></a>
</span><span id="Composition.volume_estimate-102"><a href="#Composition.volume_estimate-102"><span class="linenos">102</span></a><span class="sd">        - `radius_method` :</span>
</span><span id="Composition.volume_estimate-103"><a href="#Composition.volume_estimate-103"><span class="linenos">103</span></a><span class="sd">            Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.</span>
</span><span id="Composition.volume_estimate-104"><a href="#Composition.volume_estimate-104"><span class="linenos">104</span></a><span class="sd">            The default is &quot;ionic&quot;.</span>
</span><span id="Composition.volume_estimate-105"><a href="#Composition.volume_estimate-105"><span class="linenos">105</span></a><span class="sd">        - `packing_factor` :</span>
</span><span id="Composition.volume_estimate-106"><a href="#Composition.volume_estimate-106"><span class="linenos">106</span></a><span class="sd">            Scaling value for the volume in relation to predict ionic radii.</span>
</span><span id="Composition.volume_estimate-107"><a href="#Composition.volume_estimate-107"><span class="linenos">107</span></a><span class="sd">            A value of 1 means the total volume will be exactly same as the sum</span>
</span><span id="Composition.volume_estimate-108"><a href="#Composition.volume_estimate-108"><span class="linenos">108</span></a><span class="sd">            of all spheres. Larger values will give smaller volumes. The</span>
</span><span id="Composition.volume_estimate-109"><a href="#Composition.volume_estimate-109"><span class="linenos">109</span></a><span class="sd">            default is 1.35, which is 74% packing efficiency (hexagonal packing).</span>
</span><span id="Composition.volume_estimate-110"><a href="#Composition.volume_estimate-110"><span class="linenos">110</span></a>
</span><span id="Composition.volume_estimate-111"><a href="#Composition.volume_estimate-111"><span class="linenos">111</span></a><span class="sd">        #### Returns</span>
</span><span id="Composition.volume_estimate-112"><a href="#Composition.volume_estimate-112"><span class="linenos">112</span></a>
</span><span id="Composition.volume_estimate-113"><a href="#Composition.volume_estimate-113"><span class="linenos">113</span></a><span class="sd">        - `total_volume` :</span>
</span><span id="Composition.volume_estimate-114"><a href="#Composition.volume_estimate-114"><span class="linenos">114</span></a><span class="sd">            the estimated volume for a unitcell of this composition</span>
</span><span id="Composition.volume_estimate-115"><a href="#Composition.volume_estimate-115"><span class="linenos">115</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Composition.volume_estimate-116"><a href="#Composition.volume_estimate-116"><span class="linenos">116</span></a>
</span><span id="Composition.volume_estimate-117"><a href="#Composition.volume_estimate-117"><span class="linenos">117</span></a>        <span class="c1"># grab a list of radii (assumed to be in order of elements in composition)</span>
</span><span id="Composition.volume_estimate-118"><a href="#Composition.volume_estimate-118"><span class="linenos">118</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii_estimate</span><span class="p">(</span><span class="n">radius_method</span><span class="p">)</span>
</span><span id="Composition.volume_estimate-119"><a href="#Composition.volume_estimate-119"><span class="linenos">119</span></a>
</span><span id="Composition.volume_estimate-120"><a href="#Composition.volume_estimate-120"><span class="linenos">120</span></a>        <span class="c1"># take the radii and find the corresponding spherical volume for each atom type</span>
</span><span id="Composition.volume_estimate-121"><a href="#Composition.volume_estimate-121"><span class="linenos">121</span></a>        <span class="n">volumes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">]</span>
</span><span id="Composition.volume_estimate-122"><a href="#Composition.volume_estimate-122"><span class="linenos">122</span></a>
</span><span id="Composition.volume_estimate-123"><a href="#Composition.volume_estimate-123"><span class="linenos">123</span></a>        <span class="c1"># find the total volume of all spheres in the composition</span>
</span><span id="Composition.volume_estimate-124"><a href="#Composition.volume_estimate-124"><span class="linenos">124</span></a>        <span class="n">total_volume</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
</span><span id="Composition.volume_estimate-125"><a href="#Composition.volume_estimate-125"><span class="linenos">125</span></a>            <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">*</span> <span class="n">volume</span> <span class="k">for</span> <span class="n">element</span><span class="p">,</span> <span class="n">volume</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">volumes</span><span class="p">)]</span>
</span><span id="Composition.volume_estimate-126"><a href="#Composition.volume_estimate-126"><span class="linenos">126</span></a>        <span class="p">)</span>
</span><span id="Composition.volume_estimate-127"><a href="#Composition.volume_estimate-127"><span class="linenos">127</span></a>        <span class="c1"># based on the packing of these spheres, we want to scale the volume of the</span>
</span><span id="Composition.volume_estimate-128"><a href="#Composition.volume_estimate-128"><span class="linenos">128</span></a>        <span class="c1"># lattice better packing corresponds to a lower packing_factor</span>
</span><span id="Composition.volume_estimate-129"><a href="#Composition.volume_estimate-129"><span class="linenos">129</span></a>        <span class="n">total_volume</span> <span class="o">*=</span> <span class="n">packing_factor</span>
</span><span id="Composition.volume_estimate-130"><a href="#Composition.volume_estimate-130"><span class="linenos">130</span></a>
</span><span id="Composition.volume_estimate-131"><a href="#Composition.volume_estimate-131"><span class="linenos">131</span></a>        <span class="k">return</span> <span class="n">total_volume</span>
</span></pre></div>


            <div class="docstring"><p>Gives a predicted lattice volume using the reported radii for each
element in the composition.</p>

<h4 id="parameters">Parameters</h4>

<ul>
<li><code>radius_method</code> :
Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.
The default is "ionic".</li>
<li><code>packing_factor</code> :
Scaling value for the volume in relation to predict ionic radii.
A value of 1 means the total volume will be exactly same as the sum
of all spheres. Larger values will give smaller volumes. The
default is 1.35, which is 74% packing efficiency (hexagonal packing).</li>
</ul>

<h4 id="returns">Returns</h4>

<ul>
<li><code>total_volume</code> :
the estimated volume for a unitcell of this composition</li>
</ul>
</div>


                            </div>
                            <div id="Composition.distance_matrix_estimate" class="classattr">
                                        <input id="Composition.distance_matrix_estimate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">distance_matrix_estimate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ionic&#39;</span>, </span><span class="param"><span class="n">packing_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span></span>)</span>

                <label class="view-source-button" for="Composition.distance_matrix_estimate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Composition.distance_matrix_estimate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Composition.distance_matrix_estimate-133"><a href="#Composition.distance_matrix_estimate-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">distance_matrix_estimate</span><span class="p">(</span>
</span><span id="Composition.distance_matrix_estimate-134"><a href="#Composition.distance_matrix_estimate-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Composition.distance_matrix_estimate-135"><a href="#Composition.distance_matrix_estimate-135"><span class="linenos">135</span></a>        <span class="n">radius_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">,</span>
</span><span id="Composition.distance_matrix_estimate-136"><a href="#Composition.distance_matrix_estimate-136"><span class="linenos">136</span></a>        <span class="n">packing_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="Composition.distance_matrix_estimate-137"><a href="#Composition.distance_matrix_estimate-137"><span class="linenos">137</span></a>    <span class="p">):</span>
</span><span id="Composition.distance_matrix_estimate-138"><a href="#Composition.distance_matrix_estimate-138"><span class="linenos">138</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Composition.distance_matrix_estimate-139"><a href="#Composition.distance_matrix_estimate-139"><span class="linenos">139</span></a><span class="sd">        Gives the estimated element-element distances using the reported radii</span>
</span><span id="Composition.distance_matrix_estimate-140"><a href="#Composition.distance_matrix_estimate-140"><span class="linenos">140</span></a><span class="sd">        for each element in the composition.</span>
</span><span id="Composition.distance_matrix_estimate-141"><a href="#Composition.distance_matrix_estimate-141"><span class="linenos">141</span></a>
</span><span id="Composition.distance_matrix_estimate-142"><a href="#Composition.distance_matrix_estimate-142"><span class="linenos">142</span></a><span class="sd">        For example, Mg-O-F would give a symmetric matrix like...</span>
</span><span id="Composition.distance_matrix_estimate-143"><a href="#Composition.distance_matrix_estimate-143"><span class="linenos">143</span></a>
</span><span id="Composition.distance_matrix_estimate-144"><a href="#Composition.distance_matrix_estimate-144"><span class="linenos">144</span></a><span class="sd">        |    | Mg   | O    | F    |</span>
</span><span id="Composition.distance_matrix_estimate-145"><a href="#Composition.distance_matrix_estimate-145"><span class="linenos">145</span></a><span class="sd">        | Mg | 1.5  | 1.05 | 1.   |</span>
</span><span id="Composition.distance_matrix_estimate-146"><a href="#Composition.distance_matrix_estimate-146"><span class="linenos">146</span></a><span class="sd">        | O  | 1.05 | 0.6  | 0.55 |</span>
</span><span id="Composition.distance_matrix_estimate-147"><a href="#Composition.distance_matrix_estimate-147"><span class="linenos">147</span></a><span class="sd">        | F  | 1.   | 0.55 | 0.5  |</span>
</span><span id="Composition.distance_matrix_estimate-148"><a href="#Composition.distance_matrix_estimate-148"><span class="linenos">148</span></a>
</span><span id="Composition.distance_matrix_estimate-149"><a href="#Composition.distance_matrix_estimate-149"><span class="linenos">149</span></a><span class="sd">        #### Parameters</span>
</span><span id="Composition.distance_matrix_estimate-150"><a href="#Composition.distance_matrix_estimate-150"><span class="linenos">150</span></a>
</span><span id="Composition.distance_matrix_estimate-151"><a href="#Composition.distance_matrix_estimate-151"><span class="linenos">151</span></a><span class="sd">        - `radius_method` :</span>
</span><span id="Composition.distance_matrix_estimate-152"><a href="#Composition.distance_matrix_estimate-152"><span class="linenos">152</span></a><span class="sd">            Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.</span>
</span><span id="Composition.distance_matrix_estimate-153"><a href="#Composition.distance_matrix_estimate-153"><span class="linenos">153</span></a><span class="sd">            The default is &quot;ionic&quot;.</span>
</span><span id="Composition.distance_matrix_estimate-154"><a href="#Composition.distance_matrix_estimate-154"><span class="linenos">154</span></a><span class="sd">        - `packing_factor` :</span>
</span><span id="Composition.distance_matrix_estimate-155"><a href="#Composition.distance_matrix_estimate-155"><span class="linenos">155</span></a><span class="sd">            Scaling value for the volume in relation to predict ionic radii.</span>
</span><span id="Composition.distance_matrix_estimate-156"><a href="#Composition.distance_matrix_estimate-156"><span class="linenos">156</span></a><span class="sd">            A value of 1 means the total volume will be exactly same as the sum</span>
</span><span id="Composition.distance_matrix_estimate-157"><a href="#Composition.distance_matrix_estimate-157"><span class="linenos">157</span></a><span class="sd">            of all spheres. Larger values will give smaller volumes. Because this</span>
</span><span id="Composition.distance_matrix_estimate-158"><a href="#Composition.distance_matrix_estimate-158"><span class="linenos">158</span></a><span class="sd">            method is commonly used to define minimum possible distances for</span>
</span><span id="Composition.distance_matrix_estimate-159"><a href="#Composition.distance_matrix_estimate-159"><span class="linenos">159</span></a><span class="sd">            random structure creation, we make the default 0.5.</span>
</span><span id="Composition.distance_matrix_estimate-160"><a href="#Composition.distance_matrix_estimate-160"><span class="linenos">160</span></a>
</span><span id="Composition.distance_matrix_estimate-161"><a href="#Composition.distance_matrix_estimate-161"><span class="linenos">161</span></a><span class="sd">        #### Returns</span>
</span><span id="Composition.distance_matrix_estimate-162"><a href="#Composition.distance_matrix_estimate-162"><span class="linenos">162</span></a>
</span><span id="Composition.distance_matrix_estimate-163"><a href="#Composition.distance_matrix_estimate-163"><span class="linenos">163</span></a><span class="sd">        - `element_distance_matrix` :</span>
</span><span id="Composition.distance_matrix_estimate-164"><a href="#Composition.distance_matrix_estimate-164"><span class="linenos">164</span></a><span class="sd">            A matrix of element-element distances</span>
</span><span id="Composition.distance_matrix_estimate-165"><a href="#Composition.distance_matrix_estimate-165"><span class="linenos">165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Composition.distance_matrix_estimate-166"><a href="#Composition.distance_matrix_estimate-166"><span class="linenos">166</span></a>
</span><span id="Composition.distance_matrix_estimate-167"><a href="#Composition.distance_matrix_estimate-167"><span class="linenos">167</span></a>        <span class="c1"># grab a list of radii (assumed to be in order of elements in composition)</span>
</span><span id="Composition.distance_matrix_estimate-168"><a href="#Composition.distance_matrix_estimate-168"><span class="linenos">168</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radii_estimate</span><span class="p">(</span><span class="n">radius_method</span><span class="p">)</span>
</span><span id="Composition.distance_matrix_estimate-169"><a href="#Composition.distance_matrix_estimate-169"><span class="linenos">169</span></a>
</span><span id="Composition.distance_matrix_estimate-170"><a href="#Composition.distance_matrix_estimate-170"><span class="linenos">170</span></a>        <span class="c1"># multiply the radii by some factor that you want limit the overlap by</span>
</span><span id="Composition.distance_matrix_estimate-171"><a href="#Composition.distance_matrix_estimate-171"><span class="linenos">171</span></a>        <span class="c1"># for example, if we don&#39;t want sites any closer than 50% their radii so</span>
</span><span id="Composition.distance_matrix_estimate-172"><a href="#Composition.distance_matrix_estimate-172"><span class="linenos">172</span></a>        <span class="c1"># we can set factor=0.5.</span>
</span><span id="Composition.distance_matrix_estimate-173"><a href="#Composition.distance_matrix_estimate-173"><span class="linenos">173</span></a>        <span class="c1"># Note, float() strips the unit (ang) from the value to avoid errors.</span>
</span><span id="Composition.distance_matrix_estimate-174"><a href="#Composition.distance_matrix_estimate-174"><span class="linenos">174</span></a>        <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">packing_factor</span><span class="p">)</span> <span class="k">for</span> <span class="n">radius</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">]</span>
</span><span id="Composition.distance_matrix_estimate-175"><a href="#Composition.distance_matrix_estimate-175"><span class="linenos">175</span></a>
</span><span id="Composition.distance_matrix_estimate-176"><a href="#Composition.distance_matrix_estimate-176"><span class="linenos">176</span></a>        <span class="c1"># Create the element distance matrix</span>
</span><span id="Composition.distance_matrix_estimate-177"><a href="#Composition.distance_matrix_estimate-177"><span class="linenos">177</span></a>        <span class="c1"># There doesn&#39;t seem to be an easy way to get iterools.product() to a matrix</span>
</span><span id="Composition.distance_matrix_estimate-178"><a href="#Composition.distance_matrix_estimate-178"><span class="linenos">178</span></a>        <span class="c1"># so I iterate through the possible combinations manually.</span>
</span><span id="Composition.distance_matrix_estimate-179"><a href="#Composition.distance_matrix_estimate-179"><span class="linenos">179</span></a>        <span class="c1"># OPTIMIZE: note this is really a symmetrical matrix so I&#39;m actually caclulating</span>
</span><span id="Composition.distance_matrix_estimate-180"><a href="#Composition.distance_matrix_estimate-180"><span class="linenos">180</span></a>        <span class="c1"># things twice.</span>
</span><span id="Composition.distance_matrix_estimate-181"><a href="#Composition.distance_matrix_estimate-181"><span class="linenos">181</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Composition.distance_matrix_estimate-182"><a href="#Composition.distance_matrix_estimate-182"><span class="linenos">182</span></a>        <span class="k">for</span> <span class="n">radius1</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="Composition.distance_matrix_estimate-183"><a href="#Composition.distance_matrix_estimate-183"><span class="linenos">183</span></a>            <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Composition.distance_matrix_estimate-184"><a href="#Composition.distance_matrix_estimate-184"><span class="linenos">184</span></a>            <span class="k">for</span> <span class="n">radius2</span> <span class="ow">in</span> <span class="n">radii</span><span class="p">:</span>
</span><span id="Composition.distance_matrix_estimate-185"><a href="#Composition.distance_matrix_estimate-185"><span class="linenos">185</span></a>                <span class="n">limit</span> <span class="o">=</span> <span class="n">radius1</span> <span class="o">+</span> <span class="n">radius2</span>
</span><span id="Composition.distance_matrix_estimate-186"><a href="#Composition.distance_matrix_estimate-186"><span class="linenos">186</span></a>                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
</span><span id="Composition.distance_matrix_estimate-187"><a href="#Composition.distance_matrix_estimate-187"><span class="linenos">187</span></a>            <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="Composition.distance_matrix_estimate-188"><a href="#Composition.distance_matrix_estimate-188"><span class="linenos">188</span></a>        <span class="c1"># convert the result matrix of list matrix to a numpy array before returning</span>
</span><span id="Composition.distance_matrix_estimate-189"><a href="#Composition.distance_matrix_estimate-189"><span class="linenos">189</span></a>        <span class="n">element_distance_matrix</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="Composition.distance_matrix_estimate-190"><a href="#Composition.distance_matrix_estimate-190"><span class="linenos">190</span></a>        <span class="k">return</span> <span class="n">element_distance_matrix</span>
</span></pre></div>


            <div class="docstring"><p>Gives the estimated element-element distances using the reported radii
for each element in the composition.</p>

<p>For example, Mg-O-F would give a symmetric matrix like...</p>

<p>|    | Mg   | O    | F    |
| Mg | 1.5  | 1.05 | 1.   |
| O  | 1.05 | 0.6  | 0.55 |
| F  | 1.   | 0.55 | 0.5  |</p>

<h4 id="parameters">Parameters</h4>

<ul>
<li><code>radius_method</code> :
Options are atomic; atomic_calculated; van_der_waals; metallic; ionic.
The default is "ionic".</li>
<li><code>packing_factor</code> :
Scaling value for the volume in relation to predict ionic radii.
A value of 1 means the total volume will be exactly same as the sum
of all spheres. Larger values will give smaller volumes. Because this
method is commonly used to define minimum possible distances for
random structure creation, we make the default 0.5.</li>
</ul>

<h4 id="returns">Returns</h4>

<ul>
<li><code>element_distance_matrix</code> :
A matrix of element-element distances</li>
</ul>
</div>


                            </div>
                            <div id="Composition.chemical_subsystems" class="classattr">
                                <div class="attr variable">
            <span class="name">chemical_subsystems</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#Composition.chemical_subsystems"></a>
    
            <div class="docstring"><p>Returns all chemical systems of this composition's chemical system.</p>

<p>For example, Y2C has the chemical system "Y-C" and would return
["Y", "C", "C-Y"]. Note that the returned list has elements of a given
system in alphabetical order (i.e. it gives "C-Y" and not "Y-C")</p>

<h4 id="returns">Returns</h4>

<ul>
<li><code>subsystems</code>:
A list of chemical systems that make up the input chemical system.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>pymatgen.core.composition.Composition</dt>
                                <dd id="Composition.__init__" class="function"><a href="#Composition.__init__">Composition</a></dd>
                <dd id="Composition.amount_tolerance" class="variable"><a href="#Composition.amount_tolerance">amount_tolerance</a></dd>
                <dd id="Composition.special_formulas" class="variable"><a href="#Composition.special_formulas">special_formulas</a></dd>
                <dd id="Composition.oxi_prob" class="variable"><a href="#Composition.oxi_prob">oxi_prob</a></dd>
                <dd id="Composition.average_electroneg" class="variable"><a href="#Composition.average_electroneg">average_electroneg</a></dd>
                <dd id="Composition.total_electrons" class="variable"><a href="#Composition.total_electrons">total_electrons</a></dd>
                <dd id="Composition.almost_equals" class="function"><a href="#Composition.almost_equals">almost_equals</a></dd>
                <dd id="Composition.is_element" class="variable"><a href="#Composition.is_element">is_element</a></dd>
                <dd id="Composition.copy" class="function"><a href="#Composition.copy">copy</a></dd>
                <dd id="Composition.formula" class="variable"><a href="#Composition.formula">formula</a></dd>
                <dd id="Composition.alphabetical_formula" class="variable"><a href="#Composition.alphabetical_formula">alphabetical_formula</a></dd>
                <dd id="Composition.iupac_formula" class="variable"><a href="#Composition.iupac_formula">iupac_formula</a></dd>
                <dd id="Composition.element_composition" class="variable"><a href="#Composition.element_composition">element_composition</a></dd>
                <dd id="Composition.fractional_composition" class="variable"><a href="#Composition.fractional_composition">fractional_composition</a></dd>
                <dd id="Composition.reduced_composition" class="variable"><a href="#Composition.reduced_composition">reduced_composition</a></dd>
                <dd id="Composition.get_reduced_composition_and_factor" class="function"><a href="#Composition.get_reduced_composition_and_factor">get_reduced_composition_and_factor</a></dd>
                <dd id="Composition.get_reduced_formula_and_factor" class="function"><a href="#Composition.get_reduced_formula_and_factor">get_reduced_formula_and_factor</a></dd>
                <dd id="Composition.get_integer_formula_and_factor" class="function"><a href="#Composition.get_integer_formula_and_factor">get_integer_formula_and_factor</a></dd>
                <dd id="Composition.reduced_formula" class="variable"><a href="#Composition.reduced_formula">reduced_formula</a></dd>
                <dd id="Composition.hill_formula" class="variable"><a href="#Composition.hill_formula">hill_formula</a></dd>
                <dd id="Composition.elements" class="variable"><a href="#Composition.elements">elements</a></dd>
                <dd id="Composition.to_pretty_string" class="function"><a href="#Composition.to_pretty_string">to_pretty_string</a></dd>
                <dd id="Composition.num_atoms" class="variable"><a href="#Composition.num_atoms">num_atoms</a></dd>
                <dd id="Composition.weight" class="variable"><a href="#Composition.weight">weight</a></dd>
                <dd id="Composition.get_atomic_fraction" class="function"><a href="#Composition.get_atomic_fraction">get_atomic_fraction</a></dd>
                <dd id="Composition.get_wt_fraction" class="function"><a href="#Composition.get_wt_fraction">get_wt_fraction</a></dd>
                <dd id="Composition.contains_element_type" class="function"><a href="#Composition.contains_element_type">contains_element_type</a></dd>
                <dd id="Composition.anonymized_formula" class="variable"><a href="#Composition.anonymized_formula">anonymized_formula</a></dd>
                <dd id="Composition.chemical_system" class="variable"><a href="#Composition.chemical_system">chemical_system</a></dd>
                <dd id="Composition.valid" class="variable"><a href="#Composition.valid">valid</a></dd>
                <dd id="Composition.from_dict" class="function"><a href="#Composition.from_dict">from_dict</a></dd>
                <dd id="Composition.get_el_amt_dict" class="function"><a href="#Composition.get_el_amt_dict">get_el_amt_dict</a></dd>
                <dd id="Composition.as_dict" class="function"><a href="#Composition.as_dict">as_dict</a></dd>
                <dd id="Composition.to_reduced_dict" class="variable"><a href="#Composition.to_reduced_dict">to_reduced_dict</a></dd>
                <dd id="Composition.to_data_dict" class="variable"><a href="#Composition.to_data_dict">to_data_dict</a></dd>
                <dd id="Composition.oxi_state_guesses" class="function"><a href="#Composition.oxi_state_guesses">oxi_state_guesses</a></dd>
                <dd id="Composition.replace" class="function"><a href="#Composition.replace">replace</a></dd>
                <dd id="Composition.add_charges_from_oxi_state_guesses" class="function"><a href="#Composition.add_charges_from_oxi_state_guesses">add_charges_from_oxi_state_guesses</a></dd>
                <dd id="Composition.remove_charges" class="function"><a href="#Composition.remove_charges">remove_charges</a></dd>
                <dd id="Composition.ranked_compositions_from_indeterminate_formula" class="function"><a href="#Composition.ranked_compositions_from_indeterminate_formula">ranked_compositions_from_indeterminate_formula</a></dd>

            </div>
            <div><dt>monty.json.MSONable</dt>
                                <dd id="Composition.REDIRECT" class="variable">REDIRECT</dd>
                <dd id="Composition.to_json" class="function">to_json</dd>
                <dd id="Composition.unsafe_hash" class="function">unsafe_hash</dd>
                <dd id="Composition.validate_monty" class="function">validate_monty</dd>

            </div>
            <div><dt>pymatgen.util.string.Stringify</dt>
                                <dd id="Composition.STRING_MODE" class="variable">STRING_MODE</dd>
                <dd id="Composition.to_latex_string" class="function">to_latex_string</dd>
                <dd id="Composition.to_html_string" class="function">to_html_string</dd>
                <dd id="Composition.to_unicode_string" class="function">to_unicode_string</dd>

            </div>
            <div><dt>collections.abc.Mapping</dt>
                                <dd id="Composition.get" class="function">get</dd>
                <dd id="Composition.keys" class="function">keys</dd>
                <dd id="Composition.items" class="function">items</dd>
                <dd id="Composition.values" class="function">values</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>