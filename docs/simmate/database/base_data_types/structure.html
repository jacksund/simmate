<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 9.0.1" />
    <title>simmate.database.base_data_types.structure API documentation</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%2244.5%202.5%2015%2015%22%3E%3Cpath%20d%3D%22M49.351%2021.041c-.233-.721-.546-2.408-.772-4.076-.042-.09-.067-.187-.046-.288-.166-1.347-.277-2.625-.241-3.351-1.378-1.008-2.271-2.586-2.271-4.362%200-.976.272-1.935.788-2.774.057-.094.122-.18.184-.268-.033-.167-.052-.339-.052-.516%200-1.477%201.202-2.679%202.679-2.679.791%200%201.496.352%201.987.9a6.3%206.3%200%200%201%201.001.029c.492-.564%201.207-.929%202.012-.929%201.477%200%202.679%201.202%202.679%202.679a2.65%202.65%200%200%201-.269%201.148c.383.747.595%201.572.595%202.41%200%202.311-1.507%204.29-3.635%205.107.037.699.147%202.27.423%203.294l.137.461c.156%202.136-4.612%205.166-5.199%203.215zm.127-4.919a4.78%204.78%200%200%200%20.775-.584c-.172-.115-.505-.254-.88-.378zm.331%202.302l.828-.502c-.202-.143-.576-.328-.984-.49zm.45%202.157l.701-.403c-.214-.115-.536-.249-.891-.376l.19.779zM49.13%204.141c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm.735-.389a1.15%201.15%200%200%201%20.314.783%201.16%201.16%200%200%201-1.162%201.162c-.457%200-.842-.27-1.032-.653-.026.117-.042.238-.042.362a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.843-.626-1.535-1.436-1.654zm3.076%201.654a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.037-.009-.072-.011-.109-.21.3-.541.508-.935.508a1.16%201.16%200%200%201-1.162-1.162%201.14%201.14%200%200%201%20.474-.912c-.015%200-.03-.005-.045-.005-.926.001-1.679.754-1.679%201.68zm1.861-1.265c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm1.823%204.823c0-.52-.103-1.035-.288-1.52-.466.394-1.06.64-1.717.64-1.144%200-2.116-.725-2.499-1.738-.383%201.012-1.355%201.738-2.499%201.738-.867%200-1.631-.421-2.121-1.062-.307.605-.478%201.267-.478%201.942%200%202.486%202.153%204.51%204.801%204.51s4.801-2.023%204.801-4.51zm-3.032%209.156l-.146-.492c-.276-1.02-.395-2.457-.444-3.268a6.11%206.11%200%200%201-1.18.115%206.01%206.01%200%200%201-2.536-.562l.006.175c.802.215%201.848.612%202.021%201.25.079.295-.021.601-.274.837l-.598.501c.667.304%201.243.698%201.311%201.179.02.144.022.507-.393.787l-.564.365c1.285.521%201.361.96%201.381%201.126.018.142.011.496-.427.746l-.854.489c.064-1.19%201.985-2.585%202.697-3.248zM49.34%209.925c0-.667%201-.667%201%200%200%20.653.818%201.205%201.787%201.205s1.787-.552%201.787-1.205c0-.667%201-.667%201%200%200%201.216-1.25%202.205-2.787%202.205s-2.787-.989-2.787-2.205zm-.887-7.633c-.093.077-.205.114-.317.114a.5.5%200%200%201-.318-.886L49.183.397a.5.5%200%200%201%20.703.068.5.5%200%200%201-.069.703zm7.661-.065c-.086%200-.173-.022-.253-.068l-1.523-.893c-.575-.337-.069-1.2.506-.863l1.523.892a.5.5%200%200%201%20.179.685c-.094.158-.261.247-.432.247z%22%20fill%3D%22%233bb300%22/%3E%3C/svg%3E"/>


<style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style>/*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}</style>
<style>/*! pdoc */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f7f7f7;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{filter:opacity(1);}.pdoc details:not([open]){height:0;}.pdoc details > summary{position:absolute;top:-35px;right:0;font-size:.75rem;color:var(--muted);padding:0 .7em;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:2.5rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;user-select:none;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:.5rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
</head>
<body>        <nav class="pdoc">
            <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
            <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
            <div>
                        <a class="pdoc-button module-list-button" href="../base_data_types.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                            &nbsp;simmate.database.base_data_types</a>

<a href="https://github.com/jacksund/simmate">                        <img src="https://github.com/jacksund/simmate/blob/main/logo/simmate.svg?raw=true" class="logo" alt="project logo"/>
</a>
                        <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                               pattern=".+" required>



                    <h2>API Documentation</h2>
                        <ul class="memberlist">
            <li>
                    <a class="class" href="#Structure">Structure</a>
                            <ul class="memberlist">
                        <li>
                                <a class="class" href="#Structure.Meta">Structure.Meta</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#Structure.Meta.__init__">Meta</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#Structure.Meta.abstract">abstract</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="variable" href="#Structure.base_info">base_info</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.structure_string">structure_string</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.source">source</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.nsites">nsites</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.nelements">nelements</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.elements">elements</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.chemical_system">chemical_system</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.density">density</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.density_atomic">density_atomic</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.volume">volume</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.volume_molar">volume_molar</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.formula_full">formula_full</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.formula_reduced">formula_reduced</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.formula_anonymous">formula_anonymous</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.spacegroup">spacegroup</a>
                        </li>
                        <li>
                                <a class="function" href="#Structure.to_toolkit">to_toolkit</a>
                        </li>
                        <li>
                                <a class="variable" href="#Structure.spacegroup_id">spacegroup_id</a>
                        </li>
                </ul>

            </li>
    </ul>



                    <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <span class="visually-hidden">pdoc</span><img
                            alt="pdoc logo"
                            src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
                    </a>
            </div>
        </nav>
    <main class="pdoc">
            <section>
                        <a class="pdoc-button git-button" href="https://github.com/jacksund/simmate/tree/main/src/simmate/database/base_data_types/structure.py">Edit on GitHub</a>
                    <h1 class="modulename">
<a href="./../../../simmate.html">simmate</a><wbr>.<a href="./../../database.html">database</a><wbr>.<a href="./../base_data_types.html">base_data_types</a><wbr>.structure    </h1>

                
                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="n">Avogadro</span>

<span class="kn">from</span> <span class="nn">simmate.toolkit</span> <span class="kn">import</span> <span class="n">Structure</span> <span class="k">as</span> <span class="n">ToolkitStructure</span>

<span class="c1"># from pymatgen.analysis.prototypes import AflowPrototypeMatcher</span>

<span class="kn">from</span> <span class="nn">simmate.database.base_data_types</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DatabaseTable</span><span class="p">,</span>
    <span class="n">table_column</span><span class="p">,</span>
    <span class="n">Spacegroup</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">Structure</span><span class="p">(</span><span class="n">DatabaseTable</span><span class="p">):</span>
    <span class="c1"># This is an abstract class meant for inheritance</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">base_info</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;structure_string&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">]</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The base information for this database table. All other columns can be calculated</span>
<span class="sd">    using the columns in this list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">structure_string</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The core structure information, which is written to a string and in a </span>
<span class="sd">    compressed format using the `from_toolkit` method. To get back to our toolkit</span>
<span class="sd">    structure object, use the `to_toolkit` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># EXPERIMENTAL</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">JSONField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Where the structure came from. This could be a number of things, including</span>
<span class="sd">    a third party id, a transformation of another structure, a creation method,</span>
<span class="sd">    or just a custom submission by the user.</span>
<span class="sd">    </span>
<span class="sd">    Source can be the name of another table or a python transformation.</span>
<span class="sd">    Source id can be thought of as the &quot;parent structure id&quot;, which can be a</span>
<span class="sd">    string (mp-123), an integer (123 of same table), a list of these ([123,321]),</span>
<span class="sd">    or even be nothing. We make it a JSON field to account for all scenarios.</span>
<span class="sd">    </span>
<span class="sd">    EXAMPLES: (source --&gt; source_id)</span>
<span class="sd">    </span>
<span class="sd">    - MaterialsProject --&gt; mp-123</span>
<span class="sd">    - PyXtalStructure --&gt; null</span>
<span class="sd">    - AtomicPurmutation --&gt; 123</span>
<span class="sd">    - HereditaryMutation --&gt; [123,124]</span>
<span class="sd">    - user_submission --&gt; null</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># EXPERIMENTAL</span>
    <span class="c1"># Where this calculation plays a role within a &quot;nested&quot; workflow calculation.</span>
    <span class="c1"># Becuase this structure can be reused by multiple workflows, we make this</span>
    <span class="c1"># a list of source-like objects. For example, a relaxation could be part of</span>
    <span class="c1"># a series of relaxations (like in StagedRelaxation) or it can be an initial</span>
    <span class="c1"># step of a BandStructure calculation.</span>
    <span class="c1"># parent_nested_calculations = table_column.JSONField(blank=True, null=True)</span>

    <span class="sd">&quot;&quot;&quot; Query-helper Info &quot;&quot;&quot;</span>

    <span class="n">nsites</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    total number of sites in the unitcell</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nelements</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    total number of unique elements</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">elements</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">JSONField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of elements in the structure (ex: [&quot;Y&quot;, &quot;C&quot;, &quot;F&quot;])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">chemical_system</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    the base chemical system (ex: &quot;Y-C-F&quot;)</span>
<span class="sd">    </span>
<span class="sd">    Note: be careful when searching for elements! Running chemical_system__includes=&quot;C&quot;</span>
<span class="sd">    on this field won&#39;t do what you expect -- because it will return structures</span>
<span class="sd">    containing Ca, Cs, Ce, Cl, and so on. If you want to search for structures</span>
<span class="sd">    that contain a specific element, use elements__contains=&quot;C&quot; instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">density</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Density of the crystal (g/cm^3)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">density_atomic</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Density of atoms in the crystal (atoms/Angstom^3)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">volume</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Volume of the unitcell.</span>
<span class="sd">    </span>
<span class="sd">    Note: in most cases, `volume_molar` should be used instead! This is because</span>
<span class="sd">    volumne is highly dependent on the symmetry and the arbitray unitcell. If </span>
<span class="sd">    you are truly after small volumes of the unitcell, it is likely you really </span>
<span class="sd">    just want to search by spacegroup.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">volume_molar</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Molar volume of the crystal (cm^3/mol)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># The composition of the structure formatted in various ways</span>
    <span class="c1"># BUG: The max length here is overkill because there are many structures</span>
    <span class="c1"># with 8+ elements and disordered formula (e.g. &quot;Ca2.103 N0.98&quot;)</span>

    <span class="n">formula_full</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The chemical formula with elements sorted by electronegativity (ex: Li4 Fe4 P4 O16)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">formula_reduced</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The reduced chemical formula. (ex: Li4Fe4P4O16 --&gt; LiFePO4)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">formula_anonymous</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An anonymized formula. Unique species are arranged in ordering of </span>
<span class="sd">    amounts and assigned ascending alphabets. Useful for prototyping formulas. </span>
<span class="sd">    For example, all stoichiometric perovskites have anonymized_formula ABC3.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># NOTE: extra fields for the Lattice and Sites are intentionally left out</span>
    <span class="c1"># in order to save on overall database size. Things such as...</span>
    <span class="c1">#   Lattice: matrix and then... a, b, c, alpha, beta, gamma, volume</span>
    <span class="c1">#   Sites: abc, xyz, properties, species/element, occupancy</span>
    <span class="c1"># shouldn&#39;t be queried directly. If you&#39;d like to sort structures by these</span>
    <span class="c1"># criteria, you can still do this in python and pandas! Just not at the</span>
    <span class="c1"># SQL level</span>

    <span class="sd">&quot;&quot;&quot; Relationships &quot;&quot;&quot;</span>
    <span class="c1"># For the majority of Structures, you&#39;ll want to have a &quot;source&quot; relation that</span>
    <span class="c1"># indicates where the structure came from. I don&#39;t include this is the abstract</span>
    <span class="c1"># model but there are many ways to define it. For example it may relate to another</span>
    <span class="c1"># Structure table or even a Calculation. In another case, the entire Structure</span>
    <span class="c1"># table may have the same exact source, in which case you&#39;d make a property!</span>

    <span class="n">spacegroup</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Spacegroup</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Spacegroup information. Points to simmate.database.base_data_types.symmetry.Spacegroup</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># The AFLOW prototype that this structure maps to.</span>
    <span class="c1"># TODO: this will be a relationship in the future</span>
    <span class="c1"># prototype = table_column.CharField(max_length=50, blank=True, null=True)</span>

    <span class="sd">&quot;&quot;&quot; Model Methods &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_toolkit</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">structure</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># BUG: This is an old line and I can&#39;t remember why I have it. Once I</span>
        <span class="c1"># have implemented more unittests, consider deleting. This method is</span>
        <span class="c1"># ment to convert to a ToolkitStructure, but the structure should</span>
        <span class="c1"># already be in this format...</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="n">ToolkitStructure</span><span class="o">.</span><span class="n">from_dynamic</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>

        <span class="c1"># OPTIMIZE: I currently store files as poscar strings for ordered structures</span>
        <span class="c1"># and as CIFs for disordered structures. Both of this include excess information</span>
        <span class="c1"># that slightly inflates file size, so I will be making a new string format in</span>
        <span class="c1"># the future. This will largely be based off the POSCAR format, but will</span>
        <span class="c1"># account for disordered structures and all limit repeated data (such as the</span>
        <span class="c1"># header line, &quot;direct&quot;, listing each element/composition, etc.).</span>
        <span class="n">storage_format</span> <span class="o">=</span> <span class="s2">&quot;POSCAR&quot;</span> <span class="k">if</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_ordered</span> <span class="k">else</span> <span class="s2">&quot;CIF&quot;</span>

        <span class="c1"># OPTIMIZE</span>
        <span class="c1"># This attempts to match the structure to an AFLOW prototype and it is</span>
        <span class="c1"># by far the slowest step of loading structures to the database. Try</span>
        <span class="c1"># to optimize this in the future.</span>
        <span class="c1"># prototype = AflowPrototypeMatcher().get_prototypes(structure)</span>
        <span class="c1"># prototype_name = prototype[0][&quot;tags&quot;][&quot;mineral&quot;] if prototype else None</span>

        <span class="c1"># Given a pymatgen structure object, this will return a database structure</span>
        <span class="c1"># object, but will NOT save it to the database yet. The kwargs input</span>
        <span class="c1"># is only if you inherit from this class and add extra fields.</span>
        <span class="n">structure_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">structure_string</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">storage_format</span><span class="p">),</span>
            <span class="n">nsites</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">num_sites</span><span class="p">,</span>
            <span class="n">nelements</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="p">),</span>
            <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">elements</span><span class="p">],</span>
            <span class="n">chemical_system</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">chemical_system</span><span class="p">,</span>
            <span class="n">density</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="p">,</span>
            <span class="n">density_atomic</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">num_sites</span> <span class="o">/</span> <span class="n">structure</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span>
            <span class="n">volume</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span>
            <span class="c1"># 1e-27 is to convert from cubic angstroms to Liter and then 1e3 to</span>
            <span class="c1"># mL. Therefore this value is in mL/mol</span>
            <span class="c1"># OPTIMIZE: move this to a class method</span>
            <span class="n">volume_molar</span><span class="o">=</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">volume</span> <span class="o">/</span> <span class="n">structure</span><span class="o">.</span><span class="n">num_sites</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">Avogadro</span>
            <span class="o">*</span> <span class="mf">1e-27</span>
            <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span>
            <span class="n">spacegroup_id</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">get_space_group_info</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># OPTIMIZE</span>
            <span class="n">formula_full</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span>
            <span class="n">formula_reduced</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">reduced_formula</span><span class="p">,</span>
            <span class="n">formula_anonymous</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">anonymized_formula</span><span class="p">,</span>
            <span class="c1"># prototype=prototype_name,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>  <span class="c1"># this allows subclasses to add fields with ease</span>
        <span class="p">)</span>
        <span class="c1"># If as_dict is false, we build this into an Object. Otherwise, just</span>
        <span class="c1"># return the dictionary</span>
        <span class="k">return</span> <span class="n">structure_dict</span> <span class="k">if</span> <span class="n">as_dict</span> <span class="k">else</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">structure_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_toolkit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the database object to pymatgen structure object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># NOTE: if you know this is what you&#39;re going to do from a query, then</span>
        <span class="c1"># it is more efficient to only grab the structure_string column because</span>
        <span class="c1"># that&#39;s all you need! You&#39;d do that like this:</span>
        <span class="c1">#   structure_db = Structure.objects.only(&quot;structure_string&quot;).get(id=&quot;example-id&quot;)</span>
        <span class="c1"># This grabs the proper Structure entry and only the structure column.</span>

        <span class="c1"># convert the stored string to python dictionary.</span>
        <span class="c1"># OPTIMIZE: see my comment on storing strings in the from_toolkit method above.</span>
        <span class="c1"># For now, I need to figure out if I used &quot;CIF&quot; or &quot;POSCAR&quot; and read the structure</span>
        <span class="c1"># accordingly. In the future, I can just assume my new format.</span>
        <span class="c1"># If the string starts with &quot;#&quot;, then I know that I stored it as a &quot;CIF&quot;.</span>
        <span class="n">storage_format</span> <span class="o">=</span> <span class="s2">&quot;CIF&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure_string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;POSCAR&quot;</span>

        <span class="c1"># convert the string to pymatgen Structure object</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="n">ToolkitStructure</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structure_string</span><span class="p">,</span>
            <span class="n">fmt</span><span class="o">=</span><span class="n">storage_format</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">structure</span>


<span class="c1"># TODO:</span>
<span class="c1"># Explore polymorphic relations instead of a JSON dictionary.</span>
<span class="c1"># Making relationships to different tables makes things difficult to use, so</span>
<span class="c1"># these columns are just standalone.</span>
<span class="c1">#</span>
<span class="c1"># This is will be very important for &quot;source&quot; and &quot;parent_nested_calculations&quot;</span>
<span class="c1"># fields because I have no way to efficiently convert these fields to the objects</span>
<span class="c1"># that they refer to. There&#39;s also no good way to access a structure&#39;s &quot;children&quot;</span>
<span class="c1"># (i.e. structure where they are the source).</span>
<span class="c1">#</span>
<span class="c1"># I should investigate generic relations in django though:</span>
<span class="c1"># https://docs.djangoproject.com/en/3.2/ref/contrib/contenttypes/#generic-relations</span>
<span class="c1">#</span>
<span class="c1"># Another option is using django-polymorphic.</span>
<span class="c1"># https://django-polymorphic.readthedocs.io/en/latest/</span>
<span class="c1"># This thread is really helpful on the subject:</span>
<span class="c1"># https://stackoverflow.com/questions/30343212/</span>

<span class="c1"># TODO:</span>
<span class="c1"># Consider adding some methods to track the history of a structure. This</span>
<span class="c1"># would be useful for things like evolutionary algorithms.</span>
<span class="c1"># get_source_parent:</span>
<span class="c1">#   this would iterate through sources until we find one in the same table</span>
<span class="c1">#   as this one. Parent sources are often the most recent transformation</span>
<span class="c1">#   or mutation applied to a structure, such as a MirrorMutation.</span>
<span class="c1"># get_source_seed:</span>
<span class="c1">#   this would iterate through sources until we hit a dead-end. So the seed</span>
<span class="c1">#   source would be something like a third-party database, a method that</span>
<span class="c1">#   randomly create structures, or a prototype.</span>
<span class="c1"># Both of these get more complex when we consider transformation that have</span>
<span class="c1"># multiple parents (and therefore multiple seeds too). An example of this</span>
<span class="c1"># is the HereditaryMutation.</span>
</pre></div>

        </details>

            </section>
                <section id="Structure">
                                <div class="attr class">
        <a class="headerlink" href="#Structure">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Structure</span><wbr>(<span class="base"><a href="base.html#DatabaseTable">simmate.database.base_data_types.base.DatabaseTable</a></span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Structure</span><span class="p">(</span><span class="n">DatabaseTable</span><span class="p">):</span>
    <span class="c1"># This is an abstract class meant for inheritance</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">base_info</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;structure_string&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">]</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The base information for this database table. All other columns can be calculated</span>
<span class="sd">    using the columns in this list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">structure_string</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The core structure information, which is written to a string and in a </span>
<span class="sd">    compressed format using the `from_toolkit` method. To get back to our toolkit</span>
<span class="sd">    structure object, use the `to_toolkit` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># EXPERIMENTAL</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">JSONField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Where the structure came from. This could be a number of things, including</span>
<span class="sd">    a third party id, a transformation of another structure, a creation method,</span>
<span class="sd">    or just a custom submission by the user.</span>
<span class="sd">    </span>
<span class="sd">    Source can be the name of another table or a python transformation.</span>
<span class="sd">    Source id can be thought of as the &quot;parent structure id&quot;, which can be a</span>
<span class="sd">    string (mp-123), an integer (123 of same table), a list of these ([123,321]),</span>
<span class="sd">    or even be nothing. We make it a JSON field to account for all scenarios.</span>
<span class="sd">    </span>
<span class="sd">    EXAMPLES: (source --&gt; source_id)</span>
<span class="sd">    </span>
<span class="sd">    - MaterialsProject --&gt; mp-123</span>
<span class="sd">    - PyXtalStructure --&gt; null</span>
<span class="sd">    - AtomicPurmutation --&gt; 123</span>
<span class="sd">    - HereditaryMutation --&gt; [123,124]</span>
<span class="sd">    - user_submission --&gt; null</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># EXPERIMENTAL</span>
    <span class="c1"># Where this calculation plays a role within a &quot;nested&quot; workflow calculation.</span>
    <span class="c1"># Becuase this structure can be reused by multiple workflows, we make this</span>
    <span class="c1"># a list of source-like objects. For example, a relaxation could be part of</span>
    <span class="c1"># a series of relaxations (like in StagedRelaxation) or it can be an initial</span>
    <span class="c1"># step of a BandStructure calculation.</span>
    <span class="c1"># parent_nested_calculations = table_column.JSONField(blank=True, null=True)</span>

    <span class="sd">&quot;&quot;&quot; Query-helper Info &quot;&quot;&quot;</span>

    <span class="n">nsites</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    total number of sites in the unitcell</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nelements</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    total number of unique elements</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">elements</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">JSONField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of elements in the structure (ex: [&quot;Y&quot;, &quot;C&quot;, &quot;F&quot;])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">chemical_system</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    the base chemical system (ex: &quot;Y-C-F&quot;)</span>
<span class="sd">    </span>
<span class="sd">    Note: be careful when searching for elements! Running chemical_system__includes=&quot;C&quot;</span>
<span class="sd">    on this field won&#39;t do what you expect -- because it will return structures</span>
<span class="sd">    containing Ca, Cs, Ce, Cl, and so on. If you want to search for structures</span>
<span class="sd">    that contain a specific element, use elements__contains=&quot;C&quot; instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">density</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Density of the crystal (g/cm^3)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">density_atomic</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Density of atoms in the crystal (atoms/Angstom^3)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">volume</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Volume of the unitcell.</span>
<span class="sd">    </span>
<span class="sd">    Note: in most cases, `volume_molar` should be used instead! This is because</span>
<span class="sd">    volumne is highly dependent on the symmetry and the arbitray unitcell. If </span>
<span class="sd">    you are truly after small volumes of the unitcell, it is likely you really </span>
<span class="sd">    just want to search by spacegroup.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">volume_molar</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Molar volume of the crystal (cm^3/mol)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># The composition of the structure formatted in various ways</span>
    <span class="c1"># BUG: The max length here is overkill because there are many structures</span>
    <span class="c1"># with 8+ elements and disordered formula (e.g. &quot;Ca2.103 N0.98&quot;)</span>

    <span class="n">formula_full</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The chemical formula with elements sorted by electronegativity (ex: Li4 Fe4 P4 O16)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">formula_reduced</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The reduced chemical formula. (ex: Li4Fe4P4O16 --&gt; LiFePO4)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">formula_anonymous</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An anonymized formula. Unique species are arranged in ordering of </span>
<span class="sd">    amounts and assigned ascending alphabets. Useful for prototyping formulas. </span>
<span class="sd">    For example, all stoichiometric perovskites have anonymized_formula ABC3.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># NOTE: extra fields for the Lattice and Sites are intentionally left out</span>
    <span class="c1"># in order to save on overall database size. Things such as...</span>
    <span class="c1">#   Lattice: matrix and then... a, b, c, alpha, beta, gamma, volume</span>
    <span class="c1">#   Sites: abc, xyz, properties, species/element, occupancy</span>
    <span class="c1"># shouldn&#39;t be queried directly. If you&#39;d like to sort structures by these</span>
    <span class="c1"># criteria, you can still do this in python and pandas! Just not at the</span>
    <span class="c1"># SQL level</span>

    <span class="sd">&quot;&quot;&quot; Relationships &quot;&quot;&quot;</span>
    <span class="c1"># For the majority of Structures, you&#39;ll want to have a &quot;source&quot; relation that</span>
    <span class="c1"># indicates where the structure came from. I don&#39;t include this is the abstract</span>
    <span class="c1"># model but there are many ways to define it. For example it may relate to another</span>
    <span class="c1"># Structure table or even a Calculation. In another case, the entire Structure</span>
    <span class="c1"># table may have the same exact source, in which case you&#39;d make a property!</span>

    <span class="n">spacegroup</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Spacegroup</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Spacegroup information. Points to simmate.database.base_data_types.symmetry.Spacegroup</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># The AFLOW prototype that this structure maps to.</span>
    <span class="c1"># TODO: this will be a relationship in the future</span>
    <span class="c1"># prototype = table_column.CharField(max_length=50, blank=True, null=True)</span>

    <span class="sd">&quot;&quot;&quot; Model Methods &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_toolkit</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">structure</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># BUG: This is an old line and I can&#39;t remember why I have it. Once I</span>
        <span class="c1"># have implemented more unittests, consider deleting. This method is</span>
        <span class="c1"># ment to convert to a ToolkitStructure, but the structure should</span>
        <span class="c1"># already be in this format...</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="n">ToolkitStructure</span><span class="o">.</span><span class="n">from_dynamic</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>

        <span class="c1"># OPTIMIZE: I currently store files as poscar strings for ordered structures</span>
        <span class="c1"># and as CIFs for disordered structures. Both of this include excess information</span>
        <span class="c1"># that slightly inflates file size, so I will be making a new string format in</span>
        <span class="c1"># the future. This will largely be based off the POSCAR format, but will</span>
        <span class="c1"># account for disordered structures and all limit repeated data (such as the</span>
        <span class="c1"># header line, &quot;direct&quot;, listing each element/composition, etc.).</span>
        <span class="n">storage_format</span> <span class="o">=</span> <span class="s2">&quot;POSCAR&quot;</span> <span class="k">if</span> <span class="n">structure</span><span class="o">.</span><span class="n">is_ordered</span> <span class="k">else</span> <span class="s2">&quot;CIF&quot;</span>

        <span class="c1"># OPTIMIZE</span>
        <span class="c1"># This attempts to match the structure to an AFLOW prototype and it is</span>
        <span class="c1"># by far the slowest step of loading structures to the database. Try</span>
        <span class="c1"># to optimize this in the future.</span>
        <span class="c1"># prototype = AflowPrototypeMatcher().get_prototypes(structure)</span>
        <span class="c1"># prototype_name = prototype[0][&quot;tags&quot;][&quot;mineral&quot;] if prototype else None</span>

        <span class="c1"># Given a pymatgen structure object, this will return a database structure</span>
        <span class="c1"># object, but will NOT save it to the database yet. The kwargs input</span>
        <span class="c1"># is only if you inherit from this class and add extra fields.</span>
        <span class="n">structure_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">structure_string</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">storage_format</span><span class="p">),</span>
            <span class="n">nsites</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">num_sites</span><span class="p">,</span>
            <span class="n">nelements</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="p">),</span>
            <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">elements</span><span class="p">],</span>
            <span class="n">chemical_system</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">chemical_system</span><span class="p">,</span>
            <span class="n">density</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="p">,</span>
            <span class="n">density_atomic</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">num_sites</span> <span class="o">/</span> <span class="n">structure</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span>
            <span class="n">volume</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span>
            <span class="c1"># 1e-27 is to convert from cubic angstroms to Liter and then 1e3 to</span>
            <span class="c1"># mL. Therefore this value is in mL/mol</span>
            <span class="c1"># OPTIMIZE: move this to a class method</span>
            <span class="n">volume_molar</span><span class="o">=</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">volume</span> <span class="o">/</span> <span class="n">structure</span><span class="o">.</span><span class="n">num_sites</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">Avogadro</span>
            <span class="o">*</span> <span class="mf">1e-27</span>
            <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span>
            <span class="n">spacegroup_id</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">get_space_group_info</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># OPTIMIZE</span>
            <span class="n">formula_full</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span>
            <span class="n">formula_reduced</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">reduced_formula</span><span class="p">,</span>
            <span class="n">formula_anonymous</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">anonymized_formula</span><span class="p">,</span>
            <span class="c1"># prototype=prototype_name,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>  <span class="c1"># this allows subclasses to add fields with ease</span>
        <span class="p">)</span>
        <span class="c1"># If as_dict is false, we build this into an Object. Otherwise, just</span>
        <span class="c1"># return the dictionary</span>
        <span class="k">return</span> <span class="n">structure_dict</span> <span class="k">if</span> <span class="n">as_dict</span> <span class="k">else</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">structure_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_toolkit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the database object to pymatgen structure object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># NOTE: if you know this is what you&#39;re going to do from a query, then</span>
        <span class="c1"># it is more efficient to only grab the structure_string column because</span>
        <span class="c1"># that&#39;s all you need! You&#39;d do that like this:</span>
        <span class="c1">#   structure_db = Structure.objects.only(&quot;structure_string&quot;).get(id=&quot;example-id&quot;)</span>
        <span class="c1"># This grabs the proper Structure entry and only the structure column.</span>

        <span class="c1"># convert the stored string to python dictionary.</span>
        <span class="c1"># OPTIMIZE: see my comment on storing strings in the from_toolkit method above.</span>
        <span class="c1"># For now, I need to figure out if I used &quot;CIF&quot; or &quot;POSCAR&quot; and read the structure</span>
        <span class="c1"># accordingly. In the future, I can just assume my new format.</span>
        <span class="c1"># If the string starts with &quot;#&quot;, then I know that I stored it as a &quot;CIF&quot;.</span>
        <span class="n">storage_format</span> <span class="o">=</span> <span class="s2">&quot;CIF&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure_string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;POSCAR&quot;</span>

        <span class="c1"># convert the string to pymatgen Structure object</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="n">ToolkitStructure</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structure_string</span><span class="p">,</span>
            <span class="n">fmt</span><span class="o">=</span><span class="n">storage_format</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">structure</span>
</pre></div>

        </details>

            <div class="docstring"><p>The base class for defining a table in the Simmate database. All tables and
mixins inherit from this class.</p>

<p>Usage is identical to
<a href="https://docs.djangoproject.com/en/4.0/#the-model-layer">Models in Django</a>
where this class only adds extra methods for convenience.</p>
</div>


                            <div id="Structure.base_info" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Structure.base_info">#&nbsp;&nbsp</a>

        <span class="name">base_info</span><span class="default_value"> = [&#39;structure_string&#39;, &#39;source&#39;]</span>
    </div>

            <div class="docstring"><p>The base information for this database table. All other columns can be calculated
using the columns in this list.</p>
</div>


                            </div>
                            <div id="Structure.structure_string" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.structure_string">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">structure_string</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>The core structure information, which is written to a string and in a 
compressed format using the <code><a href="#Structure.from_toolkit">from_toolkit</a></code> method. To get back to our toolkit
structure object, use the <code><a href="#Structure.to_toolkit">to_toolkit</a></code> method.</p>
</div>


                            </div>
                            <div id="Structure.source" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.source">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">source</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>Where the structure came from. This could be a number of things, including
a third party id, a transformation of another structure, a creation method,
or just a custom submission by the user.</p>

<p>Source can be the name of another table or a python transformation.
Source id can be thought of as the "parent structure id", which can be a
string (mp-123), an integer (123 of same table), a list of these ([123,321]),
or even be nothing. We make it a JSON field to account for all scenarios.</p>

<p>EXAMPLES: (source --> source_id)</p>

<ul>
<li>MaterialsProject --> mp-123</li>
<li>PyXtalStructure --> null</li>
<li>AtomicPurmutation --> 123</li>
<li>HereditaryMutation --> [123,124]</li>
<li>user_submission --> null</li>
</ul>
</div>


                            </div>
                            <div id="Structure.nsites" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.nsites">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">nsites</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>total number of sites in the unitcell</p>
</div>


                            </div>
                            <div id="Structure.nelements" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.nelements">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">nelements</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>total number of unique elements</p>
</div>


                            </div>
                            <div id="Structure.elements" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.elements">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">elements</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>List of elements in the structure (ex: ["Y", "C", "F"])</p>
</div>


                            </div>
                            <div id="Structure.chemical_system" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.chemical_system">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">chemical_system</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>the base chemical system (ex: "Y-C-F")</p>

<p>Note: be careful when searching for elements! Running chemical_system__includes="C"
on this field won't do what you expect -- because it will return structures
containing Ca, Cs, Ce, Cl, and so on. If you want to search for structures
that contain a specific element, use elements__contains="C" instead.</p>
</div>


                            </div>
                            <div id="Structure.density" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.density">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">density</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>Density of the crystal (g/cm^3)</p>
</div>


                            </div>
                            <div id="Structure.density_atomic" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.density_atomic">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">density_atomic</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>Density of atoms in the crystal (atoms/Angstom^3)</p>
</div>


                            </div>
                            <div id="Structure.volume" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.volume">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">volume</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>Volume of the unitcell.</p>

<p>Note: in most cases, <code><a href="#Structure.volume_molar">volume_molar</a></code> should be used instead! This is because
volumne is highly dependent on the symmetry and the arbitray unitcell. If 
you are truly after small volumes of the unitcell, it is likely you really 
just want to search by spacegroup.</p>
</div>


                            </div>
                            <div id="Structure.volume_molar" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.volume_molar">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">volume_molar</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>Molar volume of the crystal (cm^3/mol)</p>
</div>


                            </div>
                            <div id="Structure.formula_full" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.formula_full">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">formula_full</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>The chemical formula with elements sorted by electronegativity (ex: Li4 Fe4 P4 O16)</p>
</div>


                            </div>
                            <div id="Structure.formula_reduced" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.formula_reduced">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">formula_reduced</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>The reduced chemical formula. (ex: Li4Fe4P4O16 --> LiFePO4)</p>
</div>


                            </div>
                            <div id="Structure.formula_anonymous" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.formula_anonymous">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">formula_anonymous</span><span class="signature">(unknown)</span>:
    </div>

        
            <div class="docstring"><p>An anonymized formula. Unique species are arranged in ordering of 
amounts and assigned ascending alphabets. Useful for prototyping formulas. 
For example, all stoichiometric perovskites have anonymized_formula ABC3.</p>
</div>


                            </div>
                            <div id="Structure.spacegroup" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Structure.spacegroup">#&nbsp;&nbsp</a>

        <span class="name">spacegroup</span>
    </div>

            <div class="docstring"><p>Spacegroup information. Points to <a href="symmetry.html#Spacegroup">simmate.database.base_data_types.symmetry.Spacegroup</a></p>
</div>


                            </div>
                            <div id="Structure.to_toolkit" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.to_toolkit">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_toolkit</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">to_toolkit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the database object to pymatgen structure object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># NOTE: if you know this is what you&#39;re going to do from a query, then</span>
        <span class="c1"># it is more efficient to only grab the structure_string column because</span>
        <span class="c1"># that&#39;s all you need! You&#39;d do that like this:</span>
        <span class="c1">#   structure_db = Structure.objects.only(&quot;structure_string&quot;).get(id=&quot;example-id&quot;)</span>
        <span class="c1"># This grabs the proper Structure entry and only the structure column.</span>

        <span class="c1"># convert the stored string to python dictionary.</span>
        <span class="c1"># OPTIMIZE: see my comment on storing strings in the from_toolkit method above.</span>
        <span class="c1"># For now, I need to figure out if I used &quot;CIF&quot; or &quot;POSCAR&quot; and read the structure</span>
        <span class="c1"># accordingly. In the future, I can just assume my new format.</span>
        <span class="c1"># If the string starts with &quot;#&quot;, then I know that I stored it as a &quot;CIF&quot;.</span>
        <span class="n">storage_format</span> <span class="o">=</span> <span class="s2">&quot;CIF&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure_string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;POSCAR&quot;</span>

        <span class="c1"># convert the string to pymatgen Structure object</span>
        <span class="n">structure</span> <span class="o">=</span> <span class="n">ToolkitStructure</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structure_string</span><span class="p">,</span>
            <span class="n">fmt</span><span class="o">=</span><span class="n">storage_format</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">structure</span>
</pre></div>

        </details>

            <div class="docstring"><p>Converts the database object to pymatgen structure object</p>
</div>


                            </div>
                            <div id="Structure.spacegroup_id" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Structure.spacegroup_id">#&nbsp;&nbsp</a>

        <span class="name">spacegroup_id</span>
    </div>

    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>django.db.models.base.Model</dt>
                                <dd id="Structure.__init__" class="function">Model</dd>
                <dd id="Structure.from_db" class="function">from_db</dd>
                <dd id="Structure.pk" class="variable">pk</dd>
                <dd id="Structure.get_deferred_fields" class="function">get_deferred_fields</dd>
                <dd id="Structure.refresh_from_db" class="function">refresh_from_db</dd>
                <dd id="Structure.serializable_value" class="function">serializable_value</dd>
                <dd id="Structure.save" class="function">save</dd>
                <dd id="Structure.save_base" class="function">save_base</dd>
                <dd id="Structure.delete" class="function">delete</dd>
                <dd id="Structure.prepare_database_save" class="function">prepare_database_save</dd>
                <dd id="Structure.clean" class="function">clean</dd>
                <dd id="Structure.validate_unique" class="function">validate_unique</dd>
                <dd id="Structure.date_error_message" class="function">date_error_message</dd>
                <dd id="Structure.unique_error_message" class="function">unique_error_message</dd>
                <dd id="Structure.full_clean" class="function">full_clean</dd>
                <dd id="Structure.clean_fields" class="function">clean_fields</dd>
                <dd id="Structure.check" class="function">check</dd>

            </div>
            <div><dt><a href="base.html#DatabaseTable">simmate.database.base_data_types.base.DatabaseTable</a></dt>
                                <dd id="Structure.objects" class="function"><a href="base.html#DatabaseTable.objects">objects</a></dd>
                <dd id="Structure.show_columns" class="function"><a href="base.html#DatabaseTable.show_columns">show_columns</a></dd>
                <dd id="Structure.create_subclass" class="function"><a href="base.html#DatabaseTable.create_subclass">create_subclass</a></dd>
                <dd id="Structure.from_toolkit" class="function"><a href="base.html#DatabaseTable.from_toolkit">from_toolkit</a></dd>
                <dd id="Structure.load_archive" class="function"><a href="base.html#DatabaseTable.load_archive">load_archive</a></dd>
                <dd id="Structure.load_remote_archive" class="function"><a href="base.html#DatabaseTable.load_remote_archive">load_remote_archive</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Structure.Meta">
                                <div class="attr class">
        <a class="headerlink" href="#Structure.Meta">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Structure.Meta</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

        </details>

    

                            <div id="Structure.Meta.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Structure.Meta.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Structure.Meta</span><span class="signature">()</span>
    </div>

        
    

                            </div>
                            <div id="Structure.Meta.abstract" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Structure.Meta.abstract">#&nbsp;&nbsp</a>

        <span class="name">abstract</span><span class="default_value"> = False</span>
    </div>

    

                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>