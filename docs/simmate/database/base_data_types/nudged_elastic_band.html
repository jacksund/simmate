<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.2"/>
    <title>simmate.database.base_data_types.nudged_elastic_band API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../base_data_types.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;simmate.database.base_data_types</a>

<a href="https://github.com/jacksund/simmate">            <img src="https://github.com/jacksund/simmate/blob/main/src/simmate/website/static_files/images/simmate-logo.svg?raw=true" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#DiffusionAnalysis">DiffusionAnalysis</a>
                            <ul class="memberlist">
                        <li>
                                <a class="class" href="#DiffusionAnalysis.Meta">DiffusionAnalysis.Meta</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#DiffusionAnalysis.Meta.__init__">Meta</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#DiffusionAnalysis.Meta.abstract">abstract</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#DiffusionAnalysis.Meta.app_label">app_label</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.migrating_specie">migrating_specie</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.vacancy_mode">vacancy_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.atomic_fraction">atomic_fraction</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.barrier_cell">barrier_cell</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.paths_involved">paths_involved</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.npaths_involved">npaths_involved</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.from_toolkit">from_toolkit</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.from_directory">from_directory</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.create_subclasses">create_subclasses</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.structure_string">structure_string</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.nsites">nsites</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.nelements">nelements</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.elements">elements</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.chemical_system">chemical_system</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.density">density</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.density_atomic">density_atomic</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.volume">volume</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.volume_molar">volume_molar</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.formula_full">formula_full</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.formula_reduced">formula_reduced</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.formula_anonymous">formula_anonymous</a>
                        </li>
                        <li>
                                <a class="variable" href="#DiffusionAnalysis.spacegroup">spacegroup</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.created_at">created_at</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.updated_at">updated_at</a>
                        </li>
                        <li>
                                <a class="function" href="#DiffusionAnalysis.source">source</a>
                        </li>
                        <li>
                                <a class="variable" href="#DiffusionAnalysis.spacegroup_id">spacegroup_id</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MigrationHop">MigrationHop</a>
                            <ul class="memberlist">
                        <li>
                                <a class="class" href="#MigrationHop.Meta">MigrationHop.Meta</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#MigrationHop.Meta.__init__">Meta</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#MigrationHop.Meta.abstract">abstract</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#MigrationHop.Meta.app_label">app_label</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="variable" href="#MigrationHop.base_info">base_info</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.site_start">site_start</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.site_end">site_end</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.index_start">index_start</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.index_end">index_end</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.number">number</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.length">length</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.dimension_path">dimension_path</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.dimension_host_lattice">dimension_host_lattice</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.energy_barrier">energy_barrier</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.to_toolkit">to_toolkit</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.from_directory">from_directory</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.from_pymatgen">from_pymatgen</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.create_subclasses_from_diffusion_analysis">create_subclasses_from_diffusion_analysis</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.created_at">created_at</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.updated_at">updated_at</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationHop.source">source</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MigrationImage">MigrationImage</a>
                            <ul class="memberlist">
                        <li>
                                <a class="class" href="#MigrationImage.Meta">MigrationImage.Meta</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#MigrationImage.Meta.__init__">Meta</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#MigrationImage.Meta.abstract">abstract</a>
                                    </li>
                                    <li>
                                            <a class="variable" href="#MigrationImage.Meta.app_label">app_label</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="variable" href="#MigrationImage.base_info">base_info</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.number">number</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.force_tangent">force_tangent</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.energy">energy</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.structure_distance">structure_distance</a>
                        </li>
                        <li>
                                <a class="variable" href="#MigrationImage.source">source</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.create_subclass_from_migration_hop">create_subclass_from_migration_hop</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.structure_string">structure_string</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.nsites">nsites</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.nelements">nelements</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.elements">elements</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.chemical_system">chemical_system</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.density">density</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.density_atomic">density_atomic</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.volume">volume</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.volume_molar">volume_molar</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.formula_full">formula_full</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.formula_reduced">formula_reduced</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.formula_anonymous">formula_anonymous</a>
                        </li>
                        <li>
                                <a class="variable" href="#MigrationImage.spacegroup">spacegroup</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.created_at">created_at</a>
                        </li>
                        <li>
                                <a class="function" href="#MigrationImage.updated_at">updated_at</a>
                        </li>
                        <li>
                                <a class="variable" href="#MigrationImage.spacegroup_id">spacegroup_id</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/jacksund/simmate/tree/main/src/simmate/database/base_data_types/nudged_elastic_band.py">Edit on GitHub</a>
                    <h1 class="modulename">
<a href="./../../../simmate.html">simmate</a><wbr>.<a href="./../../database.html">database</a><wbr>.<a href="./../base_data_types.html">base_data_types</a><wbr>.nudged_elastic_band    </h1>

                        <div class="docstring"><p>WARNING: This module is experimental and subject to change.</p>
</div>

                        <input id="nudged_elastic_band-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="nudged_elastic_band-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">WARNING: This module is experimental and subject to change.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span> <span class="nn">pymatgen.core.sites</span> <span class="kn">import</span> <span class="n">PeriodicSite</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">pymatgen.symmetry.analyzer</span> <span class="kn">import</span> <span class="n">SpacegroupAnalyzer</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">pymatgen.analysis.transition_state</span> <span class="kn">import</span> <span class="n">NEBAnalysis</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span> <span class="nn">simmate.toolkit</span> <span class="kn">import</span> <span class="n">Structure</span> <span class="k">as</span> <span class="n">ToolkitStructure</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span> <span class="nn">simmate.toolkit.diffusion</span> <span class="kn">import</span> <span class="n">MigrationHop</span> <span class="k">as</span> <span class="n">ToolkitMigrationHop</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span> <span class="nn">simmate.database.base_data_types</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>    <span class="n">table_column</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>    <span class="n">DatabaseTable</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>    <span class="n">Structure</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="p">)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="c1"># TODO: consider making a NestedCalculation</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="k">class</span> <span class="nc">DiffusionAnalysis</span><span class="p">(</span><span class="n">Structure</span><span class="p">):</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>        <span class="n">app_label</span> <span class="o">=</span> <span class="s2">&quot;workflows&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="n">migrating_specie</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    The element of the diffusion atom (e.g. &quot;Li&quot;)</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="n">vacancy_mode</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">    (if relevent) Whether vacancy or interstitial diffusion was used.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="n">atomic_fraction</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    Atomic fraction of the diffusion ion in the bulk structure.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="c1"># NOTE: barrier_cell, paths_involved, and npaths_involved need to be updated</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="c1"># by evaluating all MigrationHops.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>    <span class="n">barrier_cell</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    The energy barrier corresponding to the lowest-barrier percolation network</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    <span class="n">paths_involved</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">    The symmetrically-unqiue pathways involved in the lowest-barrier </span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    percolation network. This is given as a list of IDs.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>    <span class="c1"># TODO: consider making this a relationship to MigrationPathways</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="n">npaths_involved</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">    The number of symmetrically-unqiue pathways involved in the lowest-barrier </span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    percolation network</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="k">def</span> <span class="nf">from_toolkit</span><span class="p">(</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="n">migrating_specie</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="n">vacancy_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>        <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="p">):</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="c1"># the algorithm doesn&#39;t change for this method, but we do want to add</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>        <span class="c1"># a few extra columns. Therefore we make the dictionary as normal and</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="c1"># then add those extra columns here.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>        <span class="n">structure_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span><span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="c1"># now add the two extra columns</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="n">structure_dict</span><span class="p">[</span><span class="s2">&quot;migrating_specie&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">migrating_specie</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="c1"># Structure should be present -- otherwise an error would have been</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="c1"># raised by the call to super()</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="n">structure_dict</span><span class="p">[</span><span class="s2">&quot;atomic_fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">get_atomic_fraction</span><span class="p">(</span><span class="n">migrating_specie</span><span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>            <span class="k">if</span> <span class="n">migrating_specie</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>            <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="p">)</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="c1"># If as_dict is false, we build this into an Object. Otherwise, just</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="c1"># return the dictionary</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="k">return</span> <span class="n">structure_dict</span> <span class="k">if</span> <span class="n">as_dict</span> <span class="k">else</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">structure_dict</span><span class="p">)</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="k">def</span> <span class="nf">from_directory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        Creates a new database entry from a directory that holds diffusion analysis</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        results. For now, this assumes the directory holds vasp output files.</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="c1"># I assume the directory is from a vasp calculation, but I need to update</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>        <span class="c1"># this when I begin adding new calculators.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="c1"># TODO: It there a way I can figure out which tables the other calculations</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>        <span class="c1"># are linked to? Specifically, the bulk relaxation, bulk static energy,</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="c1"># and the supercell relaxations. They are all in these directories too</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="c1"># but I can&#39;t save those results until I know where they belong.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        <span class="c1"># Consider adding an attribute that points to those tables...? Or</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>        <span class="c1"># maybe a relationship (which I&#39;d rather avoid bc it makes things very</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="c1"># messy for users)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="c1"># For now, I only grab the structure from the static-energy and store</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="c1"># it in the DiffusionAnalysis table.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="n">bulk_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>            <span class="n">directory</span><span class="p">,</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>            <span class="s2">&quot;static-energy.vasp.matproj&quot;</span><span class="p">,</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>            <span class="s2">&quot;POSCAR&quot;</span><span class="p">,</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="p">)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="n">bulk_structure</span> <span class="o">=</span> <span class="n">ToolkitStructure</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">bulk_filename</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="c1"># Save a diffusion analysis object so we can connect all other data</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="c1"># to it.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="n">analysis_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>            <span class="n">structure</span><span class="o">=</span><span class="n">bulk_structure</span><span class="p">,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>            <span class="n">vacancy_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># assume this for now</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="p">)</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="n">analysis_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="c1"># Iterate through all the subdirectories that start with &quot;migration_hop*&quot;.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="c1"># We also need to make sure we only grab directories because there are</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="c1"># also cifs present that match this naming convention.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="c1"># We ignore the number when saving to avoid overwriting data.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="n">migration_directories</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>            <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;migration_hop_&quot;</span><span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="p">]</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="c1"># now save each migration hop present</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="k">for</span> <span class="n">migration_dir</span> <span class="ow">in</span> <span class="n">migration_directories</span><span class="p">:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>            <span class="bp">cls</span><span class="o">.</span><span class="n">migration_hops</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">from_directory</span><span class="p">(</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>                <span class="n">directory</span><span class="o">=</span><span class="n">migration_dir</span><span class="p">,</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>                <span class="n">diffusion_analysis_id</span><span class="o">=</span><span class="n">analysis_db</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>            <span class="p">)</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">analysis_db</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">create_subclasses</span><span class="p">(</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>        <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="p">):</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">        Dynamically creates a subclass of Relaxation as well as a separate IonicStep</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">        table for it. These tables are linked together.</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">        Example use:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">        ``` python</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">        from simmate.database.base_data_types import Relaxation</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        # note the odd formatting here is just because we are parsing three</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        # outputs from this method to three variables.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        (</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">            ExampleDiffusionAnalysis,</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">            ExampleMigrationHop,</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">            ExampleMigrationImage,</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        ) = DiffusionAnalysis.create_subclasses(</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">            &quot;Example&quot;,</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">            module=__name__,</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">        )</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        ```</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">        - `name` :</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">            The prefix name of the subclasses that are output. &quot;Relaxation&quot; and</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">            &quot;IonicStep&quot; will be attached to the end of this prefix.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">        - `module` :</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">            name of the module this subclass should be associated with. Typically,</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">            you should pass __name__ to this.</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">        - `**extra_columns` :</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">            Additional columns to add to the table. The keyword will be the</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">            column name and the value should match django options</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">            (e.g. table_column.FloatField())</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        #### Returns</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">        - `NewDiffusionAnalysisClass` :</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">            A subclass of DiffusionAnalysis.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="c1"># For convience, we add columns that point to the start and end structures</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="n">NewDiffusionAnalysisClass</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_subclass</span><span class="p">(</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">DiffusionAnalysis&quot;</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="p">(</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>            <span class="n">NewMigrationHopClass</span><span class="p">,</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>            <span class="n">NewMigrationImageClass</span><span class="p">,</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">MigrationHop</span><span class="o">.</span><span class="n">create_subclasses_from_diffusion_analysis</span><span class="p">(</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>            <span class="n">NewDiffusionAnalysisClass</span><span class="p">,</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="c1"># we now have a new child class and avoided writing some boilerplate code!</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="n">NewDiffusionAnalysisClass</span><span class="p">,</span> <span class="n">NewMigrationHopClass</span><span class="p">,</span> <span class="n">NewMigrationImageClass</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="c1"># TODO: consider making a Calculation bc this is what the corrections/directory</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="c1"># information should be attached to.</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="k">class</span> <span class="nc">MigrationHop</span><span class="p">(</span><span class="n">DatabaseTable</span><span class="p">):</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="n">app_label</span> <span class="o">=</span> <span class="s2">&quot;workflows&quot;</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>    <span class="n">base_info</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="s2">&quot;site_start&quot;</span><span class="p">,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="s2">&quot;site_end&quot;</span><span class="p">,</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="s2">&quot;index_start&quot;</span><span class="p">,</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="s2">&quot;index_end&quot;</span><span class="p">,</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>    <span class="p">]</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>    <span class="c1"># OPTIMIZE: site_start and site_end</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>    <span class="c1"># Really, this is a list of float values, but I save it as a string.</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>    <span class="c1"># For robustness, should I save cartesian coordinates and/or lattice as well?</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>    <span class="c1"># Does the max length make sense here and below?</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>    <span class="c1"># I could also store as JSON since it&#39;s a list of coords.</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>    <span class="n">site_start</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">    The starting fractional coordinates of the diffusing site.</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>    <span class="n">site_end</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">    The ending fractional coordinates of the diffusing site.</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>    <span class="c1"># BUG: the init script for MigrationHop can&#39;t identify the site indexes</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>    <span class="c1"># properly but they should be the same as before because it is a symmetrized</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>    <span class="c1"># structure. Note that even if I&#39;m wrong in some case -- this will have</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>    <span class="c1"># no effect because iindex and eindex are only used in one portion of</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>    <span class="c1"># the hash as well as for printing the __str__ of the object.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>    <span class="n">index_start</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">    The starting site index of the diffusing site.</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>    <span class="n">index_end</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">    The ending site index of the diffusing site.</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>    <span class="n">number</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">    The expected index in DistinctPathFinder.get_paths. The shortest path is index 0</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">    and they are all ordered by increasing length.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>    <span class="n">length</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">    The length/distance of the pathway from start to end. Note, this is </span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">    linear measurement -- i.e. is it the length of the linear interpolated path.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>    <span class="n">dimension_path</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">    The pathway dimensionality using the Larson scoring parameter.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>    <span class="n">dimension_host_lattice</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="sd">    Ignoring all atoms of the diffusing species, this is the dimensionality</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">    of the remaining atoms of the lattice using the Larson scoring parameter.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>    <span class="n">energy_barrier</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">    The energy barrier in eV. This evaluates all images of the diffusion pathway</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">    and find the difference between the maximum and minimum image energies.</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>    <span class="c1"># TODO:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>    <span class="c1"># Distance of the pathway relative to the shortest pathway distance</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>    <span class="c1"># in the structure using the formula: (D - Dmin)/Dmin</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>    <span class="c1"># distance_rel_min = models.FloatField()</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>    <span class="sd">&quot;&quot;&quot; Relationships &quot;&quot;&quot;</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>    <span class="c1"># Each MigrationHop corresponds to the full analysis of one Structure, which</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>    <span class="c1"># can have many MigrationHop(s)</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>    <span class="c1"># diffusion_analysis = table_column.ForeignKey(</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>    <span class="c1">#     # DiffusionAnalysis,</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>    <span class="c1">#     on_delete=table_column.PROTECT,</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>    <span class="c1">#     related_name=&quot;migration_hops&quot;,</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>    <span class="c1"># )</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>    <span class="c1"># TODO:</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>    <span class="c1"># image_start --&gt; OneToOneField for specific MigrationHop</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>    <span class="c1"># image_end --&gt; OneToOneField for specific MigrationHop</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>    <span class="c1"># image_transition_state --&gt; OneToOneField for specific MigrationHop</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>    <span class="c1"># Just like Relaxation points to IonicSteps, NEB will point to MigrationImages</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>    <span class="k">def</span> <span class="nf">_from_toolkit</span><span class="p">(</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="n">migration_hop</span><span class="p">:</span> <span class="n">ToolkitMigrationHop</span><span class="p">,</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>        <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>        <span class="n">number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>    <span class="p">):</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="c1"># convert the pathway object into the database table format</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="n">hop_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>            <span class="n">site_start</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">migration_hop</span><span class="o">.</span><span class="n">isite</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">),</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="n">site_end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">migration_hop</span><span class="o">.</span><span class="n">esite</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">),</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>            <span class="n">index_start</span><span class="o">=</span><span class="n">migration_hop</span><span class="o">.</span><span class="n">iindex</span><span class="p">,</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>            <span class="n">index_end</span><span class="o">=</span><span class="n">migration_hop</span><span class="o">.</span><span class="n">eindex</span><span class="p">,</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>            <span class="n">length</span><span class="o">=</span><span class="n">migration_hop</span><span class="o">.</span><span class="n">length</span><span class="p">,</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>            <span class="c1"># diffusion_analysis_id=diffusion_analysis_id,</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="c1"># If as_dict is false, we build this into an Object. Otherwise, just</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="c1"># return the dictionary</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="k">return</span> <span class="n">hop_dict</span> <span class="k">if</span> <span class="n">as_dict</span> <span class="k">else</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">hop_dict</span><span class="p">)</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>    <span class="c1"># BUG: because of rounding in the from_toolkit method, the get_sc_structures</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>    <span class="c1"># is unable to identify equivalent sites. I opened an issue for this</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>    <span class="c1"># with their team:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>    <span class="c1">#   https://github.com/materialsvirtuallab/pymatgen-analysis-diffusion/issues/296</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>    <span class="k">def</span> <span class="nf">to_toolkit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolkitMigrationHop</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="sd">        converts the database MigrationHop to a toolkit MigrationHop</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="c1"># The bulk crystal structure is stored in the diffusion analysis table</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">to_toolkit</span><span class="p">()</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>        <span class="c1"># pathways require a symmetrized structure</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>        <span class="c1"># BUG: I need to ensure the symmetrized structure comes out the same</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="c1"># as before, so I need to be careful with updates and hardcoding here.</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="n">sga</span> <span class="o">=</span> <span class="n">SpacegroupAnalyzer</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="n">symm_structure</span> <span class="o">=</span> <span class="n">sga</span><span class="o">.</span><span class="n">get_symmetrized_structure</span><span class="p">()</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="n">isite_new</span> <span class="o">=</span> <span class="n">PeriodicSite</span><span class="p">(</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="n">species</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">migrating_specie</span><span class="p">,</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">site_start</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)],</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="n">lattice</span><span class="o">=</span><span class="n">symm_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="n">esite_new</span> <span class="o">=</span> <span class="n">PeriodicSite</span><span class="p">(</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="n">species</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">migrating_specie</span><span class="p">,</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>            <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">site_end</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)],</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>            <span class="n">lattice</span><span class="o">=</span><span class="n">symm_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>        <span class="p">)</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">ToolkitMigrationHop</span><span class="p">(</span><span class="n">isite_new</span><span class="p">,</span> <span class="n">esite_new</span><span class="p">,</span> <span class="n">symm_structure</span><span class="p">)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="c1"># BUG: see comment attached to definition of these fields</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">iindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_start</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">eindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_end</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>        <span class="c1"># if the pathways match, then we can return the pathway object!</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>        <span class="k">return</span> <span class="n">path</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>    <span class="c1">#######</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>    <span class="c1"># BUG: I need to distinguish between the from_toolkit/to_toolkit methods</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>    <span class="c1"># above that just load a MigrationImages object vs. the from_directory and</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>    <span class="c1"># from_pymatgen methods below that include results. As-is these similar</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>    <span class="c1"># names but very different use cases makes things confusing for users.</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>    <span class="c1">#######</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>    <span class="k">def</span> <span class="nf">from_directory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>        <span class="c1"># I assume the directory is from a vasp calculation, but I need to update</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>        <span class="c1"># this when I begin adding new calculators.</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="c1"># BUG: A fix is make during the workup() method that may be relevant here.</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="c1"># simmate.calculators.vasp.tasks.nudged_elastic_band.MITNudgedElasticBand.workup</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="n">analysis</span> <span class="o">=</span> <span class="n">NEBAnalysis</span><span class="o">.</span><span class="n">from_dir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_pymatgen</span><span class="p">(</span><span class="n">analysis</span><span class="o">=</span><span class="n">analysis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>    <span class="k">def</span> <span class="nf">from_pymatgen</span><span class="p">(</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="n">analysis</span><span class="p">:</span> <span class="n">NEBAnalysis</span><span class="p">,</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>        <span class="n">diffusion_analysis_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># only used if updating</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>        <span class="n">migration_hop_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># only used if updating</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>    <span class="p">):</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="c1"># We reference these related tables frequently below so it easier to</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="c1"># grab them up front.</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>        <span class="n">diffusion_analysis_table</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">related_model</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="n">migration_image_table</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">migration_images</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">model</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>        <span class="c1"># First, we need a migration_hop database object.</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="c1"># All of hops should link to a diffusion_analysis entry, so we check</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>        <span class="c1"># for that here too. The key thing of these statements is that we</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="c1"># have a migration_hop_id at the end.</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>        <span class="c1"># If no ids were given, then we make a new entries for each.</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">diffusion_analysis_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">migration_hop_id</span><span class="p">:</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="c1"># Note, we have minimal information if this is the case, so these</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>            <span class="c1"># table entries will have a bunch of empty columns.</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>            <span class="c1"># We don&#39;t have a bulk structure to use for this class, so we use</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>            <span class="c1"># the first image</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>            <span class="n">analysis_db</span> <span class="o">=</span> <span class="n">diffusion_analysis_table</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>                <span class="n">structure</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">structures</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>                <span class="n">vacancy_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># assume this for now</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>            <span class="p">)</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>            <span class="n">analysis_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="c1"># This table entry will actually be completely empty... It only</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>            <span class="c1"># serves to link the MigrationImages together</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>            <span class="n">hop_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>                <span class="n">diffusion_analysis_id</span><span class="o">=</span><span class="n">analysis_db</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>            <span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="n">hop_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="n">migration_hop_id</span> <span class="o">=</span> <span class="n">hop_db</span><span class="o">.</span><span class="n">id</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="k">elif</span> <span class="n">diffusion_analysis_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">migration_hop_id</span><span class="p">:</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>            <span class="c1"># This table entry will actually be completely empty... It only</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="c1"># serves to link the MigrationImages together</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>            <span class="n">hop_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">diffusion_analysis_id</span><span class="o">=</span><span class="n">diffusion_analysis_id</span><span class="p">)</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>            <span class="n">hop_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>            <span class="n">migration_hop_id</span> <span class="o">=</span> <span class="n">hop_db</span><span class="o">.</span><span class="n">id</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="k">elif</span> <span class="n">migration_hop_id</span><span class="p">:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>            <span class="c1"># We don&#39;t use the hop_id, but making this query ensures it exists.</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>            <span class="n">hop_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">migration_hop_id</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="c1"># Even though it&#39;s not required, we make sure the id given for the</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>            <span class="c1"># diffusion analysis table matches this existing hop id.</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>            <span class="k">if</span> <span class="n">diffusion_analysis_id</span><span class="p">:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>                <span class="k">assert</span> <span class="n">hop_db</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">diffusion_analysis_id</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="c1"># Now same migration images and link them to this parent object.</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>        <span class="c1"># Note, the start/end Migration images will exist already in the</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>        <span class="c1"># relaxation database table. We still want to save them again here for</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>        <span class="c1"># easy access.</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>        <span class="k">for</span> <span class="n">image_number</span><span class="p">,</span> <span class="n">image_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>            <span class="nb">zip</span><span class="p">(</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">structures</span><span class="p">,</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">energies</span><span class="p">,</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">forces</span><span class="p">,</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>            <span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="p">):</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>            <span class="n">image</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">image_data</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>            <span class="n">image_db</span> <span class="o">=</span> <span class="n">migration_image_table</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>                <span class="n">structure</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>                <span class="n">number</span><span class="o">=</span><span class="n">image_number</span><span class="p">,</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>                <span class="n">force_tangent</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>                <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">,</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>                <span class="n">structure_distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>                <span class="n">migration_hop_id</span><span class="o">=</span><span class="n">migration_hop_id</span><span class="p">,</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>            <span class="n">image_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>        <span class="k">return</span> <span class="n">hop_db</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>    <span class="k">def</span> <span class="nf">create_subclasses_from_diffusion_analysis</span><span class="p">(</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>        <span class="n">diffusion_analysis</span><span class="p">:</span> <span class="n">DiffusionAnalysis</span><span class="p">,</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>        <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>        <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>    <span class="p">):</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">        Dynamically creates subclass of MigrationHop and MigrationImage, then</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="sd">        links them to the DiffusionAnalysis table.</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="sd">        This method should NOT be called directly because it is instead used by</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="sd">        `DiffusionAnalysis.create_subclasses`.</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        - `name` :</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="sd">            Name of the subclass that is output.</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a><span class="sd">        - `diffusion_analysis` :</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="sd">            DiffusionAnalysis table that these subclasses should be associated with.</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">        - `module` :</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="sd">            name of the module this subclass should be associated with. Typically,</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">            you should pass __name__ to this.</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">        - `**extra_columns` :</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">            Additional columns to add to the table. The keyword will be the</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">            column name and the value should match django options</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">            (e.g. table_column.FloatField())</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        #### Returns</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>        <span class="n">NewMigrationHopClass</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_subclass</span><span class="p">(</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">MigrationHop&quot;</span><span class="p">,</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>            <span class="n">diffusion_analysis</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>                <span class="n">diffusion_analysis</span><span class="p">,</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>                <span class="n">on_delete</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>                <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;migration_hops&quot;</span><span class="p">,</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>            <span class="p">),</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>        <span class="p">)</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>        <span class="n">NewMigrationImageClass</span> <span class="o">=</span> <span class="n">MigrationImage</span><span class="o">.</span><span class="n">create_subclass_from_migration_hop</span><span class="p">(</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>            <span class="n">NewMigrationHopClass</span><span class="p">,</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>        <span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="n">NewMigrationHopClass</span><span class="p">,</span> <span class="n">NewMigrationImageClass</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="k">class</span> <span class="nc">MigrationImage</span><span class="p">(</span><span class="n">Structure</span><span class="p">):</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>        <span class="n">app_label</span> <span class="o">=</span> <span class="s2">&quot;workflows&quot;</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>    <span class="n">base_info</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>        <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>        <span class="s2">&quot;structure_string&quot;</span><span class="p">,</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>        <span class="s2">&quot;force_tangent&quot;</span><span class="p">,</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>        <span class="s2">&quot;structure_distance&quot;</span><span class="p">,</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="s2">&quot;energy&quot;</span><span class="p">,</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>    <span class="p">]</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>    <span class="n">number</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">    The image number. Note, the starting image is always 0 and the ending</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">    image is always -1. The choice of -1 is because we often add the ending</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a><span class="sd">    image to the database table before knowing how many midpoint images we</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="sd">    are going to create.</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>    <span class="n">force_tangent</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">    The tangent force of image. Not to be confused with forces from the Forces mix-in.</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>    <span class="c1"># Note, we only care about the total energy for NEB images -- not the other</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>    <span class="c1"># fields that the Thermodynamics mix-in provides. This is why we set this</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>    <span class="c1"># field directly, rather than using the mix-in.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>    <span class="n">energy</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">    The calculated total energy. Units are in eV. </span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>    <span class="n">structure_distance</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">    The fingerprint distance of the image from the starting image. A smaller</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a><span class="sd">    means the structures are more similar, with 0 being an exact match.</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>    <span class="c1"># We don&#39;t need the source column for the MigrationImage class because we</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>    <span class="c1"># instead stored the source on the DiffusionAnalysis object. This line</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>    <span class="c1"># deletes the source column from our Structure mix-in.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>    <span class="n">source</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>    <span class="k">def</span> <span class="nf">create_subclass_from_migration_hop</span><span class="p">(</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>        <span class="n">migration_hop</span><span class="p">:</span> <span class="n">MigrationHop</span><span class="p">,</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>        <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>        <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>    <span class="p">):</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a><span class="sd">        Dynamically creates subclass of MigrationImage, then links it to the</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="sd">        MigrationHop table.</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a><span class="sd">        This method should NOT be called directly because it is instead used by</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a><span class="sd">        `DiffusionAnalysis.create_subclasses`.</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a><span class="sd">        #### Parameters</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a><span class="sd">        - `name` :</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">            Name of the subclass that is output.</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="sd">        - `migration_hop` :</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="sd">            MigrationHop table that these images should be associated with.</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a><span class="sd">        - `module` :</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a><span class="sd">            name of the module this subclass should be associated with. Typically,</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a><span class="sd">            you should pass __name__ to this.</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">        - `**extra_columns` :</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">            Additional columns to add to the table. The keyword will be the</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">            column name and the value should match django options</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">            (e.g. table_column.FloatField())</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="sd">        #### Returns</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a><span class="sd">        - `NewClass` :</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="sd">            A subclass of MigrationImage.</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>        <span class="n">NewClass</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_subclass</span><span class="p">(</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">MigrationImage&quot;</span><span class="p">,</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>            <span class="n">migration_hop</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>                <span class="n">migration_hop</span><span class="p">,</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>                <span class="n">on_delete</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>                <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;migration_images&quot;</span><span class="p">,</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>            <span class="p">),</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>        <span class="p">)</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>        <span class="k">return</span> <span class="n">NewClass</span>
</span></pre></div>


            </section>
                <section id="DiffusionAnalysis">
                            <input id="DiffusionAnalysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DiffusionAnalysis</span><wbr>(<span class="base"><a href="structure.html#Structure">simmate.database.base_data_types.structure.Structure</a></span>):

                <label class="view-source-button" for="DiffusionAnalysis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DiffusionAnalysis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DiffusionAnalysis-23"><a href="#DiffusionAnalysis-23"><span class="linenos"> 23</span></a><span class="k">class</span> <span class="nc">DiffusionAnalysis</span><span class="p">(</span><span class="n">Structure</span><span class="p">):</span>
</span><span id="DiffusionAnalysis-24"><a href="#DiffusionAnalysis-24"><span class="linenos"> 24</span></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span id="DiffusionAnalysis-25"><a href="#DiffusionAnalysis-25"><span class="linenos"> 25</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DiffusionAnalysis-26"><a href="#DiffusionAnalysis-26"><span class="linenos"> 26</span></a>        <span class="n">app_label</span> <span class="o">=</span> <span class="s2">&quot;workflows&quot;</span>
</span><span id="DiffusionAnalysis-27"><a href="#DiffusionAnalysis-27"><span class="linenos"> 27</span></a>
</span><span id="DiffusionAnalysis-28"><a href="#DiffusionAnalysis-28"><span class="linenos"> 28</span></a>    <span class="n">migrating_specie</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-29"><a href="#DiffusionAnalysis-29"><span class="linenos"> 29</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-30"><a href="#DiffusionAnalysis-30"><span class="linenos"> 30</span></a><span class="sd">    The element of the diffusion atom (e.g. &quot;Li&quot;)</span>
</span><span id="DiffusionAnalysis-31"><a href="#DiffusionAnalysis-31"><span class="linenos"> 31</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-32"><a href="#DiffusionAnalysis-32"><span class="linenos"> 32</span></a>
</span><span id="DiffusionAnalysis-33"><a href="#DiffusionAnalysis-33"><span class="linenos"> 33</span></a>    <span class="n">vacancy_mode</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-34"><a href="#DiffusionAnalysis-34"><span class="linenos"> 34</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-35"><a href="#DiffusionAnalysis-35"><span class="linenos"> 35</span></a><span class="sd">    (if relevent) Whether vacancy or interstitial diffusion was used.</span>
</span><span id="DiffusionAnalysis-36"><a href="#DiffusionAnalysis-36"><span class="linenos"> 36</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-37"><a href="#DiffusionAnalysis-37"><span class="linenos"> 37</span></a>
</span><span id="DiffusionAnalysis-38"><a href="#DiffusionAnalysis-38"><span class="linenos"> 38</span></a>    <span class="n">atomic_fraction</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-39"><a href="#DiffusionAnalysis-39"><span class="linenos"> 39</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-40"><a href="#DiffusionAnalysis-40"><span class="linenos"> 40</span></a><span class="sd">    Atomic fraction of the diffusion ion in the bulk structure.</span>
</span><span id="DiffusionAnalysis-41"><a href="#DiffusionAnalysis-41"><span class="linenos"> 41</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-42"><a href="#DiffusionAnalysis-42"><span class="linenos"> 42</span></a>
</span><span id="DiffusionAnalysis-43"><a href="#DiffusionAnalysis-43"><span class="linenos"> 43</span></a>    <span class="c1"># NOTE: barrier_cell, paths_involved, and npaths_involved need to be updated</span>
</span><span id="DiffusionAnalysis-44"><a href="#DiffusionAnalysis-44"><span class="linenos"> 44</span></a>    <span class="c1"># by evaluating all MigrationHops.</span>
</span><span id="DiffusionAnalysis-45"><a href="#DiffusionAnalysis-45"><span class="linenos"> 45</span></a>
</span><span id="DiffusionAnalysis-46"><a href="#DiffusionAnalysis-46"><span class="linenos"> 46</span></a>    <span class="n">barrier_cell</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-47"><a href="#DiffusionAnalysis-47"><span class="linenos"> 47</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-48"><a href="#DiffusionAnalysis-48"><span class="linenos"> 48</span></a><span class="sd">    The energy barrier corresponding to the lowest-barrier percolation network</span>
</span><span id="DiffusionAnalysis-49"><a href="#DiffusionAnalysis-49"><span class="linenos"> 49</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-50"><a href="#DiffusionAnalysis-50"><span class="linenos"> 50</span></a>
</span><span id="DiffusionAnalysis-51"><a href="#DiffusionAnalysis-51"><span class="linenos"> 51</span></a>    <span class="n">paths_involved</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-52"><a href="#DiffusionAnalysis-52"><span class="linenos"> 52</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-53"><a href="#DiffusionAnalysis-53"><span class="linenos"> 53</span></a><span class="sd">    The symmetrically-unqiue pathways involved in the lowest-barrier </span>
</span><span id="DiffusionAnalysis-54"><a href="#DiffusionAnalysis-54"><span class="linenos"> 54</span></a><span class="sd">    percolation network. This is given as a list of IDs.</span>
</span><span id="DiffusionAnalysis-55"><a href="#DiffusionAnalysis-55"><span class="linenos"> 55</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-56"><a href="#DiffusionAnalysis-56"><span class="linenos"> 56</span></a>    <span class="c1"># TODO: consider making this a relationship to MigrationPathways</span>
</span><span id="DiffusionAnalysis-57"><a href="#DiffusionAnalysis-57"><span class="linenos"> 57</span></a>
</span><span id="DiffusionAnalysis-58"><a href="#DiffusionAnalysis-58"><span class="linenos"> 58</span></a>    <span class="n">npaths_involved</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-59"><a href="#DiffusionAnalysis-59"><span class="linenos"> 59</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-60"><a href="#DiffusionAnalysis-60"><span class="linenos"> 60</span></a><span class="sd">    The number of symmetrically-unqiue pathways involved in the lowest-barrier </span>
</span><span id="DiffusionAnalysis-61"><a href="#DiffusionAnalysis-61"><span class="linenos"> 61</span></a><span class="sd">    percolation network</span>
</span><span id="DiffusionAnalysis-62"><a href="#DiffusionAnalysis-62"><span class="linenos"> 62</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-63"><a href="#DiffusionAnalysis-63"><span class="linenos"> 63</span></a>
</span><span id="DiffusionAnalysis-64"><a href="#DiffusionAnalysis-64"><span class="linenos"> 64</span></a>    <span class="nd">@classmethod</span>
</span><span id="DiffusionAnalysis-65"><a href="#DiffusionAnalysis-65"><span class="linenos"> 65</span></a>    <span class="k">def</span> <span class="nf">from_toolkit</span><span class="p">(</span>
</span><span id="DiffusionAnalysis-66"><a href="#DiffusionAnalysis-66"><span class="linenos"> 66</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-67"><a href="#DiffusionAnalysis-67"><span class="linenos"> 67</span></a>        <span class="n">migrating_specie</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-68"><a href="#DiffusionAnalysis-68"><span class="linenos"> 68</span></a>        <span class="n">vacancy_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-69"><a href="#DiffusionAnalysis-69"><span class="linenos"> 69</span></a>        <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-70"><a href="#DiffusionAnalysis-70"><span class="linenos"> 70</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-71"><a href="#DiffusionAnalysis-71"><span class="linenos"> 71</span></a>    <span class="p">):</span>
</span><span id="DiffusionAnalysis-72"><a href="#DiffusionAnalysis-72"><span class="linenos"> 72</span></a>        <span class="c1"># the algorithm doesn&#39;t change for this method, but we do want to add</span>
</span><span id="DiffusionAnalysis-73"><a href="#DiffusionAnalysis-73"><span class="linenos"> 73</span></a>        <span class="c1"># a few extra columns. Therefore we make the dictionary as normal and</span>
</span><span id="DiffusionAnalysis-74"><a href="#DiffusionAnalysis-74"><span class="linenos"> 74</span></a>        <span class="c1"># then add those extra columns here.</span>
</span><span id="DiffusionAnalysis-75"><a href="#DiffusionAnalysis-75"><span class="linenos"> 75</span></a>        <span class="n">structure_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span><span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-76"><a href="#DiffusionAnalysis-76"><span class="linenos"> 76</span></a>
</span><span id="DiffusionAnalysis-77"><a href="#DiffusionAnalysis-77"><span class="linenos"> 77</span></a>        <span class="c1"># now add the two extra columns</span>
</span><span id="DiffusionAnalysis-78"><a href="#DiffusionAnalysis-78"><span class="linenos"> 78</span></a>        <span class="n">structure_dict</span><span class="p">[</span><span class="s2">&quot;migrating_specie&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">migrating_specie</span>
</span><span id="DiffusionAnalysis-79"><a href="#DiffusionAnalysis-79"><span class="linenos"> 79</span></a>        <span class="c1"># Structure should be present -- otherwise an error would have been</span>
</span><span id="DiffusionAnalysis-80"><a href="#DiffusionAnalysis-80"><span class="linenos"> 80</span></a>        <span class="c1"># raised by the call to super()</span>
</span><span id="DiffusionAnalysis-81"><a href="#DiffusionAnalysis-81"><span class="linenos"> 81</span></a>        <span class="n">structure_dict</span><span class="p">[</span><span class="s2">&quot;atomic_fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DiffusionAnalysis-82"><a href="#DiffusionAnalysis-82"><span class="linenos"> 82</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">get_atomic_fraction</span><span class="p">(</span><span class="n">migrating_specie</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-83"><a href="#DiffusionAnalysis-83"><span class="linenos"> 83</span></a>            <span class="k">if</span> <span class="n">migrating_specie</span>
</span><span id="DiffusionAnalysis-84"><a href="#DiffusionAnalysis-84"><span class="linenos"> 84</span></a>            <span class="k">else</span> <span class="kc">None</span>
</span><span id="DiffusionAnalysis-85"><a href="#DiffusionAnalysis-85"><span class="linenos"> 85</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis-86"><a href="#DiffusionAnalysis-86"><span class="linenos"> 86</span></a>
</span><span id="DiffusionAnalysis-87"><a href="#DiffusionAnalysis-87"><span class="linenos"> 87</span></a>        <span class="c1"># If as_dict is false, we build this into an Object. Otherwise, just</span>
</span><span id="DiffusionAnalysis-88"><a href="#DiffusionAnalysis-88"><span class="linenos"> 88</span></a>        <span class="c1"># return the dictionary</span>
</span><span id="DiffusionAnalysis-89"><a href="#DiffusionAnalysis-89"><span class="linenos"> 89</span></a>        <span class="k">return</span> <span class="n">structure_dict</span> <span class="k">if</span> <span class="n">as_dict</span> <span class="k">else</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">structure_dict</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-90"><a href="#DiffusionAnalysis-90"><span class="linenos"> 90</span></a>
</span><span id="DiffusionAnalysis-91"><a href="#DiffusionAnalysis-91"><span class="linenos"> 91</span></a>    <span class="nd">@classmethod</span>
</span><span id="DiffusionAnalysis-92"><a href="#DiffusionAnalysis-92"><span class="linenos"> 92</span></a>    <span class="k">def</span> <span class="nf">from_directory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="DiffusionAnalysis-93"><a href="#DiffusionAnalysis-93"><span class="linenos"> 93</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-94"><a href="#DiffusionAnalysis-94"><span class="linenos"> 94</span></a><span class="sd">        Creates a new database entry from a directory that holds diffusion analysis</span>
</span><span id="DiffusionAnalysis-95"><a href="#DiffusionAnalysis-95"><span class="linenos"> 95</span></a><span class="sd">        results. For now, this assumes the directory holds vasp output files.</span>
</span><span id="DiffusionAnalysis-96"><a href="#DiffusionAnalysis-96"><span class="linenos"> 96</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-97"><a href="#DiffusionAnalysis-97"><span class="linenos"> 97</span></a>
</span><span id="DiffusionAnalysis-98"><a href="#DiffusionAnalysis-98"><span class="linenos"> 98</span></a>        <span class="c1"># I assume the directory is from a vasp calculation, but I need to update</span>
</span><span id="DiffusionAnalysis-99"><a href="#DiffusionAnalysis-99"><span class="linenos"> 99</span></a>        <span class="c1"># this when I begin adding new calculators.</span>
</span><span id="DiffusionAnalysis-100"><a href="#DiffusionAnalysis-100"><span class="linenos">100</span></a>
</span><span id="DiffusionAnalysis-101"><a href="#DiffusionAnalysis-101"><span class="linenos">101</span></a>        <span class="c1"># TODO: It there a way I can figure out which tables the other calculations</span>
</span><span id="DiffusionAnalysis-102"><a href="#DiffusionAnalysis-102"><span class="linenos">102</span></a>        <span class="c1"># are linked to? Specifically, the bulk relaxation, bulk static energy,</span>
</span><span id="DiffusionAnalysis-103"><a href="#DiffusionAnalysis-103"><span class="linenos">103</span></a>        <span class="c1"># and the supercell relaxations. They are all in these directories too</span>
</span><span id="DiffusionAnalysis-104"><a href="#DiffusionAnalysis-104"><span class="linenos">104</span></a>        <span class="c1"># but I can&#39;t save those results until I know where they belong.</span>
</span><span id="DiffusionAnalysis-105"><a href="#DiffusionAnalysis-105"><span class="linenos">105</span></a>        <span class="c1"># Consider adding an attribute that points to those tables...? Or</span>
</span><span id="DiffusionAnalysis-106"><a href="#DiffusionAnalysis-106"><span class="linenos">106</span></a>        <span class="c1"># maybe a relationship (which I&#39;d rather avoid bc it makes things very</span>
</span><span id="DiffusionAnalysis-107"><a href="#DiffusionAnalysis-107"><span class="linenos">107</span></a>        <span class="c1"># messy for users)</span>
</span><span id="DiffusionAnalysis-108"><a href="#DiffusionAnalysis-108"><span class="linenos">108</span></a>        <span class="c1"># For now, I only grab the structure from the static-energy and store</span>
</span><span id="DiffusionAnalysis-109"><a href="#DiffusionAnalysis-109"><span class="linenos">109</span></a>        <span class="c1"># it in the DiffusionAnalysis table.</span>
</span><span id="DiffusionAnalysis-110"><a href="#DiffusionAnalysis-110"><span class="linenos">110</span></a>        <span class="n">bulk_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="DiffusionAnalysis-111"><a href="#DiffusionAnalysis-111"><span class="linenos">111</span></a>            <span class="n">directory</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-112"><a href="#DiffusionAnalysis-112"><span class="linenos">112</span></a>            <span class="s2">&quot;static-energy.vasp.matproj&quot;</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-113"><a href="#DiffusionAnalysis-113"><span class="linenos">113</span></a>            <span class="s2">&quot;POSCAR&quot;</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-114"><a href="#DiffusionAnalysis-114"><span class="linenos">114</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis-115"><a href="#DiffusionAnalysis-115"><span class="linenos">115</span></a>        <span class="n">bulk_structure</span> <span class="o">=</span> <span class="n">ToolkitStructure</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">bulk_filename</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-116"><a href="#DiffusionAnalysis-116"><span class="linenos">116</span></a>
</span><span id="DiffusionAnalysis-117"><a href="#DiffusionAnalysis-117"><span class="linenos">117</span></a>        <span class="c1"># Save a diffusion analysis object so we can connect all other data</span>
</span><span id="DiffusionAnalysis-118"><a href="#DiffusionAnalysis-118"><span class="linenos">118</span></a>        <span class="c1"># to it.</span>
</span><span id="DiffusionAnalysis-119"><a href="#DiffusionAnalysis-119"><span class="linenos">119</span></a>        <span class="n">analysis_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span>
</span><span id="DiffusionAnalysis-120"><a href="#DiffusionAnalysis-120"><span class="linenos">120</span></a>            <span class="n">structure</span><span class="o">=</span><span class="n">bulk_structure</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-121"><a href="#DiffusionAnalysis-121"><span class="linenos">121</span></a>            <span class="n">vacancy_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># assume this for now</span>
</span><span id="DiffusionAnalysis-122"><a href="#DiffusionAnalysis-122"><span class="linenos">122</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis-123"><a href="#DiffusionAnalysis-123"><span class="linenos">123</span></a>        <span class="n">analysis_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="DiffusionAnalysis-124"><a href="#DiffusionAnalysis-124"><span class="linenos">124</span></a>
</span><span id="DiffusionAnalysis-125"><a href="#DiffusionAnalysis-125"><span class="linenos">125</span></a>        <span class="c1"># Iterate through all the subdirectories that start with &quot;migration_hop*&quot;.</span>
</span><span id="DiffusionAnalysis-126"><a href="#DiffusionAnalysis-126"><span class="linenos">126</span></a>        <span class="c1"># We also need to make sure we only grab directories because there are</span>
</span><span id="DiffusionAnalysis-127"><a href="#DiffusionAnalysis-127"><span class="linenos">127</span></a>        <span class="c1"># also cifs present that match this naming convention.</span>
</span><span id="DiffusionAnalysis-128"><a href="#DiffusionAnalysis-128"><span class="linenos">128</span></a>        <span class="c1"># We ignore the number when saving to avoid overwriting data.</span>
</span><span id="DiffusionAnalysis-129"><a href="#DiffusionAnalysis-129"><span class="linenos">129</span></a>        <span class="n">migration_directories</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DiffusionAnalysis-130"><a href="#DiffusionAnalysis-130"><span class="linenos">130</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-131"><a href="#DiffusionAnalysis-131"><span class="linenos">131</span></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-132"><a href="#DiffusionAnalysis-132"><span class="linenos">132</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
</span><span id="DiffusionAnalysis-133"><a href="#DiffusionAnalysis-133"><span class="linenos">133</span></a>            <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;migration_hop_&quot;</span><span class="p">)</span>
</span><span id="DiffusionAnalysis-134"><a href="#DiffusionAnalysis-134"><span class="linenos">134</span></a>        <span class="p">]</span>
</span><span id="DiffusionAnalysis-135"><a href="#DiffusionAnalysis-135"><span class="linenos">135</span></a>
</span><span id="DiffusionAnalysis-136"><a href="#DiffusionAnalysis-136"><span class="linenos">136</span></a>        <span class="c1"># now save each migration hop present</span>
</span><span id="DiffusionAnalysis-137"><a href="#DiffusionAnalysis-137"><span class="linenos">137</span></a>        <span class="k">for</span> <span class="n">migration_dir</span> <span class="ow">in</span> <span class="n">migration_directories</span><span class="p">:</span>
</span><span id="DiffusionAnalysis-138"><a href="#DiffusionAnalysis-138"><span class="linenos">138</span></a>            <span class="bp">cls</span><span class="o">.</span><span class="n">migration_hops</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">from_directory</span><span class="p">(</span>
</span><span id="DiffusionAnalysis-139"><a href="#DiffusionAnalysis-139"><span class="linenos">139</span></a>                <span class="n">directory</span><span class="o">=</span><span class="n">migration_dir</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-140"><a href="#DiffusionAnalysis-140"><span class="linenos">140</span></a>                <span class="n">diffusion_analysis_id</span><span class="o">=</span><span class="n">analysis_db</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-141"><a href="#DiffusionAnalysis-141"><span class="linenos">141</span></a>            <span class="p">)</span>
</span><span id="DiffusionAnalysis-142"><a href="#DiffusionAnalysis-142"><span class="linenos">142</span></a>
</span><span id="DiffusionAnalysis-143"><a href="#DiffusionAnalysis-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="n">analysis_db</span>
</span><span id="DiffusionAnalysis-144"><a href="#DiffusionAnalysis-144"><span class="linenos">144</span></a>
</span><span id="DiffusionAnalysis-145"><a href="#DiffusionAnalysis-145"><span class="linenos">145</span></a>    <span class="nd">@classmethod</span>
</span><span id="DiffusionAnalysis-146"><a href="#DiffusionAnalysis-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">create_subclasses</span><span class="p">(</span>
</span><span id="DiffusionAnalysis-147"><a href="#DiffusionAnalysis-147"><span class="linenos">147</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-148"><a href="#DiffusionAnalysis-148"><span class="linenos">148</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-149"><a href="#DiffusionAnalysis-149"><span class="linenos">149</span></a>        <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-150"><a href="#DiffusionAnalysis-150"><span class="linenos">150</span></a>        <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-151"><a href="#DiffusionAnalysis-151"><span class="linenos">151</span></a>    <span class="p">):</span>
</span><span id="DiffusionAnalysis-152"><a href="#DiffusionAnalysis-152"><span class="linenos">152</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-153"><a href="#DiffusionAnalysis-153"><span class="linenos">153</span></a><span class="sd">        Dynamically creates a subclass of Relaxation as well as a separate IonicStep</span>
</span><span id="DiffusionAnalysis-154"><a href="#DiffusionAnalysis-154"><span class="linenos">154</span></a><span class="sd">        table for it. These tables are linked together.</span>
</span><span id="DiffusionAnalysis-155"><a href="#DiffusionAnalysis-155"><span class="linenos">155</span></a>
</span><span id="DiffusionAnalysis-156"><a href="#DiffusionAnalysis-156"><span class="linenos">156</span></a><span class="sd">        Example use:</span>
</span><span id="DiffusionAnalysis-157"><a href="#DiffusionAnalysis-157"><span class="linenos">157</span></a>
</span><span id="DiffusionAnalysis-158"><a href="#DiffusionAnalysis-158"><span class="linenos">158</span></a><span class="sd">        ``` python</span>
</span><span id="DiffusionAnalysis-159"><a href="#DiffusionAnalysis-159"><span class="linenos">159</span></a><span class="sd">        from simmate.database.base_data_types import Relaxation</span>
</span><span id="DiffusionAnalysis-160"><a href="#DiffusionAnalysis-160"><span class="linenos">160</span></a>
</span><span id="DiffusionAnalysis-161"><a href="#DiffusionAnalysis-161"><span class="linenos">161</span></a><span class="sd">        # note the odd formatting here is just because we are parsing three</span>
</span><span id="DiffusionAnalysis-162"><a href="#DiffusionAnalysis-162"><span class="linenos">162</span></a><span class="sd">        # outputs from this method to three variables.</span>
</span><span id="DiffusionAnalysis-163"><a href="#DiffusionAnalysis-163"><span class="linenos">163</span></a><span class="sd">        (</span>
</span><span id="DiffusionAnalysis-164"><a href="#DiffusionAnalysis-164"><span class="linenos">164</span></a><span class="sd">            ExampleDiffusionAnalysis,</span>
</span><span id="DiffusionAnalysis-165"><a href="#DiffusionAnalysis-165"><span class="linenos">165</span></a><span class="sd">            ExampleMigrationHop,</span>
</span><span id="DiffusionAnalysis-166"><a href="#DiffusionAnalysis-166"><span class="linenos">166</span></a><span class="sd">            ExampleMigrationImage,</span>
</span><span id="DiffusionAnalysis-167"><a href="#DiffusionAnalysis-167"><span class="linenos">167</span></a><span class="sd">        ) = DiffusionAnalysis.create_subclasses(</span>
</span><span id="DiffusionAnalysis-168"><a href="#DiffusionAnalysis-168"><span class="linenos">168</span></a><span class="sd">            &quot;Example&quot;,</span>
</span><span id="DiffusionAnalysis-169"><a href="#DiffusionAnalysis-169"><span class="linenos">169</span></a><span class="sd">            module=__name__,</span>
</span><span id="DiffusionAnalysis-170"><a href="#DiffusionAnalysis-170"><span class="linenos">170</span></a><span class="sd">        )</span>
</span><span id="DiffusionAnalysis-171"><a href="#DiffusionAnalysis-171"><span class="linenos">171</span></a><span class="sd">        ```</span>
</span><span id="DiffusionAnalysis-172"><a href="#DiffusionAnalysis-172"><span class="linenos">172</span></a>
</span><span id="DiffusionAnalysis-173"><a href="#DiffusionAnalysis-173"><span class="linenos">173</span></a><span class="sd">        #### Parameters</span>
</span><span id="DiffusionAnalysis-174"><a href="#DiffusionAnalysis-174"><span class="linenos">174</span></a>
</span><span id="DiffusionAnalysis-175"><a href="#DiffusionAnalysis-175"><span class="linenos">175</span></a><span class="sd">        - `name` :</span>
</span><span id="DiffusionAnalysis-176"><a href="#DiffusionAnalysis-176"><span class="linenos">176</span></a><span class="sd">            The prefix name of the subclasses that are output. &quot;Relaxation&quot; and</span>
</span><span id="DiffusionAnalysis-177"><a href="#DiffusionAnalysis-177"><span class="linenos">177</span></a><span class="sd">            &quot;IonicStep&quot; will be attached to the end of this prefix.</span>
</span><span id="DiffusionAnalysis-178"><a href="#DiffusionAnalysis-178"><span class="linenos">178</span></a>
</span><span id="DiffusionAnalysis-179"><a href="#DiffusionAnalysis-179"><span class="linenos">179</span></a><span class="sd">        - `module` :</span>
</span><span id="DiffusionAnalysis-180"><a href="#DiffusionAnalysis-180"><span class="linenos">180</span></a><span class="sd">            name of the module this subclass should be associated with. Typically,</span>
</span><span id="DiffusionAnalysis-181"><a href="#DiffusionAnalysis-181"><span class="linenos">181</span></a><span class="sd">            you should pass __name__ to this.</span>
</span><span id="DiffusionAnalysis-182"><a href="#DiffusionAnalysis-182"><span class="linenos">182</span></a>
</span><span id="DiffusionAnalysis-183"><a href="#DiffusionAnalysis-183"><span class="linenos">183</span></a><span class="sd">        - `**extra_columns` :</span>
</span><span id="DiffusionAnalysis-184"><a href="#DiffusionAnalysis-184"><span class="linenos">184</span></a><span class="sd">            Additional columns to add to the table. The keyword will be the</span>
</span><span id="DiffusionAnalysis-185"><a href="#DiffusionAnalysis-185"><span class="linenos">185</span></a><span class="sd">            column name and the value should match django options</span>
</span><span id="DiffusionAnalysis-186"><a href="#DiffusionAnalysis-186"><span class="linenos">186</span></a><span class="sd">            (e.g. table_column.FloatField())</span>
</span><span id="DiffusionAnalysis-187"><a href="#DiffusionAnalysis-187"><span class="linenos">187</span></a>
</span><span id="DiffusionAnalysis-188"><a href="#DiffusionAnalysis-188"><span class="linenos">188</span></a><span class="sd">        #### Returns</span>
</span><span id="DiffusionAnalysis-189"><a href="#DiffusionAnalysis-189"><span class="linenos">189</span></a>
</span><span id="DiffusionAnalysis-190"><a href="#DiffusionAnalysis-190"><span class="linenos">190</span></a><span class="sd">        - `NewDiffusionAnalysisClass` :</span>
</span><span id="DiffusionAnalysis-191"><a href="#DiffusionAnalysis-191"><span class="linenos">191</span></a><span class="sd">            A subclass of DiffusionAnalysis.</span>
</span><span id="DiffusionAnalysis-192"><a href="#DiffusionAnalysis-192"><span class="linenos">192</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="DiffusionAnalysis-193"><a href="#DiffusionAnalysis-193"><span class="linenos">193</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="DiffusionAnalysis-194"><a href="#DiffusionAnalysis-194"><span class="linenos">194</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="DiffusionAnalysis-195"><a href="#DiffusionAnalysis-195"><span class="linenos">195</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="DiffusionAnalysis-196"><a href="#DiffusionAnalysis-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis-197"><a href="#DiffusionAnalysis-197"><span class="linenos">197</span></a>
</span><span id="DiffusionAnalysis-198"><a href="#DiffusionAnalysis-198"><span class="linenos">198</span></a>        <span class="c1"># For convience, we add columns that point to the start and end structures</span>
</span><span id="DiffusionAnalysis-199"><a href="#DiffusionAnalysis-199"><span class="linenos">199</span></a>        <span class="n">NewDiffusionAnalysisClass</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_subclass</span><span class="p">(</span>
</span><span id="DiffusionAnalysis-200"><a href="#DiffusionAnalysis-200"><span class="linenos">200</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">DiffusionAnalysis&quot;</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-201"><a href="#DiffusionAnalysis-201"><span class="linenos">201</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-202"><a href="#DiffusionAnalysis-202"><span class="linenos">202</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-203"><a href="#DiffusionAnalysis-203"><span class="linenos">203</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis-204"><a href="#DiffusionAnalysis-204"><span class="linenos">204</span></a>
</span><span id="DiffusionAnalysis-205"><a href="#DiffusionAnalysis-205"><span class="linenos">205</span></a>        <span class="p">(</span>
</span><span id="DiffusionAnalysis-206"><a href="#DiffusionAnalysis-206"><span class="linenos">206</span></a>            <span class="n">NewMigrationHopClass</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-207"><a href="#DiffusionAnalysis-207"><span class="linenos">207</span></a>            <span class="n">NewMigrationImageClass</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-208"><a href="#DiffusionAnalysis-208"><span class="linenos">208</span></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">MigrationHop</span><span class="o">.</span><span class="n">create_subclasses_from_diffusion_analysis</span><span class="p">(</span>
</span><span id="DiffusionAnalysis-209"><a href="#DiffusionAnalysis-209"><span class="linenos">209</span></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-210"><a href="#DiffusionAnalysis-210"><span class="linenos">210</span></a>            <span class="n">NewDiffusionAnalysisClass</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-211"><a href="#DiffusionAnalysis-211"><span class="linenos">211</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-212"><a href="#DiffusionAnalysis-212"><span class="linenos">212</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="DiffusionAnalysis-213"><a href="#DiffusionAnalysis-213"><span class="linenos">213</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis-214"><a href="#DiffusionAnalysis-214"><span class="linenos">214</span></a>
</span><span id="DiffusionAnalysis-215"><a href="#DiffusionAnalysis-215"><span class="linenos">215</span></a>        <span class="c1"># we now have a new child class and avoided writing some boilerplate code!</span>
</span><span id="DiffusionAnalysis-216"><a href="#DiffusionAnalysis-216"><span class="linenos">216</span></a>        <span class="k">return</span> <span class="n">NewDiffusionAnalysisClass</span><span class="p">,</span> <span class="n">NewMigrationHopClass</span><span class="p">,</span> <span class="n">NewMigrationImageClass</span>
</span></pre></div>


            <div class="docstring"><p>The base class for defining a table in the Simmate database. All tables and
mixins inherit from this class.</p>

<p>Usage is identical to
<a href="https://docs.djangoproject.com/en/4.0/#the-model-layer">models in Django</a>
where this class only adds extra methods for convenience.</p>
</div>


                            <div id="DiffusionAnalysis.migrating_specie" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">migrating_specie</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.migrating_specie"></a>
    
            <div class="docstring"><p>The element of the diffusion atom (e.g. "Li")</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.vacancy_mode" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">vacancy_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.vacancy_mode"></a>
    
            <div class="docstring"><p>(if relevent) Whether vacancy or interstitial diffusion was used.</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.atomic_fraction" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">atomic_fraction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.atomic_fraction"></a>
    
            <div class="docstring"><p>Atomic fraction of the diffusion ion in the bulk structure.</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.barrier_cell" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">barrier_cell</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.barrier_cell"></a>
    
            <div class="docstring"><p>The energy barrier corresponding to the lowest-barrier percolation network</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.paths_involved" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">paths_involved</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.paths_involved"></a>
    
            <div class="docstring"><p>The symmetrically-unqiue pathways involved in the lowest-barrier 
percolation network. This is given as a list of IDs.</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.npaths_involved" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">npaths_involved</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.npaths_involved"></a>
    
            <div class="docstring"><p>The number of symmetrically-unqiue pathways involved in the lowest-barrier 
percolation network</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.from_toolkit" class="classattr">
                                        <input id="DiffusionAnalysis.from_toolkit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_toolkit</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">migrating_specie</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">vacancy_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="DiffusionAnalysis.from_toolkit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DiffusionAnalysis.from_toolkit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DiffusionAnalysis.from_toolkit-64"><a href="#DiffusionAnalysis.from_toolkit-64"><span class="linenos">64</span></a>    <span class="nd">@classmethod</span>
</span><span id="DiffusionAnalysis.from_toolkit-65"><a href="#DiffusionAnalysis.from_toolkit-65"><span class="linenos">65</span></a>    <span class="k">def</span> <span class="nf">from_toolkit</span><span class="p">(</span>
</span><span id="DiffusionAnalysis.from_toolkit-66"><a href="#DiffusionAnalysis.from_toolkit-66"><span class="linenos">66</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_toolkit-67"><a href="#DiffusionAnalysis.from_toolkit-67"><span class="linenos">67</span></a>        <span class="n">migrating_specie</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_toolkit-68"><a href="#DiffusionAnalysis.from_toolkit-68"><span class="linenos">68</span></a>        <span class="n">vacancy_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_toolkit-69"><a href="#DiffusionAnalysis.from_toolkit-69"><span class="linenos">69</span></a>        <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_toolkit-70"><a href="#DiffusionAnalysis.from_toolkit-70"><span class="linenos">70</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_toolkit-71"><a href="#DiffusionAnalysis.from_toolkit-71"><span class="linenos">71</span></a>    <span class="p">):</span>
</span><span id="DiffusionAnalysis.from_toolkit-72"><a href="#DiffusionAnalysis.from_toolkit-72"><span class="linenos">72</span></a>        <span class="c1"># the algorithm doesn&#39;t change for this method, but we do want to add</span>
</span><span id="DiffusionAnalysis.from_toolkit-73"><a href="#DiffusionAnalysis.from_toolkit-73"><span class="linenos">73</span></a>        <span class="c1"># a few extra columns. Therefore we make the dictionary as normal and</span>
</span><span id="DiffusionAnalysis.from_toolkit-74"><a href="#DiffusionAnalysis.from_toolkit-74"><span class="linenos">74</span></a>        <span class="c1"># then add those extra columns here.</span>
</span><span id="DiffusionAnalysis.from_toolkit-75"><a href="#DiffusionAnalysis.from_toolkit-75"><span class="linenos">75</span></a>        <span class="n">structure_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span><span class="n">as_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="DiffusionAnalysis.from_toolkit-76"><a href="#DiffusionAnalysis.from_toolkit-76"><span class="linenos">76</span></a>
</span><span id="DiffusionAnalysis.from_toolkit-77"><a href="#DiffusionAnalysis.from_toolkit-77"><span class="linenos">77</span></a>        <span class="c1"># now add the two extra columns</span>
</span><span id="DiffusionAnalysis.from_toolkit-78"><a href="#DiffusionAnalysis.from_toolkit-78"><span class="linenos">78</span></a>        <span class="n">structure_dict</span><span class="p">[</span><span class="s2">&quot;migrating_specie&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">migrating_specie</span>
</span><span id="DiffusionAnalysis.from_toolkit-79"><a href="#DiffusionAnalysis.from_toolkit-79"><span class="linenos">79</span></a>        <span class="c1"># Structure should be present -- otherwise an error would have been</span>
</span><span id="DiffusionAnalysis.from_toolkit-80"><a href="#DiffusionAnalysis.from_toolkit-80"><span class="linenos">80</span></a>        <span class="c1"># raised by the call to super()</span>
</span><span id="DiffusionAnalysis.from_toolkit-81"><a href="#DiffusionAnalysis.from_toolkit-81"><span class="linenos">81</span></a>        <span class="n">structure_dict</span><span class="p">[</span><span class="s2">&quot;atomic_fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DiffusionAnalysis.from_toolkit-82"><a href="#DiffusionAnalysis.from_toolkit-82"><span class="linenos">82</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">get_atomic_fraction</span><span class="p">(</span><span class="n">migrating_specie</span><span class="p">)</span>
</span><span id="DiffusionAnalysis.from_toolkit-83"><a href="#DiffusionAnalysis.from_toolkit-83"><span class="linenos">83</span></a>            <span class="k">if</span> <span class="n">migrating_specie</span>
</span><span id="DiffusionAnalysis.from_toolkit-84"><a href="#DiffusionAnalysis.from_toolkit-84"><span class="linenos">84</span></a>            <span class="k">else</span> <span class="kc">None</span>
</span><span id="DiffusionAnalysis.from_toolkit-85"><a href="#DiffusionAnalysis.from_toolkit-85"><span class="linenos">85</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis.from_toolkit-86"><a href="#DiffusionAnalysis.from_toolkit-86"><span class="linenos">86</span></a>
</span><span id="DiffusionAnalysis.from_toolkit-87"><a href="#DiffusionAnalysis.from_toolkit-87"><span class="linenos">87</span></a>        <span class="c1"># If as_dict is false, we build this into an Object. Otherwise, just</span>
</span><span id="DiffusionAnalysis.from_toolkit-88"><a href="#DiffusionAnalysis.from_toolkit-88"><span class="linenos">88</span></a>        <span class="c1"># return the dictionary</span>
</span><span id="DiffusionAnalysis.from_toolkit-89"><a href="#DiffusionAnalysis.from_toolkit-89"><span class="linenos">89</span></a>        <span class="k">return</span> <span class="n">structure_dict</span> <span class="k">if</span> <span class="n">as_dict</span> <span class="k">else</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">structure_dict</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Given fundamental "base_info" and toolkit objects, this method will populate
all relevant columns.</p>

<p>If the table is made up of multiple mix-ins, this method iterates through
each of the <code>_from_toolkit</code> methods of those mixins and combines the results.
Therefore, you must view this method for each mix-ins to determine which
kwargs must be passed.</p>

<h4 id="parameters">Parameters</h4>

<ul>
<li><code>as_dict</code> :
Whether to return the populated data as a dictionary or to initialize
it as a database object. Defaults to False.</li>
<li><code>**kwargs</code> :
All fields required in order to initialize the database entry. For
example, a Structure table would require a toolkit structure, while
a Thermodynamics table would require an energy.</li>
</ul>

<h2 id="returns">Returns</h2>

<p>a dictionary if as_dict is True; and a database object if as_dict is False</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.from_directory" class="classattr">
                                        <input id="DiffusionAnalysis.from_directory-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_directory</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="DiffusionAnalysis.from_directory-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DiffusionAnalysis.from_directory"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DiffusionAnalysis.from_directory-91"><a href="#DiffusionAnalysis.from_directory-91"><span class="linenos"> 91</span></a>    <span class="nd">@classmethod</span>
</span><span id="DiffusionAnalysis.from_directory-92"><a href="#DiffusionAnalysis.from_directory-92"><span class="linenos"> 92</span></a>    <span class="k">def</span> <span class="nf">from_directory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="DiffusionAnalysis.from_directory-93"><a href="#DiffusionAnalysis.from_directory-93"><span class="linenos"> 93</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis.from_directory-94"><a href="#DiffusionAnalysis.from_directory-94"><span class="linenos"> 94</span></a><span class="sd">        Creates a new database entry from a directory that holds diffusion analysis</span>
</span><span id="DiffusionAnalysis.from_directory-95"><a href="#DiffusionAnalysis.from_directory-95"><span class="linenos"> 95</span></a><span class="sd">        results. For now, this assumes the directory holds vasp output files.</span>
</span><span id="DiffusionAnalysis.from_directory-96"><a href="#DiffusionAnalysis.from_directory-96"><span class="linenos"> 96</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis.from_directory-97"><a href="#DiffusionAnalysis.from_directory-97"><span class="linenos"> 97</span></a>
</span><span id="DiffusionAnalysis.from_directory-98"><a href="#DiffusionAnalysis.from_directory-98"><span class="linenos"> 98</span></a>        <span class="c1"># I assume the directory is from a vasp calculation, but I need to update</span>
</span><span id="DiffusionAnalysis.from_directory-99"><a href="#DiffusionAnalysis.from_directory-99"><span class="linenos"> 99</span></a>        <span class="c1"># this when I begin adding new calculators.</span>
</span><span id="DiffusionAnalysis.from_directory-100"><a href="#DiffusionAnalysis.from_directory-100"><span class="linenos">100</span></a>
</span><span id="DiffusionAnalysis.from_directory-101"><a href="#DiffusionAnalysis.from_directory-101"><span class="linenos">101</span></a>        <span class="c1"># TODO: It there a way I can figure out which tables the other calculations</span>
</span><span id="DiffusionAnalysis.from_directory-102"><a href="#DiffusionAnalysis.from_directory-102"><span class="linenos">102</span></a>        <span class="c1"># are linked to? Specifically, the bulk relaxation, bulk static energy,</span>
</span><span id="DiffusionAnalysis.from_directory-103"><a href="#DiffusionAnalysis.from_directory-103"><span class="linenos">103</span></a>        <span class="c1"># and the supercell relaxations. They are all in these directories too</span>
</span><span id="DiffusionAnalysis.from_directory-104"><a href="#DiffusionAnalysis.from_directory-104"><span class="linenos">104</span></a>        <span class="c1"># but I can&#39;t save those results until I know where they belong.</span>
</span><span id="DiffusionAnalysis.from_directory-105"><a href="#DiffusionAnalysis.from_directory-105"><span class="linenos">105</span></a>        <span class="c1"># Consider adding an attribute that points to those tables...? Or</span>
</span><span id="DiffusionAnalysis.from_directory-106"><a href="#DiffusionAnalysis.from_directory-106"><span class="linenos">106</span></a>        <span class="c1"># maybe a relationship (which I&#39;d rather avoid bc it makes things very</span>
</span><span id="DiffusionAnalysis.from_directory-107"><a href="#DiffusionAnalysis.from_directory-107"><span class="linenos">107</span></a>        <span class="c1"># messy for users)</span>
</span><span id="DiffusionAnalysis.from_directory-108"><a href="#DiffusionAnalysis.from_directory-108"><span class="linenos">108</span></a>        <span class="c1"># For now, I only grab the structure from the static-energy and store</span>
</span><span id="DiffusionAnalysis.from_directory-109"><a href="#DiffusionAnalysis.from_directory-109"><span class="linenos">109</span></a>        <span class="c1"># it in the DiffusionAnalysis table.</span>
</span><span id="DiffusionAnalysis.from_directory-110"><a href="#DiffusionAnalysis.from_directory-110"><span class="linenos">110</span></a>        <span class="n">bulk_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="DiffusionAnalysis.from_directory-111"><a href="#DiffusionAnalysis.from_directory-111"><span class="linenos">111</span></a>            <span class="n">directory</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_directory-112"><a href="#DiffusionAnalysis.from_directory-112"><span class="linenos">112</span></a>            <span class="s2">&quot;static-energy.vasp.matproj&quot;</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_directory-113"><a href="#DiffusionAnalysis.from_directory-113"><span class="linenos">113</span></a>            <span class="s2">&quot;POSCAR&quot;</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_directory-114"><a href="#DiffusionAnalysis.from_directory-114"><span class="linenos">114</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis.from_directory-115"><a href="#DiffusionAnalysis.from_directory-115"><span class="linenos">115</span></a>        <span class="n">bulk_structure</span> <span class="o">=</span> <span class="n">ToolkitStructure</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">bulk_filename</span><span class="p">)</span>
</span><span id="DiffusionAnalysis.from_directory-116"><a href="#DiffusionAnalysis.from_directory-116"><span class="linenos">116</span></a>
</span><span id="DiffusionAnalysis.from_directory-117"><a href="#DiffusionAnalysis.from_directory-117"><span class="linenos">117</span></a>        <span class="c1"># Save a diffusion analysis object so we can connect all other data</span>
</span><span id="DiffusionAnalysis.from_directory-118"><a href="#DiffusionAnalysis.from_directory-118"><span class="linenos">118</span></a>        <span class="c1"># to it.</span>
</span><span id="DiffusionAnalysis.from_directory-119"><a href="#DiffusionAnalysis.from_directory-119"><span class="linenos">119</span></a>        <span class="n">analysis_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span>
</span><span id="DiffusionAnalysis.from_directory-120"><a href="#DiffusionAnalysis.from_directory-120"><span class="linenos">120</span></a>            <span class="n">structure</span><span class="o">=</span><span class="n">bulk_structure</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_directory-121"><a href="#DiffusionAnalysis.from_directory-121"><span class="linenos">121</span></a>            <span class="n">vacancy_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># assume this for now</span>
</span><span id="DiffusionAnalysis.from_directory-122"><a href="#DiffusionAnalysis.from_directory-122"><span class="linenos">122</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis.from_directory-123"><a href="#DiffusionAnalysis.from_directory-123"><span class="linenos">123</span></a>        <span class="n">analysis_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="DiffusionAnalysis.from_directory-124"><a href="#DiffusionAnalysis.from_directory-124"><span class="linenos">124</span></a>
</span><span id="DiffusionAnalysis.from_directory-125"><a href="#DiffusionAnalysis.from_directory-125"><span class="linenos">125</span></a>        <span class="c1"># Iterate through all the subdirectories that start with &quot;migration_hop*&quot;.</span>
</span><span id="DiffusionAnalysis.from_directory-126"><a href="#DiffusionAnalysis.from_directory-126"><span class="linenos">126</span></a>        <span class="c1"># We also need to make sure we only grab directories because there are</span>
</span><span id="DiffusionAnalysis.from_directory-127"><a href="#DiffusionAnalysis.from_directory-127"><span class="linenos">127</span></a>        <span class="c1"># also cifs present that match this naming convention.</span>
</span><span id="DiffusionAnalysis.from_directory-128"><a href="#DiffusionAnalysis.from_directory-128"><span class="linenos">128</span></a>        <span class="c1"># We ignore the number when saving to avoid overwriting data.</span>
</span><span id="DiffusionAnalysis.from_directory-129"><a href="#DiffusionAnalysis.from_directory-129"><span class="linenos">129</span></a>        <span class="n">migration_directories</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DiffusionAnalysis.from_directory-130"><a href="#DiffusionAnalysis.from_directory-130"><span class="linenos">130</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="DiffusionAnalysis.from_directory-131"><a href="#DiffusionAnalysis.from_directory-131"><span class="linenos">131</span></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span><span id="DiffusionAnalysis.from_directory-132"><a href="#DiffusionAnalysis.from_directory-132"><span class="linenos">132</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
</span><span id="DiffusionAnalysis.from_directory-133"><a href="#DiffusionAnalysis.from_directory-133"><span class="linenos">133</span></a>            <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;migration_hop_&quot;</span><span class="p">)</span>
</span><span id="DiffusionAnalysis.from_directory-134"><a href="#DiffusionAnalysis.from_directory-134"><span class="linenos">134</span></a>        <span class="p">]</span>
</span><span id="DiffusionAnalysis.from_directory-135"><a href="#DiffusionAnalysis.from_directory-135"><span class="linenos">135</span></a>
</span><span id="DiffusionAnalysis.from_directory-136"><a href="#DiffusionAnalysis.from_directory-136"><span class="linenos">136</span></a>        <span class="c1"># now save each migration hop present</span>
</span><span id="DiffusionAnalysis.from_directory-137"><a href="#DiffusionAnalysis.from_directory-137"><span class="linenos">137</span></a>        <span class="k">for</span> <span class="n">migration_dir</span> <span class="ow">in</span> <span class="n">migration_directories</span><span class="p">:</span>
</span><span id="DiffusionAnalysis.from_directory-138"><a href="#DiffusionAnalysis.from_directory-138"><span class="linenos">138</span></a>            <span class="bp">cls</span><span class="o">.</span><span class="n">migration_hops</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">from_directory</span><span class="p">(</span>
</span><span id="DiffusionAnalysis.from_directory-139"><a href="#DiffusionAnalysis.from_directory-139"><span class="linenos">139</span></a>                <span class="n">directory</span><span class="o">=</span><span class="n">migration_dir</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_directory-140"><a href="#DiffusionAnalysis.from_directory-140"><span class="linenos">140</span></a>                <span class="n">diffusion_analysis_id</span><span class="o">=</span><span class="n">analysis_db</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.from_directory-141"><a href="#DiffusionAnalysis.from_directory-141"><span class="linenos">141</span></a>            <span class="p">)</span>
</span><span id="DiffusionAnalysis.from_directory-142"><a href="#DiffusionAnalysis.from_directory-142"><span class="linenos">142</span></a>
</span><span id="DiffusionAnalysis.from_directory-143"><a href="#DiffusionAnalysis.from_directory-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="n">analysis_db</span>
</span></pre></div>


            <div class="docstring"><p>Creates a new database entry from a directory that holds diffusion analysis
results. For now, this assumes the directory holds vasp output files.</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.create_subclasses" class="classattr">
                                        <input id="DiffusionAnalysis.create_subclasses-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">create_subclasses</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">module</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">extra_columns</span></span>)</span>

                <label class="view-source-button" for="DiffusionAnalysis.create_subclasses-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DiffusionAnalysis.create_subclasses"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DiffusionAnalysis.create_subclasses-145"><a href="#DiffusionAnalysis.create_subclasses-145"><span class="linenos">145</span></a>    <span class="nd">@classmethod</span>
</span><span id="DiffusionAnalysis.create_subclasses-146"><a href="#DiffusionAnalysis.create_subclasses-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">create_subclasses</span><span class="p">(</span>
</span><span id="DiffusionAnalysis.create_subclasses-147"><a href="#DiffusionAnalysis.create_subclasses-147"><span class="linenos">147</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-148"><a href="#DiffusionAnalysis.create_subclasses-148"><span class="linenos">148</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-149"><a href="#DiffusionAnalysis.create_subclasses-149"><span class="linenos">149</span></a>        <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-150"><a href="#DiffusionAnalysis.create_subclasses-150"><span class="linenos">150</span></a>        <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-151"><a href="#DiffusionAnalysis.create_subclasses-151"><span class="linenos">151</span></a>    <span class="p">):</span>
</span><span id="DiffusionAnalysis.create_subclasses-152"><a href="#DiffusionAnalysis.create_subclasses-152"><span class="linenos">152</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis.create_subclasses-153"><a href="#DiffusionAnalysis.create_subclasses-153"><span class="linenos">153</span></a><span class="sd">        Dynamically creates a subclass of Relaxation as well as a separate IonicStep</span>
</span><span id="DiffusionAnalysis.create_subclasses-154"><a href="#DiffusionAnalysis.create_subclasses-154"><span class="linenos">154</span></a><span class="sd">        table for it. These tables are linked together.</span>
</span><span id="DiffusionAnalysis.create_subclasses-155"><a href="#DiffusionAnalysis.create_subclasses-155"><span class="linenos">155</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-156"><a href="#DiffusionAnalysis.create_subclasses-156"><span class="linenos">156</span></a><span class="sd">        Example use:</span>
</span><span id="DiffusionAnalysis.create_subclasses-157"><a href="#DiffusionAnalysis.create_subclasses-157"><span class="linenos">157</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-158"><a href="#DiffusionAnalysis.create_subclasses-158"><span class="linenos">158</span></a><span class="sd">        ``` python</span>
</span><span id="DiffusionAnalysis.create_subclasses-159"><a href="#DiffusionAnalysis.create_subclasses-159"><span class="linenos">159</span></a><span class="sd">        from simmate.database.base_data_types import Relaxation</span>
</span><span id="DiffusionAnalysis.create_subclasses-160"><a href="#DiffusionAnalysis.create_subclasses-160"><span class="linenos">160</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-161"><a href="#DiffusionAnalysis.create_subclasses-161"><span class="linenos">161</span></a><span class="sd">        # note the odd formatting here is just because we are parsing three</span>
</span><span id="DiffusionAnalysis.create_subclasses-162"><a href="#DiffusionAnalysis.create_subclasses-162"><span class="linenos">162</span></a><span class="sd">        # outputs from this method to three variables.</span>
</span><span id="DiffusionAnalysis.create_subclasses-163"><a href="#DiffusionAnalysis.create_subclasses-163"><span class="linenos">163</span></a><span class="sd">        (</span>
</span><span id="DiffusionAnalysis.create_subclasses-164"><a href="#DiffusionAnalysis.create_subclasses-164"><span class="linenos">164</span></a><span class="sd">            ExampleDiffusionAnalysis,</span>
</span><span id="DiffusionAnalysis.create_subclasses-165"><a href="#DiffusionAnalysis.create_subclasses-165"><span class="linenos">165</span></a><span class="sd">            ExampleMigrationHop,</span>
</span><span id="DiffusionAnalysis.create_subclasses-166"><a href="#DiffusionAnalysis.create_subclasses-166"><span class="linenos">166</span></a><span class="sd">            ExampleMigrationImage,</span>
</span><span id="DiffusionAnalysis.create_subclasses-167"><a href="#DiffusionAnalysis.create_subclasses-167"><span class="linenos">167</span></a><span class="sd">        ) = DiffusionAnalysis.create_subclasses(</span>
</span><span id="DiffusionAnalysis.create_subclasses-168"><a href="#DiffusionAnalysis.create_subclasses-168"><span class="linenos">168</span></a><span class="sd">            &quot;Example&quot;,</span>
</span><span id="DiffusionAnalysis.create_subclasses-169"><a href="#DiffusionAnalysis.create_subclasses-169"><span class="linenos">169</span></a><span class="sd">            module=__name__,</span>
</span><span id="DiffusionAnalysis.create_subclasses-170"><a href="#DiffusionAnalysis.create_subclasses-170"><span class="linenos">170</span></a><span class="sd">        )</span>
</span><span id="DiffusionAnalysis.create_subclasses-171"><a href="#DiffusionAnalysis.create_subclasses-171"><span class="linenos">171</span></a><span class="sd">        ```</span>
</span><span id="DiffusionAnalysis.create_subclasses-172"><a href="#DiffusionAnalysis.create_subclasses-172"><span class="linenos">172</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-173"><a href="#DiffusionAnalysis.create_subclasses-173"><span class="linenos">173</span></a><span class="sd">        #### Parameters</span>
</span><span id="DiffusionAnalysis.create_subclasses-174"><a href="#DiffusionAnalysis.create_subclasses-174"><span class="linenos">174</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-175"><a href="#DiffusionAnalysis.create_subclasses-175"><span class="linenos">175</span></a><span class="sd">        - `name` :</span>
</span><span id="DiffusionAnalysis.create_subclasses-176"><a href="#DiffusionAnalysis.create_subclasses-176"><span class="linenos">176</span></a><span class="sd">            The prefix name of the subclasses that are output. &quot;Relaxation&quot; and</span>
</span><span id="DiffusionAnalysis.create_subclasses-177"><a href="#DiffusionAnalysis.create_subclasses-177"><span class="linenos">177</span></a><span class="sd">            &quot;IonicStep&quot; will be attached to the end of this prefix.</span>
</span><span id="DiffusionAnalysis.create_subclasses-178"><a href="#DiffusionAnalysis.create_subclasses-178"><span class="linenos">178</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-179"><a href="#DiffusionAnalysis.create_subclasses-179"><span class="linenos">179</span></a><span class="sd">        - `module` :</span>
</span><span id="DiffusionAnalysis.create_subclasses-180"><a href="#DiffusionAnalysis.create_subclasses-180"><span class="linenos">180</span></a><span class="sd">            name of the module this subclass should be associated with. Typically,</span>
</span><span id="DiffusionAnalysis.create_subclasses-181"><a href="#DiffusionAnalysis.create_subclasses-181"><span class="linenos">181</span></a><span class="sd">            you should pass __name__ to this.</span>
</span><span id="DiffusionAnalysis.create_subclasses-182"><a href="#DiffusionAnalysis.create_subclasses-182"><span class="linenos">182</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-183"><a href="#DiffusionAnalysis.create_subclasses-183"><span class="linenos">183</span></a><span class="sd">        - `**extra_columns` :</span>
</span><span id="DiffusionAnalysis.create_subclasses-184"><a href="#DiffusionAnalysis.create_subclasses-184"><span class="linenos">184</span></a><span class="sd">            Additional columns to add to the table. The keyword will be the</span>
</span><span id="DiffusionAnalysis.create_subclasses-185"><a href="#DiffusionAnalysis.create_subclasses-185"><span class="linenos">185</span></a><span class="sd">            column name and the value should match django options</span>
</span><span id="DiffusionAnalysis.create_subclasses-186"><a href="#DiffusionAnalysis.create_subclasses-186"><span class="linenos">186</span></a><span class="sd">            (e.g. table_column.FloatField())</span>
</span><span id="DiffusionAnalysis.create_subclasses-187"><a href="#DiffusionAnalysis.create_subclasses-187"><span class="linenos">187</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-188"><a href="#DiffusionAnalysis.create_subclasses-188"><span class="linenos">188</span></a><span class="sd">        #### Returns</span>
</span><span id="DiffusionAnalysis.create_subclasses-189"><a href="#DiffusionAnalysis.create_subclasses-189"><span class="linenos">189</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-190"><a href="#DiffusionAnalysis.create_subclasses-190"><span class="linenos">190</span></a><span class="sd">        - `NewDiffusionAnalysisClass` :</span>
</span><span id="DiffusionAnalysis.create_subclasses-191"><a href="#DiffusionAnalysis.create_subclasses-191"><span class="linenos">191</span></a><span class="sd">            A subclass of DiffusionAnalysis.</span>
</span><span id="DiffusionAnalysis.create_subclasses-192"><a href="#DiffusionAnalysis.create_subclasses-192"><span class="linenos">192</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="DiffusionAnalysis.create_subclasses-193"><a href="#DiffusionAnalysis.create_subclasses-193"><span class="linenos">193</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="DiffusionAnalysis.create_subclasses-194"><a href="#DiffusionAnalysis.create_subclasses-194"><span class="linenos">194</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="DiffusionAnalysis.create_subclasses-195"><a href="#DiffusionAnalysis.create_subclasses-195"><span class="linenos">195</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="DiffusionAnalysis.create_subclasses-196"><a href="#DiffusionAnalysis.create_subclasses-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DiffusionAnalysis.create_subclasses-197"><a href="#DiffusionAnalysis.create_subclasses-197"><span class="linenos">197</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-198"><a href="#DiffusionAnalysis.create_subclasses-198"><span class="linenos">198</span></a>        <span class="c1"># For convience, we add columns that point to the start and end structures</span>
</span><span id="DiffusionAnalysis.create_subclasses-199"><a href="#DiffusionAnalysis.create_subclasses-199"><span class="linenos">199</span></a>        <span class="n">NewDiffusionAnalysisClass</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_subclass</span><span class="p">(</span>
</span><span id="DiffusionAnalysis.create_subclasses-200"><a href="#DiffusionAnalysis.create_subclasses-200"><span class="linenos">200</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">DiffusionAnalysis&quot;</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-201"><a href="#DiffusionAnalysis.create_subclasses-201"><span class="linenos">201</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-202"><a href="#DiffusionAnalysis.create_subclasses-202"><span class="linenos">202</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-203"><a href="#DiffusionAnalysis.create_subclasses-203"><span class="linenos">203</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis.create_subclasses-204"><a href="#DiffusionAnalysis.create_subclasses-204"><span class="linenos">204</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-205"><a href="#DiffusionAnalysis.create_subclasses-205"><span class="linenos">205</span></a>        <span class="p">(</span>
</span><span id="DiffusionAnalysis.create_subclasses-206"><a href="#DiffusionAnalysis.create_subclasses-206"><span class="linenos">206</span></a>            <span class="n">NewMigrationHopClass</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-207"><a href="#DiffusionAnalysis.create_subclasses-207"><span class="linenos">207</span></a>            <span class="n">NewMigrationImageClass</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-208"><a href="#DiffusionAnalysis.create_subclasses-208"><span class="linenos">208</span></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">MigrationHop</span><span class="o">.</span><span class="n">create_subclasses_from_diffusion_analysis</span><span class="p">(</span>
</span><span id="DiffusionAnalysis.create_subclasses-209"><a href="#DiffusionAnalysis.create_subclasses-209"><span class="linenos">209</span></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-210"><a href="#DiffusionAnalysis.create_subclasses-210"><span class="linenos">210</span></a>            <span class="n">NewDiffusionAnalysisClass</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-211"><a href="#DiffusionAnalysis.create_subclasses-211"><span class="linenos">211</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-212"><a href="#DiffusionAnalysis.create_subclasses-212"><span class="linenos">212</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="DiffusionAnalysis.create_subclasses-213"><a href="#DiffusionAnalysis.create_subclasses-213"><span class="linenos">213</span></a>        <span class="p">)</span>
</span><span id="DiffusionAnalysis.create_subclasses-214"><a href="#DiffusionAnalysis.create_subclasses-214"><span class="linenos">214</span></a>
</span><span id="DiffusionAnalysis.create_subclasses-215"><a href="#DiffusionAnalysis.create_subclasses-215"><span class="linenos">215</span></a>        <span class="c1"># we now have a new child class and avoided writing some boilerplate code!</span>
</span><span id="DiffusionAnalysis.create_subclasses-216"><a href="#DiffusionAnalysis.create_subclasses-216"><span class="linenos">216</span></a>        <span class="k">return</span> <span class="n">NewDiffusionAnalysisClass</span><span class="p">,</span> <span class="n">NewMigrationHopClass</span><span class="p">,</span> <span class="n">NewMigrationImageClass</span>
</span></pre></div>


            <div class="docstring"><p>Dynamically creates a subclass of Relaxation as well as a separate IonicStep
table for it. These tables are linked together.</p>

<p>Example use:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn"><a href="../base_data_types.html">simmate.database.base_data_types</a></span> <span class="kn">import</span> <span class="n">Relaxation</span>

<span class="c1"># note the odd formatting here is just because we are parsing three</span>
<span class="c1"># outputs from this method to three variables.</span>
<span class="p">(</span>
    <span class="n">ExampleDiffusionAnalysis</span><span class="p">,</span>
    <span class="n">ExampleMigrationHop</span><span class="p">,</span>
    <span class="n">ExampleMigrationImage</span><span class="p">,</span>
<span class="p">)</span> <span class="o">=</span> <span class="n"><a href="#DiffusionAnalysis.create_subclasses">DiffusionAnalysis.create_subclasses</a></span><span class="p">(</span>
    <span class="s2">&quot;Example&quot;</span><span class="p">,</span>
    <span class="n">module</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="parameters">Parameters</h4>

<ul>
<li><p><code>name</code> :
The prefix name of the subclasses that are output. "Relaxation" and
"IonicStep" will be attached to the end of this prefix.</p></li>
<li><p><code>module</code> :
name of the module this subclass should be associated with. Typically,
you should pass __name__ to this.</p></li>
<li><p><code>**extra_columns</code> :
Additional columns to add to the table. The keyword will be the
column name and the value should match django options
(e.g. table_column.FloatField())</p></li>
</ul>

<h4 id="returns">Returns</h4>

<ul>
<li><code>NewDiffusionAnalysisClass</code> :
A subclass of DiffusionAnalysis.</li>
<li><code>NewMigrationHopClass</code>:
A subclass of MigrationHop.</li>
<li><code>NewMigrationHopClass</code>:
A subclass of MigrationHop.</li>
</ul>
</div>


                            </div>
                            <div id="DiffusionAnalysis.structure_string" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">structure_string</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.structure_string"></a>
    
            <div class="docstring"><p>The core structure information, which is written to a string and in a 
compressed format using the <code><a href="#DiffusionAnalysis.from_toolkit">from_toolkit</a></code> method. To get back to our toolkit
structure object, use the <code><a href="#DiffusionAnalysis.to_toolkit">to_toolkit</a></code> method.</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.nsites" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nsites</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.nsites"></a>
    
            <div class="docstring"><p>The total number of sites in the unitcell. (e.g. Y2CF2 has 5 sites)</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.nelements" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nelements</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.nelements"></a>
    
            <div class="docstring"><p>The total number of unique elements. (e.g. Y2CF2 has 3 elements)</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.elements" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">elements</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.elements"></a>
    
            <div class="docstring"><p>List of elements in the structure (ex: ["Y", "C", "F"])</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.chemical_system" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">chemical_system</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.chemical_system"></a>
    
            <div class="docstring"><p>the base chemical system (ex: "Y-C-F")</p>

<p>Note: be careful when searching for elements! Running chemical_system__contains="C"
on this field won't do what you expect -- because it will return structures
containing Ca, Cs, Ce, Cl, and so on. If you want to search for structures
that contain a specific element, use elements__contains='"C"' instead. The
odd use of quotes '"C"' is required here!</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.density" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">density</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.density"></a>
    
            <div class="docstring"><p>The density of the crystal in g/cm^3</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.density_atomic" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">density_atomic</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.density_atomic"></a>
    
            <div class="docstring"><p>The density of atoms in the crystal in atoms/Angstom^3</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.volume" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">volume</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.volume"></a>
    
            <div class="docstring"><p>The volume of the unitcell in Angstom^3</p>

<p>Note: in most cases, <code><a href="#DiffusionAnalysis.volume_molar">volume_molar</a></code> should be used instead! This is because
volumne is highly dependent on the symmetry and the arbitray unitcell. If 
you are truly after small volumes of the unitcell, it is likely you really 
just want to search by spacegroup.</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.volume_molar" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">volume_molar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.volume_molar"></a>
    
            <div class="docstring"><p>The molar volume of the crystal in cm^3/mol</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.formula_full" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">formula_full</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.formula_full"></a>
    
            <div class="docstring"><p>The chemical formula with elements sorted by electronegativity (ex: Li4 Fe4 P4 O16)</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.formula_reduced" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">formula_reduced</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.formula_reduced"></a>
    
            <div class="docstring"><p>The reduced chemical formula. (ex: Li4Fe4P4O16 --> LiFePO4)</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.formula_anonymous" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">formula_anonymous</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.formula_anonymous"></a>
    
            <div class="docstring"><p>An anonymized formula. Unique species are arranged in ordering of 
amounts and assigned ascending alphabets. Useful for prototyping formulas. 
For example, all stoichiometric perovskites have anonymized_formula ABC3.</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.spacegroup" class="classattr">
                                <div class="attr variable">
            <span class="name">spacegroup</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.spacegroup"></a>
    
            <div class="docstring"><p>Spacegroup information. Points to a separate database table that has additional
columns:
<code><a href="symmetry.html#Spacegroup">simmate.database.base_data_types.symmetry.Spacegroup</a></code></p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.created_at" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">created_at</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.created_at"></a>
    
            <div class="docstring"><p>Timestamp of when this row was first added to the database table</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.updated_at" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">updated_at</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.updated_at"></a>
    
            <div class="docstring"><p>Timestamp of when this row was was lasted changed / updated</p>
</div>


                            </div>
                            <div id="DiffusionAnalysis.source" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">source</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.source"></a>
    
            <div class="docstring"><blockquote>
  <p>Note, this field is highly experimental at the moment and subject to
  change.</p>
</blockquote>

<p>This column indicates where the data came from, and it could be a number 
of things including...</p>

<ul>
<li>a third party id</li>
<li>a structure from a different Simmate datbase table</li>
<li>a transformation of another structure</li>
<li>a creation method</li>
<li>a custom submission by the user</li>
</ul>

<p>By default, this is a JSON field to account for all scenarios, but some
tables (such as those in <code><a href="../third_parties.html">simmate.database.third_parties</a></code>) this is value
should be the same for ALL entries in the table and therefore the column is
overwritten as an attribute.</p>

<p>For other tables where this is not a constant, here are some examples of
values used in this column:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="c1"># from a thirdparty database or separate table</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;MatprojStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;mp-123&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># from a random structure creator</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;PyXtalStructure&quot;</span><span class="p">}</span>

<span class="c1"># from a templated structure creator (e.g. substituition or prototypes)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;PrototypeStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;AFLOWPrototypes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># from a transformation</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;MirrorMutation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;MatprojStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;mp-123&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># from a multi-structure transformation</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;HereditaryMutation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;MatprojStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mp-123&quot;</span><span class="p">,</span> <span class="s2">&quot;mp-321&quot;</span><span class="p">],</span>
<span class="p">}</span>
</code></pre></div>
</div>


                            </div>
                            <div id="DiffusionAnalysis.spacegroup_id" class="classattr">
                                <div class="attr variable">
            <span class="name">spacegroup_id</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.spacegroup_id"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>django.db.models.base.Model</dt>
                                <dd id="DiffusionAnalysis.__init__" class="function">Model</dd>
                <dd id="DiffusionAnalysis.from_db" class="function">from_db</dd>
                <dd id="DiffusionAnalysis.pk" class="variable">pk</dd>
                <dd id="DiffusionAnalysis.get_deferred_fields" class="function">get_deferred_fields</dd>
                <dd id="DiffusionAnalysis.refresh_from_db" class="function">refresh_from_db</dd>
                <dd id="DiffusionAnalysis.serializable_value" class="function">serializable_value</dd>
                <dd id="DiffusionAnalysis.save" class="function">save</dd>
                <dd id="DiffusionAnalysis.save_base" class="function">save_base</dd>
                <dd id="DiffusionAnalysis.delete" class="function">delete</dd>
                <dd id="DiffusionAnalysis.prepare_database_save" class="function">prepare_database_save</dd>
                <dd id="DiffusionAnalysis.clean" class="function">clean</dd>
                <dd id="DiffusionAnalysis.validate_unique" class="function">validate_unique</dd>
                <dd id="DiffusionAnalysis.date_error_message" class="function">date_error_message</dd>
                <dd id="DiffusionAnalysis.unique_error_message" class="function">unique_error_message</dd>
                <dd id="DiffusionAnalysis.full_clean" class="function">full_clean</dd>
                <dd id="DiffusionAnalysis.clean_fields" class="function">clean_fields</dd>
                <dd id="DiffusionAnalysis.check" class="function">check</dd>

            </div>
            <div><dt><a href="structure.html#Structure">simmate.database.base_data_types.structure.Structure</a></dt>
                                <dd id="DiffusionAnalysis.base_info" class="variable"><a href="structure.html#Structure.base_info">base_info</a></dd>
                <dd id="DiffusionAnalysis.to_toolkit" class="function"><a href="structure.html#Structure.to_toolkit">to_toolkit</a></dd>

            </div>
            <div><dt><a href="base.html#DatabaseTable">simmate.database.base_data_types.base.DatabaseTable</a></dt>
                                <dd id="DiffusionAnalysis.source_doi" class="variable"><a href="base.html#DatabaseTable.source_doi">source_doi</a></dd>
                <dd id="DiffusionAnalysis.remote_archive_link" class="variable"><a href="base.html#DatabaseTable.remote_archive_link">remote_archive_link</a></dd>
                <dd id="DiffusionAnalysis.objects" class="function"><a href="base.html#DatabaseTable.objects">objects</a></dd>
                <dd id="DiffusionAnalysis.get_table_name" class="function"><a href="base.html#DatabaseTable.get_table_name">get_table_name</a></dd>
                <dd id="DiffusionAnalysis.create_subclass" class="function"><a href="base.html#DatabaseTable.create_subclass">create_subclass</a></dd>
                <dd id="DiffusionAnalysis.update_from_toolkit" class="function"><a href="base.html#DatabaseTable.update_from_toolkit">update_from_toolkit</a></dd>
                <dd id="DiffusionAnalysis.load_archive" class="function"><a href="base.html#DatabaseTable.load_archive">load_archive</a></dd>
                <dd id="DiffusionAnalysis.load_remote_archive" class="function"><a href="base.html#DatabaseTable.load_remote_archive">load_remote_archive</a></dd>
                <dd id="DiffusionAnalysis.get_column_names" class="function"><a href="base.html#DatabaseTable.get_column_names">get_column_names</a></dd>
                <dd id="DiffusionAnalysis.show_columns" class="function"><a href="base.html#DatabaseTable.show_columns">show_columns</a></dd>
                <dd id="DiffusionAnalysis.get_mixins" class="function"><a href="base.html#DatabaseTable.get_mixins">get_mixins</a></dd>
                <dd id="DiffusionAnalysis.get_mixin_names" class="function"><a href="base.html#DatabaseTable.get_mixin_names">get_mixin_names</a></dd>
                <dd id="DiffusionAnalysis.get_extra_columns" class="function"><a href="base.html#DatabaseTable.get_extra_columns">get_extra_columns</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="DiffusionAnalysis.Meta">
                            <input id="DiffusionAnalysis.Meta-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DiffusionAnalysis.Meta</span>:

                <label class="view-source-button" for="DiffusionAnalysis.Meta-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DiffusionAnalysis.Meta"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DiffusionAnalysis.Meta-24"><a href="#DiffusionAnalysis.Meta-24"><span class="linenos">24</span></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span id="DiffusionAnalysis.Meta-25"><a href="#DiffusionAnalysis.Meta-25"><span class="linenos">25</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DiffusionAnalysis.Meta-26"><a href="#DiffusionAnalysis.Meta-26"><span class="linenos">26</span></a>        <span class="n">app_label</span> <span class="o">=</span> <span class="s2">&quot;workflows&quot;</span>
</span></pre></div>


    

                            <div id="DiffusionAnalysis.Meta.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">DiffusionAnalysis.Meta</span><span class="signature pdoc-code condensed">()</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.Meta.__init__"></a>
    
    

                            </div>
                            <div id="DiffusionAnalysis.Meta.abstract" class="classattr">
                                <div class="attr variable">
            <span class="name">abstract</span><span class="default_value"> = False</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.Meta.abstract"></a>
    
    

                            </div>
                            <div id="DiffusionAnalysis.Meta.app_label" class="classattr">
                                <div class="attr variable">
            <span class="name">app_label</span><span class="default_value"> = &#39;workflows&#39;</span>

        
    </div>
    <a class="headerlink" href="#DiffusionAnalysis.Meta.app_label"></a>
    
    

                            </div>
                </section>
                <section id="MigrationHop">
                            <input id="MigrationHop-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MigrationHop</span><wbr>(<span class="base"><a href="base.html#DatabaseTable">simmate.database.base_data_types.base.DatabaseTable</a></span>):

                <label class="view-source-button" for="MigrationHop-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MigrationHop"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MigrationHop-221"><a href="#MigrationHop-221"><span class="linenos">221</span></a><span class="k">class</span> <span class="nc">MigrationHop</span><span class="p">(</span><span class="n">DatabaseTable</span><span class="p">):</span>
</span><span id="MigrationHop-222"><a href="#MigrationHop-222"><span class="linenos">222</span></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span id="MigrationHop-223"><a href="#MigrationHop-223"><span class="linenos">223</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MigrationHop-224"><a href="#MigrationHop-224"><span class="linenos">224</span></a>        <span class="n">app_label</span> <span class="o">=</span> <span class="s2">&quot;workflows&quot;</span>
</span><span id="MigrationHop-225"><a href="#MigrationHop-225"><span class="linenos">225</span></a>
</span><span id="MigrationHop-226"><a href="#MigrationHop-226"><span class="linenos">226</span></a>    <span class="n">base_info</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MigrationHop-227"><a href="#MigrationHop-227"><span class="linenos">227</span></a>        <span class="s2">&quot;site_start&quot;</span><span class="p">,</span>
</span><span id="MigrationHop-228"><a href="#MigrationHop-228"><span class="linenos">228</span></a>        <span class="s2">&quot;site_end&quot;</span><span class="p">,</span>
</span><span id="MigrationHop-229"><a href="#MigrationHop-229"><span class="linenos">229</span></a>        <span class="s2">&quot;index_start&quot;</span><span class="p">,</span>
</span><span id="MigrationHop-230"><a href="#MigrationHop-230"><span class="linenos">230</span></a>        <span class="s2">&quot;index_end&quot;</span><span class="p">,</span>
</span><span id="MigrationHop-231"><a href="#MigrationHop-231"><span class="linenos">231</span></a>        <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="MigrationHop-232"><a href="#MigrationHop-232"><span class="linenos">232</span></a>    <span class="p">]</span>
</span><span id="MigrationHop-233"><a href="#MigrationHop-233"><span class="linenos">233</span></a>
</span><span id="MigrationHop-234"><a href="#MigrationHop-234"><span class="linenos">234</span></a>    <span class="c1"># OPTIMIZE: site_start and site_end</span>
</span><span id="MigrationHop-235"><a href="#MigrationHop-235"><span class="linenos">235</span></a>    <span class="c1"># Really, this is a list of float values, but I save it as a string.</span>
</span><span id="MigrationHop-236"><a href="#MigrationHop-236"><span class="linenos">236</span></a>    <span class="c1"># For robustness, should I save cartesian coordinates and/or lattice as well?</span>
</span><span id="MigrationHop-237"><a href="#MigrationHop-237"><span class="linenos">237</span></a>    <span class="c1"># Does the max length make sense here and below?</span>
</span><span id="MigrationHop-238"><a href="#MigrationHop-238"><span class="linenos">238</span></a>    <span class="c1"># I could also store as JSON since it&#39;s a list of coords.</span>
</span><span id="MigrationHop-239"><a href="#MigrationHop-239"><span class="linenos">239</span></a>
</span><span id="MigrationHop-240"><a href="#MigrationHop-240"><span class="linenos">240</span></a>    <span class="n">site_start</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationHop-241"><a href="#MigrationHop-241"><span class="linenos">241</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-242"><a href="#MigrationHop-242"><span class="linenos">242</span></a><span class="sd">    The starting fractional coordinates of the diffusing site.</span>
</span><span id="MigrationHop-243"><a href="#MigrationHop-243"><span class="linenos">243</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationHop-244"><a href="#MigrationHop-244"><span class="linenos">244</span></a>
</span><span id="MigrationHop-245"><a href="#MigrationHop-245"><span class="linenos">245</span></a>    <span class="n">site_end</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationHop-246"><a href="#MigrationHop-246"><span class="linenos">246</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-247"><a href="#MigrationHop-247"><span class="linenos">247</span></a><span class="sd">    The ending fractional coordinates of the diffusing site.</span>
</span><span id="MigrationHop-248"><a href="#MigrationHop-248"><span class="linenos">248</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationHop-249"><a href="#MigrationHop-249"><span class="linenos">249</span></a>
</span><span id="MigrationHop-250"><a href="#MigrationHop-250"><span class="linenos">250</span></a>    <span class="c1"># BUG: the init script for MigrationHop can&#39;t identify the site indexes</span>
</span><span id="MigrationHop-251"><a href="#MigrationHop-251"><span class="linenos">251</span></a>    <span class="c1"># properly but they should be the same as before because it is a symmetrized</span>
</span><span id="MigrationHop-252"><a href="#MigrationHop-252"><span class="linenos">252</span></a>    <span class="c1"># structure. Note that even if I&#39;m wrong in some case -- this will have</span>
</span><span id="MigrationHop-253"><a href="#MigrationHop-253"><span class="linenos">253</span></a>    <span class="c1"># no effect because iindex and eindex are only used in one portion of</span>
</span><span id="MigrationHop-254"><a href="#MigrationHop-254"><span class="linenos">254</span></a>    <span class="c1"># the hash as well as for printing the __str__ of the object.</span>
</span><span id="MigrationHop-255"><a href="#MigrationHop-255"><span class="linenos">255</span></a>
</span><span id="MigrationHop-256"><a href="#MigrationHop-256"><span class="linenos">256</span></a>    <span class="n">index_start</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationHop-257"><a href="#MigrationHop-257"><span class="linenos">257</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-258"><a href="#MigrationHop-258"><span class="linenos">258</span></a><span class="sd">    The starting site index of the diffusing site.</span>
</span><span id="MigrationHop-259"><a href="#MigrationHop-259"><span class="linenos">259</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationHop-260"><a href="#MigrationHop-260"><span class="linenos">260</span></a>
</span><span id="MigrationHop-261"><a href="#MigrationHop-261"><span class="linenos">261</span></a>    <span class="n">index_end</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationHop-262"><a href="#MigrationHop-262"><span class="linenos">262</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-263"><a href="#MigrationHop-263"><span class="linenos">263</span></a><span class="sd">    The ending site index of the diffusing site.</span>
</span><span id="MigrationHop-264"><a href="#MigrationHop-264"><span class="linenos">264</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationHop-265"><a href="#MigrationHop-265"><span class="linenos">265</span></a>
</span><span id="MigrationHop-266"><a href="#MigrationHop-266"><span class="linenos">266</span></a>    <span class="n">number</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationHop-267"><a href="#MigrationHop-267"><span class="linenos">267</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-268"><a href="#MigrationHop-268"><span class="linenos">268</span></a><span class="sd">    The expected index in DistinctPathFinder.get_paths. The shortest path is index 0</span>
</span><span id="MigrationHop-269"><a href="#MigrationHop-269"><span class="linenos">269</span></a><span class="sd">    and they are all ordered by increasing length.</span>
</span><span id="MigrationHop-270"><a href="#MigrationHop-270"><span class="linenos">270</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationHop-271"><a href="#MigrationHop-271"><span class="linenos">271</span></a>
</span><span id="MigrationHop-272"><a href="#MigrationHop-272"><span class="linenos">272</span></a>    <span class="n">length</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationHop-273"><a href="#MigrationHop-273"><span class="linenos">273</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-274"><a href="#MigrationHop-274"><span class="linenos">274</span></a><span class="sd">    The length/distance of the pathway from start to end. Note, this is </span>
</span><span id="MigrationHop-275"><a href="#MigrationHop-275"><span class="linenos">275</span></a><span class="sd">    linear measurement -- i.e. is it the length of the linear interpolated path.</span>
</span><span id="MigrationHop-276"><a href="#MigrationHop-276"><span class="linenos">276</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationHop-277"><a href="#MigrationHop-277"><span class="linenos">277</span></a>
</span><span id="MigrationHop-278"><a href="#MigrationHop-278"><span class="linenos">278</span></a>    <span class="n">dimension_path</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationHop-279"><a href="#MigrationHop-279"><span class="linenos">279</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-280"><a href="#MigrationHop-280"><span class="linenos">280</span></a><span class="sd">    The pathway dimensionality using the Larson scoring parameter.</span>
</span><span id="MigrationHop-281"><a href="#MigrationHop-281"><span class="linenos">281</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationHop-282"><a href="#MigrationHop-282"><span class="linenos">282</span></a>
</span><span id="MigrationHop-283"><a href="#MigrationHop-283"><span class="linenos">283</span></a>    <span class="n">dimension_host_lattice</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationHop-284"><a href="#MigrationHop-284"><span class="linenos">284</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-285"><a href="#MigrationHop-285"><span class="linenos">285</span></a><span class="sd">    Ignoring all atoms of the diffusing species, this is the dimensionality</span>
</span><span id="MigrationHop-286"><a href="#MigrationHop-286"><span class="linenos">286</span></a><span class="sd">    of the remaining atoms of the lattice using the Larson scoring parameter.</span>
</span><span id="MigrationHop-287"><a href="#MigrationHop-287"><span class="linenos">287</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationHop-288"><a href="#MigrationHop-288"><span class="linenos">288</span></a>
</span><span id="MigrationHop-289"><a href="#MigrationHop-289"><span class="linenos">289</span></a>    <span class="n">energy_barrier</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationHop-290"><a href="#MigrationHop-290"><span class="linenos">290</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-291"><a href="#MigrationHop-291"><span class="linenos">291</span></a><span class="sd">    The energy barrier in eV. This evaluates all images of the diffusion pathway</span>
</span><span id="MigrationHop-292"><a href="#MigrationHop-292"><span class="linenos">292</span></a><span class="sd">    and find the difference between the maximum and minimum image energies.</span>
</span><span id="MigrationHop-293"><a href="#MigrationHop-293"><span class="linenos">293</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationHop-294"><a href="#MigrationHop-294"><span class="linenos">294</span></a>
</span><span id="MigrationHop-295"><a href="#MigrationHop-295"><span class="linenos">295</span></a>    <span class="c1"># TODO:</span>
</span><span id="MigrationHop-296"><a href="#MigrationHop-296"><span class="linenos">296</span></a>    <span class="c1"># Distance of the pathway relative to the shortest pathway distance</span>
</span><span id="MigrationHop-297"><a href="#MigrationHop-297"><span class="linenos">297</span></a>    <span class="c1"># in the structure using the formula: (D - Dmin)/Dmin</span>
</span><span id="MigrationHop-298"><a href="#MigrationHop-298"><span class="linenos">298</span></a>    <span class="c1"># distance_rel_min = models.FloatField()</span>
</span><span id="MigrationHop-299"><a href="#MigrationHop-299"><span class="linenos">299</span></a>
</span><span id="MigrationHop-300"><a href="#MigrationHop-300"><span class="linenos">300</span></a>    <span class="sd">&quot;&quot;&quot; Relationships &quot;&quot;&quot;</span>
</span><span id="MigrationHop-301"><a href="#MigrationHop-301"><span class="linenos">301</span></a>    <span class="c1"># Each MigrationHop corresponds to the full analysis of one Structure, which</span>
</span><span id="MigrationHop-302"><a href="#MigrationHop-302"><span class="linenos">302</span></a>    <span class="c1"># can have many MigrationHop(s)</span>
</span><span id="MigrationHop-303"><a href="#MigrationHop-303"><span class="linenos">303</span></a>    <span class="c1"># diffusion_analysis = table_column.ForeignKey(</span>
</span><span id="MigrationHop-304"><a href="#MigrationHop-304"><span class="linenos">304</span></a>    <span class="c1">#     # DiffusionAnalysis,</span>
</span><span id="MigrationHop-305"><a href="#MigrationHop-305"><span class="linenos">305</span></a>    <span class="c1">#     on_delete=table_column.PROTECT,</span>
</span><span id="MigrationHop-306"><a href="#MigrationHop-306"><span class="linenos">306</span></a>    <span class="c1">#     related_name=&quot;migration_hops&quot;,</span>
</span><span id="MigrationHop-307"><a href="#MigrationHop-307"><span class="linenos">307</span></a>    <span class="c1"># )</span>
</span><span id="MigrationHop-308"><a href="#MigrationHop-308"><span class="linenos">308</span></a>
</span><span id="MigrationHop-309"><a href="#MigrationHop-309"><span class="linenos">309</span></a>    <span class="c1"># TODO:</span>
</span><span id="MigrationHop-310"><a href="#MigrationHop-310"><span class="linenos">310</span></a>    <span class="c1"># image_start --&gt; OneToOneField for specific MigrationHop</span>
</span><span id="MigrationHop-311"><a href="#MigrationHop-311"><span class="linenos">311</span></a>    <span class="c1"># image_end --&gt; OneToOneField for specific MigrationHop</span>
</span><span id="MigrationHop-312"><a href="#MigrationHop-312"><span class="linenos">312</span></a>    <span class="c1"># image_transition_state --&gt; OneToOneField for specific MigrationHop</span>
</span><span id="MigrationHop-313"><a href="#MigrationHop-313"><span class="linenos">313</span></a>
</span><span id="MigrationHop-314"><a href="#MigrationHop-314"><span class="linenos">314</span></a>    <span class="c1"># Just like Relaxation points to IonicSteps, NEB will point to MigrationImages</span>
</span><span id="MigrationHop-315"><a href="#MigrationHop-315"><span class="linenos">315</span></a>
</span><span id="MigrationHop-316"><a href="#MigrationHop-316"><span class="linenos">316</span></a>    <span class="nd">@classmethod</span>
</span><span id="MigrationHop-317"><a href="#MigrationHop-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">_from_toolkit</span><span class="p">(</span>
</span><span id="MigrationHop-318"><a href="#MigrationHop-318"><span class="linenos">318</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="MigrationHop-319"><a href="#MigrationHop-319"><span class="linenos">319</span></a>        <span class="n">migration_hop</span><span class="p">:</span> <span class="n">ToolkitMigrationHop</span><span class="p">,</span>
</span><span id="MigrationHop-320"><a href="#MigrationHop-320"><span class="linenos">320</span></a>        <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="MigrationHop-321"><a href="#MigrationHop-321"><span class="linenos">321</span></a>        <span class="n">number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MigrationHop-322"><a href="#MigrationHop-322"><span class="linenos">322</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MigrationHop-323"><a href="#MigrationHop-323"><span class="linenos">323</span></a>    <span class="p">):</span>
</span><span id="MigrationHop-324"><a href="#MigrationHop-324"><span class="linenos">324</span></a>
</span><span id="MigrationHop-325"><a href="#MigrationHop-325"><span class="linenos">325</span></a>        <span class="c1"># convert the pathway object into the database table format</span>
</span><span id="MigrationHop-326"><a href="#MigrationHop-326"><span class="linenos">326</span></a>        <span class="n">hop_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="MigrationHop-327"><a href="#MigrationHop-327"><span class="linenos">327</span></a>            <span class="n">site_start</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">migration_hop</span><span class="o">.</span><span class="n">isite</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">),</span>
</span><span id="MigrationHop-328"><a href="#MigrationHop-328"><span class="linenos">328</span></a>            <span class="n">site_end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">migration_hop</span><span class="o">.</span><span class="n">esite</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">),</span>
</span><span id="MigrationHop-329"><a href="#MigrationHop-329"><span class="linenos">329</span></a>            <span class="n">index_start</span><span class="o">=</span><span class="n">migration_hop</span><span class="o">.</span><span class="n">iindex</span><span class="p">,</span>
</span><span id="MigrationHop-330"><a href="#MigrationHop-330"><span class="linenos">330</span></a>            <span class="n">index_end</span><span class="o">=</span><span class="n">migration_hop</span><span class="o">.</span><span class="n">eindex</span><span class="p">,</span>
</span><span id="MigrationHop-331"><a href="#MigrationHop-331"><span class="linenos">331</span></a>            <span class="n">length</span><span class="o">=</span><span class="n">migration_hop</span><span class="o">.</span><span class="n">length</span><span class="p">,</span>
</span><span id="MigrationHop-332"><a href="#MigrationHop-332"><span class="linenos">332</span></a>            <span class="c1"># diffusion_analysis_id=diffusion_analysis_id,</span>
</span><span id="MigrationHop-333"><a href="#MigrationHop-333"><span class="linenos">333</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="MigrationHop-334"><a href="#MigrationHop-334"><span class="linenos">334</span></a>        <span class="p">)</span>
</span><span id="MigrationHop-335"><a href="#MigrationHop-335"><span class="linenos">335</span></a>
</span><span id="MigrationHop-336"><a href="#MigrationHop-336"><span class="linenos">336</span></a>        <span class="c1"># If as_dict is false, we build this into an Object. Otherwise, just</span>
</span><span id="MigrationHop-337"><a href="#MigrationHop-337"><span class="linenos">337</span></a>        <span class="c1"># return the dictionary</span>
</span><span id="MigrationHop-338"><a href="#MigrationHop-338"><span class="linenos">338</span></a>        <span class="k">return</span> <span class="n">hop_dict</span> <span class="k">if</span> <span class="n">as_dict</span> <span class="k">else</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">hop_dict</span><span class="p">)</span>
</span><span id="MigrationHop-339"><a href="#MigrationHop-339"><span class="linenos">339</span></a>
</span><span id="MigrationHop-340"><a href="#MigrationHop-340"><span class="linenos">340</span></a>    <span class="c1"># BUG: because of rounding in the from_toolkit method, the get_sc_structures</span>
</span><span id="MigrationHop-341"><a href="#MigrationHop-341"><span class="linenos">341</span></a>    <span class="c1"># is unable to identify equivalent sites. I opened an issue for this</span>
</span><span id="MigrationHop-342"><a href="#MigrationHop-342"><span class="linenos">342</span></a>    <span class="c1"># with their team:</span>
</span><span id="MigrationHop-343"><a href="#MigrationHop-343"><span class="linenos">343</span></a>    <span class="c1">#   https://github.com/materialsvirtuallab/pymatgen-analysis-diffusion/issues/296</span>
</span><span id="MigrationHop-344"><a href="#MigrationHop-344"><span class="linenos">344</span></a>    <span class="k">def</span> <span class="nf">to_toolkit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolkitMigrationHop</span><span class="p">:</span>
</span><span id="MigrationHop-345"><a href="#MigrationHop-345"><span class="linenos">345</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-346"><a href="#MigrationHop-346"><span class="linenos">346</span></a><span class="sd">        converts the database MigrationHop to a toolkit MigrationHop</span>
</span><span id="MigrationHop-347"><a href="#MigrationHop-347"><span class="linenos">347</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MigrationHop-348"><a href="#MigrationHop-348"><span class="linenos">348</span></a>        <span class="c1"># The bulk crystal structure is stored in the diffusion analysis table</span>
</span><span id="MigrationHop-349"><a href="#MigrationHop-349"><span class="linenos">349</span></a>        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">to_toolkit</span><span class="p">()</span>
</span><span id="MigrationHop-350"><a href="#MigrationHop-350"><span class="linenos">350</span></a>
</span><span id="MigrationHop-351"><a href="#MigrationHop-351"><span class="linenos">351</span></a>        <span class="c1"># pathways require a symmetrized structure</span>
</span><span id="MigrationHop-352"><a href="#MigrationHop-352"><span class="linenos">352</span></a>        <span class="c1"># BUG: I need to ensure the symmetrized structure comes out the same</span>
</span><span id="MigrationHop-353"><a href="#MigrationHop-353"><span class="linenos">353</span></a>        <span class="c1"># as before, so I need to be careful with updates and hardcoding here.</span>
</span><span id="MigrationHop-354"><a href="#MigrationHop-354"><span class="linenos">354</span></a>        <span class="n">sga</span> <span class="o">=</span> <span class="n">SpacegroupAnalyzer</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="MigrationHop-355"><a href="#MigrationHop-355"><span class="linenos">355</span></a>        <span class="n">symm_structure</span> <span class="o">=</span> <span class="n">sga</span><span class="o">.</span><span class="n">get_symmetrized_structure</span><span class="p">()</span>
</span><span id="MigrationHop-356"><a href="#MigrationHop-356"><span class="linenos">356</span></a>
</span><span id="MigrationHop-357"><a href="#MigrationHop-357"><span class="linenos">357</span></a>        <span class="n">isite_new</span> <span class="o">=</span> <span class="n">PeriodicSite</span><span class="p">(</span>
</span><span id="MigrationHop-358"><a href="#MigrationHop-358"><span class="linenos">358</span></a>            <span class="n">species</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">migrating_specie</span><span class="p">,</span>
</span><span id="MigrationHop-359"><a href="#MigrationHop-359"><span class="linenos">359</span></a>            <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">site_start</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)],</span>
</span><span id="MigrationHop-360"><a href="#MigrationHop-360"><span class="linenos">360</span></a>            <span class="n">lattice</span><span class="o">=</span><span class="n">symm_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
</span><span id="MigrationHop-361"><a href="#MigrationHop-361"><span class="linenos">361</span></a>        <span class="p">)</span>
</span><span id="MigrationHop-362"><a href="#MigrationHop-362"><span class="linenos">362</span></a>        <span class="n">esite_new</span> <span class="o">=</span> <span class="n">PeriodicSite</span><span class="p">(</span>
</span><span id="MigrationHop-363"><a href="#MigrationHop-363"><span class="linenos">363</span></a>            <span class="n">species</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">migrating_specie</span><span class="p">,</span>
</span><span id="MigrationHop-364"><a href="#MigrationHop-364"><span class="linenos">364</span></a>            <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">site_end</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)],</span>
</span><span id="MigrationHop-365"><a href="#MigrationHop-365"><span class="linenos">365</span></a>            <span class="n">lattice</span><span class="o">=</span><span class="n">symm_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
</span><span id="MigrationHop-366"><a href="#MigrationHop-366"><span class="linenos">366</span></a>        <span class="p">)</span>
</span><span id="MigrationHop-367"><a href="#MigrationHop-367"><span class="linenos">367</span></a>
</span><span id="MigrationHop-368"><a href="#MigrationHop-368"><span class="linenos">368</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">ToolkitMigrationHop</span><span class="p">(</span><span class="n">isite_new</span><span class="p">,</span> <span class="n">esite_new</span><span class="p">,</span> <span class="n">symm_structure</span><span class="p">)</span>
</span><span id="MigrationHop-369"><a href="#MigrationHop-369"><span class="linenos">369</span></a>        <span class="c1"># BUG: see comment attached to definition of these fields</span>
</span><span id="MigrationHop-370"><a href="#MigrationHop-370"><span class="linenos">370</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">iindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_start</span>
</span><span id="MigrationHop-371"><a href="#MigrationHop-371"><span class="linenos">371</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">eindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_end</span>
</span><span id="MigrationHop-372"><a href="#MigrationHop-372"><span class="linenos">372</span></a>
</span><span id="MigrationHop-373"><a href="#MigrationHop-373"><span class="linenos">373</span></a>        <span class="c1"># if the pathways match, then we can return the pathway object!</span>
</span><span id="MigrationHop-374"><a href="#MigrationHop-374"><span class="linenos">374</span></a>        <span class="k">return</span> <span class="n">path</span>
</span><span id="MigrationHop-375"><a href="#MigrationHop-375"><span class="linenos">375</span></a>
</span><span id="MigrationHop-376"><a href="#MigrationHop-376"><span class="linenos">376</span></a>    <span class="c1">#######</span>
</span><span id="MigrationHop-377"><a href="#MigrationHop-377"><span class="linenos">377</span></a>    <span class="c1"># BUG: I need to distinguish between the from_toolkit/to_toolkit methods</span>
</span><span id="MigrationHop-378"><a href="#MigrationHop-378"><span class="linenos">378</span></a>    <span class="c1"># above that just load a MigrationImages object vs. the from_directory and</span>
</span><span id="MigrationHop-379"><a href="#MigrationHop-379"><span class="linenos">379</span></a>    <span class="c1"># from_pymatgen methods below that include results. As-is these similar</span>
</span><span id="MigrationHop-380"><a href="#MigrationHop-380"><span class="linenos">380</span></a>    <span class="c1"># names but very different use cases makes things confusing for users.</span>
</span><span id="MigrationHop-381"><a href="#MigrationHop-381"><span class="linenos">381</span></a>    <span class="c1">#######</span>
</span><span id="MigrationHop-382"><a href="#MigrationHop-382"><span class="linenos">382</span></a>
</span><span id="MigrationHop-383"><a href="#MigrationHop-383"><span class="linenos">383</span></a>    <span class="nd">@classmethod</span>
</span><span id="MigrationHop-384"><a href="#MigrationHop-384"><span class="linenos">384</span></a>    <span class="k">def</span> <span class="nf">from_directory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MigrationHop-385"><a href="#MigrationHop-385"><span class="linenos">385</span></a>        <span class="c1"># I assume the directory is from a vasp calculation, but I need to update</span>
</span><span id="MigrationHop-386"><a href="#MigrationHop-386"><span class="linenos">386</span></a>        <span class="c1"># this when I begin adding new calculators.</span>
</span><span id="MigrationHop-387"><a href="#MigrationHop-387"><span class="linenos">387</span></a>
</span><span id="MigrationHop-388"><a href="#MigrationHop-388"><span class="linenos">388</span></a>        <span class="c1"># BUG: A fix is make during the workup() method that may be relevant here.</span>
</span><span id="MigrationHop-389"><a href="#MigrationHop-389"><span class="linenos">389</span></a>        <span class="c1"># simmate.calculators.vasp.tasks.nudged_elastic_band.MITNudgedElasticBand.workup</span>
</span><span id="MigrationHop-390"><a href="#MigrationHop-390"><span class="linenos">390</span></a>        <span class="n">analysis</span> <span class="o">=</span> <span class="n">NEBAnalysis</span><span class="o">.</span><span class="n">from_dir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span><span id="MigrationHop-391"><a href="#MigrationHop-391"><span class="linenos">391</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_pymatgen</span><span class="p">(</span><span class="n">analysis</span><span class="o">=</span><span class="n">analysis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MigrationHop-392"><a href="#MigrationHop-392"><span class="linenos">392</span></a>
</span><span id="MigrationHop-393"><a href="#MigrationHop-393"><span class="linenos">393</span></a>    <span class="nd">@classmethod</span>
</span><span id="MigrationHop-394"><a href="#MigrationHop-394"><span class="linenos">394</span></a>    <span class="k">def</span> <span class="nf">from_pymatgen</span><span class="p">(</span>
</span><span id="MigrationHop-395"><a href="#MigrationHop-395"><span class="linenos">395</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="MigrationHop-396"><a href="#MigrationHop-396"><span class="linenos">396</span></a>        <span class="n">analysis</span><span class="p">:</span> <span class="n">NEBAnalysis</span><span class="p">,</span>
</span><span id="MigrationHop-397"><a href="#MigrationHop-397"><span class="linenos">397</span></a>        <span class="n">diffusion_analysis_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># only used if updating</span>
</span><span id="MigrationHop-398"><a href="#MigrationHop-398"><span class="linenos">398</span></a>        <span class="n">migration_hop_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># only used if updating</span>
</span><span id="MigrationHop-399"><a href="#MigrationHop-399"><span class="linenos">399</span></a>    <span class="p">):</span>
</span><span id="MigrationHop-400"><a href="#MigrationHop-400"><span class="linenos">400</span></a>        <span class="c1"># We reference these related tables frequently below so it easier to</span>
</span><span id="MigrationHop-401"><a href="#MigrationHop-401"><span class="linenos">401</span></a>        <span class="c1"># grab them up front.</span>
</span><span id="MigrationHop-402"><a href="#MigrationHop-402"><span class="linenos">402</span></a>        <span class="n">diffusion_analysis_table</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">related_model</span>
</span><span id="MigrationHop-403"><a href="#MigrationHop-403"><span class="linenos">403</span></a>        <span class="n">migration_image_table</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">migration_images</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">model</span>
</span><span id="MigrationHop-404"><a href="#MigrationHop-404"><span class="linenos">404</span></a>
</span><span id="MigrationHop-405"><a href="#MigrationHop-405"><span class="linenos">405</span></a>        <span class="c1"># First, we need a migration_hop database object.</span>
</span><span id="MigrationHop-406"><a href="#MigrationHop-406"><span class="linenos">406</span></a>        <span class="c1"># All of hops should link to a diffusion_analysis entry, so we check</span>
</span><span id="MigrationHop-407"><a href="#MigrationHop-407"><span class="linenos">407</span></a>        <span class="c1"># for that here too. The key thing of these statements is that we</span>
</span><span id="MigrationHop-408"><a href="#MigrationHop-408"><span class="linenos">408</span></a>        <span class="c1"># have a migration_hop_id at the end.</span>
</span><span id="MigrationHop-409"><a href="#MigrationHop-409"><span class="linenos">409</span></a>
</span><span id="MigrationHop-410"><a href="#MigrationHop-410"><span class="linenos">410</span></a>        <span class="c1"># If no ids were given, then we make a new entries for each.</span>
</span><span id="MigrationHop-411"><a href="#MigrationHop-411"><span class="linenos">411</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">diffusion_analysis_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">migration_hop_id</span><span class="p">:</span>
</span><span id="MigrationHop-412"><a href="#MigrationHop-412"><span class="linenos">412</span></a>            <span class="c1"># Note, we have minimal information if this is the case, so these</span>
</span><span id="MigrationHop-413"><a href="#MigrationHop-413"><span class="linenos">413</span></a>            <span class="c1"># table entries will have a bunch of empty columns.</span>
</span><span id="MigrationHop-414"><a href="#MigrationHop-414"><span class="linenos">414</span></a>
</span><span id="MigrationHop-415"><a href="#MigrationHop-415"><span class="linenos">415</span></a>            <span class="c1"># We don&#39;t have a bulk structure to use for this class, so we use</span>
</span><span id="MigrationHop-416"><a href="#MigrationHop-416"><span class="linenos">416</span></a>            <span class="c1"># the first image</span>
</span><span id="MigrationHop-417"><a href="#MigrationHop-417"><span class="linenos">417</span></a>            <span class="n">analysis_db</span> <span class="o">=</span> <span class="n">diffusion_analysis_table</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span>
</span><span id="MigrationHop-418"><a href="#MigrationHop-418"><span class="linenos">418</span></a>                <span class="n">structure</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">structures</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="MigrationHop-419"><a href="#MigrationHop-419"><span class="linenos">419</span></a>                <span class="n">vacancy_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># assume this for now</span>
</span><span id="MigrationHop-420"><a href="#MigrationHop-420"><span class="linenos">420</span></a>            <span class="p">)</span>
</span><span id="MigrationHop-421"><a href="#MigrationHop-421"><span class="linenos">421</span></a>            <span class="n">analysis_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="MigrationHop-422"><a href="#MigrationHop-422"><span class="linenos">422</span></a>
</span><span id="MigrationHop-423"><a href="#MigrationHop-423"><span class="linenos">423</span></a>            <span class="c1"># This table entry will actually be completely empty... It only</span>
</span><span id="MigrationHop-424"><a href="#MigrationHop-424"><span class="linenos">424</span></a>            <span class="c1"># serves to link the MigrationImages together</span>
</span><span id="MigrationHop-425"><a href="#MigrationHop-425"><span class="linenos">425</span></a>            <span class="n">hop_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MigrationHop-426"><a href="#MigrationHop-426"><span class="linenos">426</span></a>                <span class="n">diffusion_analysis_id</span><span class="o">=</span><span class="n">analysis_db</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="MigrationHop-427"><a href="#MigrationHop-427"><span class="linenos">427</span></a>            <span class="p">)</span>
</span><span id="MigrationHop-428"><a href="#MigrationHop-428"><span class="linenos">428</span></a>            <span class="n">hop_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="MigrationHop-429"><a href="#MigrationHop-429"><span class="linenos">429</span></a>            <span class="n">migration_hop_id</span> <span class="o">=</span> <span class="n">hop_db</span><span class="o">.</span><span class="n">id</span>
</span><span id="MigrationHop-430"><a href="#MigrationHop-430"><span class="linenos">430</span></a>
</span><span id="MigrationHop-431"><a href="#MigrationHop-431"><span class="linenos">431</span></a>        <span class="k">elif</span> <span class="n">diffusion_analysis_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">migration_hop_id</span><span class="p">:</span>
</span><span id="MigrationHop-432"><a href="#MigrationHop-432"><span class="linenos">432</span></a>            <span class="c1"># This table entry will actually be completely empty... It only</span>
</span><span id="MigrationHop-433"><a href="#MigrationHop-433"><span class="linenos">433</span></a>            <span class="c1"># serves to link the MigrationImages together</span>
</span><span id="MigrationHop-434"><a href="#MigrationHop-434"><span class="linenos">434</span></a>            <span class="n">hop_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">diffusion_analysis_id</span><span class="o">=</span><span class="n">diffusion_analysis_id</span><span class="p">)</span>
</span><span id="MigrationHop-435"><a href="#MigrationHop-435"><span class="linenos">435</span></a>            <span class="n">hop_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="MigrationHop-436"><a href="#MigrationHop-436"><span class="linenos">436</span></a>            <span class="n">migration_hop_id</span> <span class="o">=</span> <span class="n">hop_db</span><span class="o">.</span><span class="n">id</span>
</span><span id="MigrationHop-437"><a href="#MigrationHop-437"><span class="linenos">437</span></a>
</span><span id="MigrationHop-438"><a href="#MigrationHop-438"><span class="linenos">438</span></a>        <span class="k">elif</span> <span class="n">migration_hop_id</span><span class="p">:</span>
</span><span id="MigrationHop-439"><a href="#MigrationHop-439"><span class="linenos">439</span></a>            <span class="c1"># We don&#39;t use the hop_id, but making this query ensures it exists.</span>
</span><span id="MigrationHop-440"><a href="#MigrationHop-440"><span class="linenos">440</span></a>            <span class="n">hop_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">migration_hop_id</span><span class="p">)</span>
</span><span id="MigrationHop-441"><a href="#MigrationHop-441"><span class="linenos">441</span></a>            <span class="c1"># Even though it&#39;s not required, we make sure the id given for the</span>
</span><span id="MigrationHop-442"><a href="#MigrationHop-442"><span class="linenos">442</span></a>            <span class="c1"># diffusion analysis table matches this existing hop id.</span>
</span><span id="MigrationHop-443"><a href="#MigrationHop-443"><span class="linenos">443</span></a>            <span class="k">if</span> <span class="n">diffusion_analysis_id</span><span class="p">:</span>
</span><span id="MigrationHop-444"><a href="#MigrationHop-444"><span class="linenos">444</span></a>                <span class="k">assert</span> <span class="n">hop_db</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">diffusion_analysis_id</span>
</span><span id="MigrationHop-445"><a href="#MigrationHop-445"><span class="linenos">445</span></a>
</span><span id="MigrationHop-446"><a href="#MigrationHop-446"><span class="linenos">446</span></a>        <span class="c1"># Now same migration images and link them to this parent object.</span>
</span><span id="MigrationHop-447"><a href="#MigrationHop-447"><span class="linenos">447</span></a>        <span class="c1"># Note, the start/end Migration images will exist already in the</span>
</span><span id="MigrationHop-448"><a href="#MigrationHop-448"><span class="linenos">448</span></a>        <span class="c1"># relaxation database table. We still want to save them again here for</span>
</span><span id="MigrationHop-449"><a href="#MigrationHop-449"><span class="linenos">449</span></a>        <span class="c1"># easy access.</span>
</span><span id="MigrationHop-450"><a href="#MigrationHop-450"><span class="linenos">450</span></a>        <span class="k">for</span> <span class="n">image_number</span><span class="p">,</span> <span class="n">image_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
</span><span id="MigrationHop-451"><a href="#MigrationHop-451"><span class="linenos">451</span></a>            <span class="nb">zip</span><span class="p">(</span>
</span><span id="MigrationHop-452"><a href="#MigrationHop-452"><span class="linenos">452</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">structures</span><span class="p">,</span>
</span><span id="MigrationHop-453"><a href="#MigrationHop-453"><span class="linenos">453</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">energies</span><span class="p">,</span>
</span><span id="MigrationHop-454"><a href="#MigrationHop-454"><span class="linenos">454</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">forces</span><span class="p">,</span>
</span><span id="MigrationHop-455"><a href="#MigrationHop-455"><span class="linenos">455</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
</span><span id="MigrationHop-456"><a href="#MigrationHop-456"><span class="linenos">456</span></a>            <span class="p">)</span>
</span><span id="MigrationHop-457"><a href="#MigrationHop-457"><span class="linenos">457</span></a>        <span class="p">):</span>
</span><span id="MigrationHop-458"><a href="#MigrationHop-458"><span class="linenos">458</span></a>            <span class="n">image</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">image_data</span>
</span><span id="MigrationHop-459"><a href="#MigrationHop-459"><span class="linenos">459</span></a>            <span class="n">image_db</span> <span class="o">=</span> <span class="n">migration_image_table</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span>
</span><span id="MigrationHop-460"><a href="#MigrationHop-460"><span class="linenos">460</span></a>                <span class="n">structure</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
</span><span id="MigrationHop-461"><a href="#MigrationHop-461"><span class="linenos">461</span></a>                <span class="n">number</span><span class="o">=</span><span class="n">image_number</span><span class="p">,</span>
</span><span id="MigrationHop-462"><a href="#MigrationHop-462"><span class="linenos">462</span></a>                <span class="n">force_tangent</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
</span><span id="MigrationHop-463"><a href="#MigrationHop-463"><span class="linenos">463</span></a>                <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">,</span>
</span><span id="MigrationHop-464"><a href="#MigrationHop-464"><span class="linenos">464</span></a>                <span class="n">structure_distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span>
</span><span id="MigrationHop-465"><a href="#MigrationHop-465"><span class="linenos">465</span></a>                <span class="n">migration_hop_id</span><span class="o">=</span><span class="n">migration_hop_id</span><span class="p">,</span>
</span><span id="MigrationHop-466"><a href="#MigrationHop-466"><span class="linenos">466</span></a>            <span class="p">)</span>
</span><span id="MigrationHop-467"><a href="#MigrationHop-467"><span class="linenos">467</span></a>            <span class="n">image_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="MigrationHop-468"><a href="#MigrationHop-468"><span class="linenos">468</span></a>
</span><span id="MigrationHop-469"><a href="#MigrationHop-469"><span class="linenos">469</span></a>        <span class="k">return</span> <span class="n">hop_db</span>
</span><span id="MigrationHop-470"><a href="#MigrationHop-470"><span class="linenos">470</span></a>
</span><span id="MigrationHop-471"><a href="#MigrationHop-471"><span class="linenos">471</span></a>    <span class="nd">@classmethod</span>
</span><span id="MigrationHop-472"><a href="#MigrationHop-472"><span class="linenos">472</span></a>    <span class="k">def</span> <span class="nf">create_subclasses_from_diffusion_analysis</span><span class="p">(</span>
</span><span id="MigrationHop-473"><a href="#MigrationHop-473"><span class="linenos">473</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="MigrationHop-474"><a href="#MigrationHop-474"><span class="linenos">474</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MigrationHop-475"><a href="#MigrationHop-475"><span class="linenos">475</span></a>        <span class="n">diffusion_analysis</span><span class="p">:</span> <span class="n">DiffusionAnalysis</span><span class="p">,</span>
</span><span id="MigrationHop-476"><a href="#MigrationHop-476"><span class="linenos">476</span></a>        <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MigrationHop-477"><a href="#MigrationHop-477"><span class="linenos">477</span></a>        <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationHop-478"><a href="#MigrationHop-478"><span class="linenos">478</span></a>    <span class="p">):</span>
</span><span id="MigrationHop-479"><a href="#MigrationHop-479"><span class="linenos">479</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop-480"><a href="#MigrationHop-480"><span class="linenos">480</span></a><span class="sd">        Dynamically creates subclass of MigrationHop and MigrationImage, then</span>
</span><span id="MigrationHop-481"><a href="#MigrationHop-481"><span class="linenos">481</span></a><span class="sd">        links them to the DiffusionAnalysis table.</span>
</span><span id="MigrationHop-482"><a href="#MigrationHop-482"><span class="linenos">482</span></a>
</span><span id="MigrationHop-483"><a href="#MigrationHop-483"><span class="linenos">483</span></a><span class="sd">        This method should NOT be called directly because it is instead used by</span>
</span><span id="MigrationHop-484"><a href="#MigrationHop-484"><span class="linenos">484</span></a><span class="sd">        `DiffusionAnalysis.create_subclasses`.</span>
</span><span id="MigrationHop-485"><a href="#MigrationHop-485"><span class="linenos">485</span></a>
</span><span id="MigrationHop-486"><a href="#MigrationHop-486"><span class="linenos">486</span></a><span class="sd">        #### Parameters</span>
</span><span id="MigrationHop-487"><a href="#MigrationHop-487"><span class="linenos">487</span></a>
</span><span id="MigrationHop-488"><a href="#MigrationHop-488"><span class="linenos">488</span></a><span class="sd">        - `name` :</span>
</span><span id="MigrationHop-489"><a href="#MigrationHop-489"><span class="linenos">489</span></a><span class="sd">            Name of the subclass that is output.</span>
</span><span id="MigrationHop-490"><a href="#MigrationHop-490"><span class="linenos">490</span></a><span class="sd">        - `diffusion_analysis` :</span>
</span><span id="MigrationHop-491"><a href="#MigrationHop-491"><span class="linenos">491</span></a><span class="sd">            DiffusionAnalysis table that these subclasses should be associated with.</span>
</span><span id="MigrationHop-492"><a href="#MigrationHop-492"><span class="linenos">492</span></a><span class="sd">        - `module` :</span>
</span><span id="MigrationHop-493"><a href="#MigrationHop-493"><span class="linenos">493</span></a><span class="sd">            name of the module this subclass should be associated with. Typically,</span>
</span><span id="MigrationHop-494"><a href="#MigrationHop-494"><span class="linenos">494</span></a><span class="sd">            you should pass __name__ to this.</span>
</span><span id="MigrationHop-495"><a href="#MigrationHop-495"><span class="linenos">495</span></a><span class="sd">        - `**extra_columns` :</span>
</span><span id="MigrationHop-496"><a href="#MigrationHop-496"><span class="linenos">496</span></a><span class="sd">            Additional columns to add to the table. The keyword will be the</span>
</span><span id="MigrationHop-497"><a href="#MigrationHop-497"><span class="linenos">497</span></a><span class="sd">            column name and the value should match django options</span>
</span><span id="MigrationHop-498"><a href="#MigrationHop-498"><span class="linenos">498</span></a><span class="sd">            (e.g. table_column.FloatField())</span>
</span><span id="MigrationHop-499"><a href="#MigrationHop-499"><span class="linenos">499</span></a>
</span><span id="MigrationHop-500"><a href="#MigrationHop-500"><span class="linenos">500</span></a><span class="sd">        #### Returns</span>
</span><span id="MigrationHop-501"><a href="#MigrationHop-501"><span class="linenos">501</span></a>
</span><span id="MigrationHop-502"><a href="#MigrationHop-502"><span class="linenos">502</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="MigrationHop-503"><a href="#MigrationHop-503"><span class="linenos">503</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="MigrationHop-504"><a href="#MigrationHop-504"><span class="linenos">504</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="MigrationHop-505"><a href="#MigrationHop-505"><span class="linenos">505</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="MigrationHop-506"><a href="#MigrationHop-506"><span class="linenos">506</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MigrationHop-507"><a href="#MigrationHop-507"><span class="linenos">507</span></a>
</span><span id="MigrationHop-508"><a href="#MigrationHop-508"><span class="linenos">508</span></a>        <span class="n">NewMigrationHopClass</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_subclass</span><span class="p">(</span>
</span><span id="MigrationHop-509"><a href="#MigrationHop-509"><span class="linenos">509</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">MigrationHop&quot;</span><span class="p">,</span>
</span><span id="MigrationHop-510"><a href="#MigrationHop-510"><span class="linenos">510</span></a>            <span class="n">diffusion_analysis</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
</span><span id="MigrationHop-511"><a href="#MigrationHop-511"><span class="linenos">511</span></a>                <span class="n">diffusion_analysis</span><span class="p">,</span>
</span><span id="MigrationHop-512"><a href="#MigrationHop-512"><span class="linenos">512</span></a>                <span class="n">on_delete</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
</span><span id="MigrationHop-513"><a href="#MigrationHop-513"><span class="linenos">513</span></a>                <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;migration_hops&quot;</span><span class="p">,</span>
</span><span id="MigrationHop-514"><a href="#MigrationHop-514"><span class="linenos">514</span></a>            <span class="p">),</span>
</span><span id="MigrationHop-515"><a href="#MigrationHop-515"><span class="linenos">515</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="MigrationHop-516"><a href="#MigrationHop-516"><span class="linenos">516</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationHop-517"><a href="#MigrationHop-517"><span class="linenos">517</span></a>        <span class="p">)</span>
</span><span id="MigrationHop-518"><a href="#MigrationHop-518"><span class="linenos">518</span></a>
</span><span id="MigrationHop-519"><a href="#MigrationHop-519"><span class="linenos">519</span></a>        <span class="n">NewMigrationImageClass</span> <span class="o">=</span> <span class="n">MigrationImage</span><span class="o">.</span><span class="n">create_subclass_from_migration_hop</span><span class="p">(</span>
</span><span id="MigrationHop-520"><a href="#MigrationHop-520"><span class="linenos">520</span></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="MigrationHop-521"><a href="#MigrationHop-521"><span class="linenos">521</span></a>            <span class="n">NewMigrationHopClass</span><span class="p">,</span>
</span><span id="MigrationHop-522"><a href="#MigrationHop-522"><span class="linenos">522</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="MigrationHop-523"><a href="#MigrationHop-523"><span class="linenos">523</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationHop-524"><a href="#MigrationHop-524"><span class="linenos">524</span></a>        <span class="p">)</span>
</span><span id="MigrationHop-525"><a href="#MigrationHop-525"><span class="linenos">525</span></a>
</span><span id="MigrationHop-526"><a href="#MigrationHop-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="n">NewMigrationHopClass</span><span class="p">,</span> <span class="n">NewMigrationImageClass</span>
</span></pre></div>


            <div class="docstring"><p>The base class for defining a table in the Simmate database. All tables and
mixins inherit from this class.</p>

<p>Usage is identical to
<a href="https://docs.djangoproject.com/en/4.0/#the-model-layer">models in Django</a>
where this class only adds extra methods for convenience.</p>
</div>


                            <div id="MigrationHop.base_info" class="classattr">
                                <div class="attr variable">
            <span class="name">base_info</span><span class="annotation">: List[str]</span><span class="default_value"> = [&#39;site_start&#39;, &#39;site_end&#39;, &#39;index_start&#39;, &#39;index_end&#39;, &#39;number&#39;]</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.base_info"></a>
    
            <div class="docstring"><p>The base information for this database table and only these fields are stored
when the <code>to_archive</code> method is used. Using the columns in this list, all 
other columns for this table can be calculated, so the columns in this list 
are effectively the "raw data".</p>
</div>


                            </div>
                            <div id="MigrationHop.site_start" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">site_start</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.site_start"></a>
    
            <div class="docstring"><p>The starting fractional coordinates of the diffusing site.</p>
</div>


                            </div>
                            <div id="MigrationHop.site_end" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">site_end</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.site_end"></a>
    
            <div class="docstring"><p>The ending fractional coordinates of the diffusing site.</p>
</div>


                            </div>
                            <div id="MigrationHop.index_start" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">index_start</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.index_start"></a>
    
            <div class="docstring"><p>The starting site index of the diffusing site.</p>
</div>


                            </div>
                            <div id="MigrationHop.index_end" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">index_end</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.index_end"></a>
    
            <div class="docstring"><p>The ending site index of the diffusing site.</p>
</div>


                            </div>
                            <div id="MigrationHop.number" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">number</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.number"></a>
    
            <div class="docstring"><p>The expected index in DistinctPathFinder.get_paths. The shortest path is index 0
and they are all ordered by increasing length.</p>
</div>


                            </div>
                            <div id="MigrationHop.length" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">length</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.length"></a>
    
            <div class="docstring"><p>The length/distance of the pathway from start to end. Note, this is 
linear measurement -- i.e. is it the length of the linear interpolated path.</p>
</div>


                            </div>
                            <div id="MigrationHop.dimension_path" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dimension_path</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.dimension_path"></a>
    
            <div class="docstring"><p>The pathway dimensionality using the Larson scoring parameter.</p>
</div>


                            </div>
                            <div id="MigrationHop.dimension_host_lattice" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dimension_host_lattice</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.dimension_host_lattice"></a>
    
            <div class="docstring"><p>Ignoring all atoms of the diffusing species, this is the dimensionality
of the remaining atoms of the lattice using the Larson scoring parameter.</p>
</div>


                            </div>
                            <div id="MigrationHop.energy_barrier" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">energy_barrier</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.energy_barrier"></a>
    
            <div class="docstring"><p>The energy barrier in eV. This evaluates all images of the diffusion pathway
and find the difference between the maximum and minimum image energies.</p>
</div>


                            </div>
                            <div id="MigrationHop.to_toolkit" class="classattr">
                                        <input id="MigrationHop.to_toolkit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_toolkit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="../../toolkit/diffusion/migration_hop.html#MigrationHop">simmate.toolkit.diffusion.migration_hop.MigrationHop</a></span>:</span></span>

                <label class="view-source-button" for="MigrationHop.to_toolkit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MigrationHop.to_toolkit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MigrationHop.to_toolkit-344"><a href="#MigrationHop.to_toolkit-344"><span class="linenos">344</span></a>    <span class="k">def</span> <span class="nf">to_toolkit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolkitMigrationHop</span><span class="p">:</span>
</span><span id="MigrationHop.to_toolkit-345"><a href="#MigrationHop.to_toolkit-345"><span class="linenos">345</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop.to_toolkit-346"><a href="#MigrationHop.to_toolkit-346"><span class="linenos">346</span></a><span class="sd">        converts the database MigrationHop to a toolkit MigrationHop</span>
</span><span id="MigrationHop.to_toolkit-347"><a href="#MigrationHop.to_toolkit-347"><span class="linenos">347</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MigrationHop.to_toolkit-348"><a href="#MigrationHop.to_toolkit-348"><span class="linenos">348</span></a>        <span class="c1"># The bulk crystal structure is stored in the diffusion analysis table</span>
</span><span id="MigrationHop.to_toolkit-349"><a href="#MigrationHop.to_toolkit-349"><span class="linenos">349</span></a>        <span class="n">structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">to_toolkit</span><span class="p">()</span>
</span><span id="MigrationHop.to_toolkit-350"><a href="#MigrationHop.to_toolkit-350"><span class="linenos">350</span></a>
</span><span id="MigrationHop.to_toolkit-351"><a href="#MigrationHop.to_toolkit-351"><span class="linenos">351</span></a>        <span class="c1"># pathways require a symmetrized structure</span>
</span><span id="MigrationHop.to_toolkit-352"><a href="#MigrationHop.to_toolkit-352"><span class="linenos">352</span></a>        <span class="c1"># BUG: I need to ensure the symmetrized structure comes out the same</span>
</span><span id="MigrationHop.to_toolkit-353"><a href="#MigrationHop.to_toolkit-353"><span class="linenos">353</span></a>        <span class="c1"># as before, so I need to be careful with updates and hardcoding here.</span>
</span><span id="MigrationHop.to_toolkit-354"><a href="#MigrationHop.to_toolkit-354"><span class="linenos">354</span></a>        <span class="n">sga</span> <span class="o">=</span> <span class="n">SpacegroupAnalyzer</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">symprec</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span><span id="MigrationHop.to_toolkit-355"><a href="#MigrationHop.to_toolkit-355"><span class="linenos">355</span></a>        <span class="n">symm_structure</span> <span class="o">=</span> <span class="n">sga</span><span class="o">.</span><span class="n">get_symmetrized_structure</span><span class="p">()</span>
</span><span id="MigrationHop.to_toolkit-356"><a href="#MigrationHop.to_toolkit-356"><span class="linenos">356</span></a>
</span><span id="MigrationHop.to_toolkit-357"><a href="#MigrationHop.to_toolkit-357"><span class="linenos">357</span></a>        <span class="n">isite_new</span> <span class="o">=</span> <span class="n">PeriodicSite</span><span class="p">(</span>
</span><span id="MigrationHop.to_toolkit-358"><a href="#MigrationHop.to_toolkit-358"><span class="linenos">358</span></a>            <span class="n">species</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">migrating_specie</span><span class="p">,</span>
</span><span id="MigrationHop.to_toolkit-359"><a href="#MigrationHop.to_toolkit-359"><span class="linenos">359</span></a>            <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">site_start</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)],</span>
</span><span id="MigrationHop.to_toolkit-360"><a href="#MigrationHop.to_toolkit-360"><span class="linenos">360</span></a>            <span class="n">lattice</span><span class="o">=</span><span class="n">symm_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
</span><span id="MigrationHop.to_toolkit-361"><a href="#MigrationHop.to_toolkit-361"><span class="linenos">361</span></a>        <span class="p">)</span>
</span><span id="MigrationHop.to_toolkit-362"><a href="#MigrationHop.to_toolkit-362"><span class="linenos">362</span></a>        <span class="n">esite_new</span> <span class="o">=</span> <span class="n">PeriodicSite</span><span class="p">(</span>
</span><span id="MigrationHop.to_toolkit-363"><a href="#MigrationHop.to_toolkit-363"><span class="linenos">363</span></a>            <span class="n">species</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">migrating_specie</span><span class="p">,</span>
</span><span id="MigrationHop.to_toolkit-364"><a href="#MigrationHop.to_toolkit-364"><span class="linenos">364</span></a>            <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">site_end</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)],</span>
</span><span id="MigrationHop.to_toolkit-365"><a href="#MigrationHop.to_toolkit-365"><span class="linenos">365</span></a>            <span class="n">lattice</span><span class="o">=</span><span class="n">symm_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
</span><span id="MigrationHop.to_toolkit-366"><a href="#MigrationHop.to_toolkit-366"><span class="linenos">366</span></a>        <span class="p">)</span>
</span><span id="MigrationHop.to_toolkit-367"><a href="#MigrationHop.to_toolkit-367"><span class="linenos">367</span></a>
</span><span id="MigrationHop.to_toolkit-368"><a href="#MigrationHop.to_toolkit-368"><span class="linenos">368</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">ToolkitMigrationHop</span><span class="p">(</span><span class="n">isite_new</span><span class="p">,</span> <span class="n">esite_new</span><span class="p">,</span> <span class="n">symm_structure</span><span class="p">)</span>
</span><span id="MigrationHop.to_toolkit-369"><a href="#MigrationHop.to_toolkit-369"><span class="linenos">369</span></a>        <span class="c1"># BUG: see comment attached to definition of these fields</span>
</span><span id="MigrationHop.to_toolkit-370"><a href="#MigrationHop.to_toolkit-370"><span class="linenos">370</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">iindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_start</span>
</span><span id="MigrationHop.to_toolkit-371"><a href="#MigrationHop.to_toolkit-371"><span class="linenos">371</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">eindex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_end</span>
</span><span id="MigrationHop.to_toolkit-372"><a href="#MigrationHop.to_toolkit-372"><span class="linenos">372</span></a>
</span><span id="MigrationHop.to_toolkit-373"><a href="#MigrationHop.to_toolkit-373"><span class="linenos">373</span></a>        <span class="c1"># if the pathways match, then we can return the pathway object!</span>
</span><span id="MigrationHop.to_toolkit-374"><a href="#MigrationHop.to_toolkit-374"><span class="linenos">374</span></a>        <span class="k">return</span> <span class="n">path</span>
</span></pre></div>


            <div class="docstring"><p>converts the database MigrationHop to a toolkit MigrationHop</p>
</div>


                            </div>
                            <div id="MigrationHop.from_directory" class="classattr">
                                        <input id="MigrationHop.from_directory-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_directory</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="MigrationHop.from_directory-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MigrationHop.from_directory"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MigrationHop.from_directory-383"><a href="#MigrationHop.from_directory-383"><span class="linenos">383</span></a>    <span class="nd">@classmethod</span>
</span><span id="MigrationHop.from_directory-384"><a href="#MigrationHop.from_directory-384"><span class="linenos">384</span></a>    <span class="k">def</span> <span class="nf">from_directory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MigrationHop.from_directory-385"><a href="#MigrationHop.from_directory-385"><span class="linenos">385</span></a>        <span class="c1"># I assume the directory is from a vasp calculation, but I need to update</span>
</span><span id="MigrationHop.from_directory-386"><a href="#MigrationHop.from_directory-386"><span class="linenos">386</span></a>        <span class="c1"># this when I begin adding new calculators.</span>
</span><span id="MigrationHop.from_directory-387"><a href="#MigrationHop.from_directory-387"><span class="linenos">387</span></a>
</span><span id="MigrationHop.from_directory-388"><a href="#MigrationHop.from_directory-388"><span class="linenos">388</span></a>        <span class="c1"># BUG: A fix is make during the workup() method that may be relevant here.</span>
</span><span id="MigrationHop.from_directory-389"><a href="#MigrationHop.from_directory-389"><span class="linenos">389</span></a>        <span class="c1"># simmate.calculators.vasp.tasks.nudged_elastic_band.MITNudgedElasticBand.workup</span>
</span><span id="MigrationHop.from_directory-390"><a href="#MigrationHop.from_directory-390"><span class="linenos">390</span></a>        <span class="n">analysis</span> <span class="o">=</span> <span class="n">NEBAnalysis</span><span class="o">.</span><span class="n">from_dir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span><span id="MigrationHop.from_directory-391"><a href="#MigrationHop.from_directory-391"><span class="linenos">391</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_pymatgen</span><span class="p">(</span><span class="n">analysis</span><span class="o">=</span><span class="n">analysis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MigrationHop.from_pymatgen" class="classattr">
                                        <input id="MigrationHop.from_pymatgen-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_pymatgen</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">analysis</span><span class="p">:</span> <span class="n">pymatgen</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">transition_state</span><span class="o">.</span><span class="n">NEBAnalysis</span>,</span><span class="param">	<span class="n">diffusion_analysis_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">migration_hop_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="MigrationHop.from_pymatgen-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MigrationHop.from_pymatgen"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MigrationHop.from_pymatgen-393"><a href="#MigrationHop.from_pymatgen-393"><span class="linenos">393</span></a>    <span class="nd">@classmethod</span>
</span><span id="MigrationHop.from_pymatgen-394"><a href="#MigrationHop.from_pymatgen-394"><span class="linenos">394</span></a>    <span class="k">def</span> <span class="nf">from_pymatgen</span><span class="p">(</span>
</span><span id="MigrationHop.from_pymatgen-395"><a href="#MigrationHop.from_pymatgen-395"><span class="linenos">395</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-396"><a href="#MigrationHop.from_pymatgen-396"><span class="linenos">396</span></a>        <span class="n">analysis</span><span class="p">:</span> <span class="n">NEBAnalysis</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-397"><a href="#MigrationHop.from_pymatgen-397"><span class="linenos">397</span></a>        <span class="n">diffusion_analysis_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># only used if updating</span>
</span><span id="MigrationHop.from_pymatgen-398"><a href="#MigrationHop.from_pymatgen-398"><span class="linenos">398</span></a>        <span class="n">migration_hop_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># only used if updating</span>
</span><span id="MigrationHop.from_pymatgen-399"><a href="#MigrationHop.from_pymatgen-399"><span class="linenos">399</span></a>    <span class="p">):</span>
</span><span id="MigrationHop.from_pymatgen-400"><a href="#MigrationHop.from_pymatgen-400"><span class="linenos">400</span></a>        <span class="c1"># We reference these related tables frequently below so it easier to</span>
</span><span id="MigrationHop.from_pymatgen-401"><a href="#MigrationHop.from_pymatgen-401"><span class="linenos">401</span></a>        <span class="c1"># grab them up front.</span>
</span><span id="MigrationHop.from_pymatgen-402"><a href="#MigrationHop.from_pymatgen-402"><span class="linenos">402</span></a>        <span class="n">diffusion_analysis_table</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">related_model</span>
</span><span id="MigrationHop.from_pymatgen-403"><a href="#MigrationHop.from_pymatgen-403"><span class="linenos">403</span></a>        <span class="n">migration_image_table</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">migration_images</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">model</span>
</span><span id="MigrationHop.from_pymatgen-404"><a href="#MigrationHop.from_pymatgen-404"><span class="linenos">404</span></a>
</span><span id="MigrationHop.from_pymatgen-405"><a href="#MigrationHop.from_pymatgen-405"><span class="linenos">405</span></a>        <span class="c1"># First, we need a migration_hop database object.</span>
</span><span id="MigrationHop.from_pymatgen-406"><a href="#MigrationHop.from_pymatgen-406"><span class="linenos">406</span></a>        <span class="c1"># All of hops should link to a diffusion_analysis entry, so we check</span>
</span><span id="MigrationHop.from_pymatgen-407"><a href="#MigrationHop.from_pymatgen-407"><span class="linenos">407</span></a>        <span class="c1"># for that here too. The key thing of these statements is that we</span>
</span><span id="MigrationHop.from_pymatgen-408"><a href="#MigrationHop.from_pymatgen-408"><span class="linenos">408</span></a>        <span class="c1"># have a migration_hop_id at the end.</span>
</span><span id="MigrationHop.from_pymatgen-409"><a href="#MigrationHop.from_pymatgen-409"><span class="linenos">409</span></a>
</span><span id="MigrationHop.from_pymatgen-410"><a href="#MigrationHop.from_pymatgen-410"><span class="linenos">410</span></a>        <span class="c1"># If no ids were given, then we make a new entries for each.</span>
</span><span id="MigrationHop.from_pymatgen-411"><a href="#MigrationHop.from_pymatgen-411"><span class="linenos">411</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">diffusion_analysis_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">migration_hop_id</span><span class="p">:</span>
</span><span id="MigrationHop.from_pymatgen-412"><a href="#MigrationHop.from_pymatgen-412"><span class="linenos">412</span></a>            <span class="c1"># Note, we have minimal information if this is the case, so these</span>
</span><span id="MigrationHop.from_pymatgen-413"><a href="#MigrationHop.from_pymatgen-413"><span class="linenos">413</span></a>            <span class="c1"># table entries will have a bunch of empty columns.</span>
</span><span id="MigrationHop.from_pymatgen-414"><a href="#MigrationHop.from_pymatgen-414"><span class="linenos">414</span></a>
</span><span id="MigrationHop.from_pymatgen-415"><a href="#MigrationHop.from_pymatgen-415"><span class="linenos">415</span></a>            <span class="c1"># We don&#39;t have a bulk structure to use for this class, so we use</span>
</span><span id="MigrationHop.from_pymatgen-416"><a href="#MigrationHop.from_pymatgen-416"><span class="linenos">416</span></a>            <span class="c1"># the first image</span>
</span><span id="MigrationHop.from_pymatgen-417"><a href="#MigrationHop.from_pymatgen-417"><span class="linenos">417</span></a>            <span class="n">analysis_db</span> <span class="o">=</span> <span class="n">diffusion_analysis_table</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span>
</span><span id="MigrationHop.from_pymatgen-418"><a href="#MigrationHop.from_pymatgen-418"><span class="linenos">418</span></a>                <span class="n">structure</span><span class="o">=</span><span class="n">analysis</span><span class="o">.</span><span class="n">structures</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="MigrationHop.from_pymatgen-419"><a href="#MigrationHop.from_pymatgen-419"><span class="linenos">419</span></a>                <span class="n">vacancy_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># assume this for now</span>
</span><span id="MigrationHop.from_pymatgen-420"><a href="#MigrationHop.from_pymatgen-420"><span class="linenos">420</span></a>            <span class="p">)</span>
</span><span id="MigrationHop.from_pymatgen-421"><a href="#MigrationHop.from_pymatgen-421"><span class="linenos">421</span></a>            <span class="n">analysis_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="MigrationHop.from_pymatgen-422"><a href="#MigrationHop.from_pymatgen-422"><span class="linenos">422</span></a>
</span><span id="MigrationHop.from_pymatgen-423"><a href="#MigrationHop.from_pymatgen-423"><span class="linenos">423</span></a>            <span class="c1"># This table entry will actually be completely empty... It only</span>
</span><span id="MigrationHop.from_pymatgen-424"><a href="#MigrationHop.from_pymatgen-424"><span class="linenos">424</span></a>            <span class="c1"># serves to link the MigrationImages together</span>
</span><span id="MigrationHop.from_pymatgen-425"><a href="#MigrationHop.from_pymatgen-425"><span class="linenos">425</span></a>            <span class="n">hop_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="MigrationHop.from_pymatgen-426"><a href="#MigrationHop.from_pymatgen-426"><span class="linenos">426</span></a>                <span class="n">diffusion_analysis_id</span><span class="o">=</span><span class="n">analysis_db</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-427"><a href="#MigrationHop.from_pymatgen-427"><span class="linenos">427</span></a>            <span class="p">)</span>
</span><span id="MigrationHop.from_pymatgen-428"><a href="#MigrationHop.from_pymatgen-428"><span class="linenos">428</span></a>            <span class="n">hop_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="MigrationHop.from_pymatgen-429"><a href="#MigrationHop.from_pymatgen-429"><span class="linenos">429</span></a>            <span class="n">migration_hop_id</span> <span class="o">=</span> <span class="n">hop_db</span><span class="o">.</span><span class="n">id</span>
</span><span id="MigrationHop.from_pymatgen-430"><a href="#MigrationHop.from_pymatgen-430"><span class="linenos">430</span></a>
</span><span id="MigrationHop.from_pymatgen-431"><a href="#MigrationHop.from_pymatgen-431"><span class="linenos">431</span></a>        <span class="k">elif</span> <span class="n">diffusion_analysis_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">migration_hop_id</span><span class="p">:</span>
</span><span id="MigrationHop.from_pymatgen-432"><a href="#MigrationHop.from_pymatgen-432"><span class="linenos">432</span></a>            <span class="c1"># This table entry will actually be completely empty... It only</span>
</span><span id="MigrationHop.from_pymatgen-433"><a href="#MigrationHop.from_pymatgen-433"><span class="linenos">433</span></a>            <span class="c1"># serves to link the MigrationImages together</span>
</span><span id="MigrationHop.from_pymatgen-434"><a href="#MigrationHop.from_pymatgen-434"><span class="linenos">434</span></a>            <span class="n">hop_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">diffusion_analysis_id</span><span class="o">=</span><span class="n">diffusion_analysis_id</span><span class="p">)</span>
</span><span id="MigrationHop.from_pymatgen-435"><a href="#MigrationHop.from_pymatgen-435"><span class="linenos">435</span></a>            <span class="n">hop_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="MigrationHop.from_pymatgen-436"><a href="#MigrationHop.from_pymatgen-436"><span class="linenos">436</span></a>            <span class="n">migration_hop_id</span> <span class="o">=</span> <span class="n">hop_db</span><span class="o">.</span><span class="n">id</span>
</span><span id="MigrationHop.from_pymatgen-437"><a href="#MigrationHop.from_pymatgen-437"><span class="linenos">437</span></a>
</span><span id="MigrationHop.from_pymatgen-438"><a href="#MigrationHop.from_pymatgen-438"><span class="linenos">438</span></a>        <span class="k">elif</span> <span class="n">migration_hop_id</span><span class="p">:</span>
</span><span id="MigrationHop.from_pymatgen-439"><a href="#MigrationHop.from_pymatgen-439"><span class="linenos">439</span></a>            <span class="c1"># We don&#39;t use the hop_id, but making this query ensures it exists.</span>
</span><span id="MigrationHop.from_pymatgen-440"><a href="#MigrationHop.from_pymatgen-440"><span class="linenos">440</span></a>            <span class="n">hop_db</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">migration_hop_id</span><span class="p">)</span>
</span><span id="MigrationHop.from_pymatgen-441"><a href="#MigrationHop.from_pymatgen-441"><span class="linenos">441</span></a>            <span class="c1"># Even though it&#39;s not required, we make sure the id given for the</span>
</span><span id="MigrationHop.from_pymatgen-442"><a href="#MigrationHop.from_pymatgen-442"><span class="linenos">442</span></a>            <span class="c1"># diffusion analysis table matches this existing hop id.</span>
</span><span id="MigrationHop.from_pymatgen-443"><a href="#MigrationHop.from_pymatgen-443"><span class="linenos">443</span></a>            <span class="k">if</span> <span class="n">diffusion_analysis_id</span><span class="p">:</span>
</span><span id="MigrationHop.from_pymatgen-444"><a href="#MigrationHop.from_pymatgen-444"><span class="linenos">444</span></a>                <span class="k">assert</span> <span class="n">hop_db</span><span class="o">.</span><span class="n">diffusion_analysis</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">diffusion_analysis_id</span>
</span><span id="MigrationHop.from_pymatgen-445"><a href="#MigrationHop.from_pymatgen-445"><span class="linenos">445</span></a>
</span><span id="MigrationHop.from_pymatgen-446"><a href="#MigrationHop.from_pymatgen-446"><span class="linenos">446</span></a>        <span class="c1"># Now same migration images and link them to this parent object.</span>
</span><span id="MigrationHop.from_pymatgen-447"><a href="#MigrationHop.from_pymatgen-447"><span class="linenos">447</span></a>        <span class="c1"># Note, the start/end Migration images will exist already in the</span>
</span><span id="MigrationHop.from_pymatgen-448"><a href="#MigrationHop.from_pymatgen-448"><span class="linenos">448</span></a>        <span class="c1"># relaxation database table. We still want to save them again here for</span>
</span><span id="MigrationHop.from_pymatgen-449"><a href="#MigrationHop.from_pymatgen-449"><span class="linenos">449</span></a>        <span class="c1"># easy access.</span>
</span><span id="MigrationHop.from_pymatgen-450"><a href="#MigrationHop.from_pymatgen-450"><span class="linenos">450</span></a>        <span class="k">for</span> <span class="n">image_number</span><span class="p">,</span> <span class="n">image_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
</span><span id="MigrationHop.from_pymatgen-451"><a href="#MigrationHop.from_pymatgen-451"><span class="linenos">451</span></a>            <span class="nb">zip</span><span class="p">(</span>
</span><span id="MigrationHop.from_pymatgen-452"><a href="#MigrationHop.from_pymatgen-452"><span class="linenos">452</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">structures</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-453"><a href="#MigrationHop.from_pymatgen-453"><span class="linenos">453</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">energies</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-454"><a href="#MigrationHop.from_pymatgen-454"><span class="linenos">454</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">forces</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-455"><a href="#MigrationHop.from_pymatgen-455"><span class="linenos">455</span></a>                <span class="n">analysis</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-456"><a href="#MigrationHop.from_pymatgen-456"><span class="linenos">456</span></a>            <span class="p">)</span>
</span><span id="MigrationHop.from_pymatgen-457"><a href="#MigrationHop.from_pymatgen-457"><span class="linenos">457</span></a>        <span class="p">):</span>
</span><span id="MigrationHop.from_pymatgen-458"><a href="#MigrationHop.from_pymatgen-458"><span class="linenos">458</span></a>            <span class="n">image</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="n">distance</span> <span class="o">=</span> <span class="n">image_data</span>
</span><span id="MigrationHop.from_pymatgen-459"><a href="#MigrationHop.from_pymatgen-459"><span class="linenos">459</span></a>            <span class="n">image_db</span> <span class="o">=</span> <span class="n">migration_image_table</span><span class="o">.</span><span class="n">from_toolkit</span><span class="p">(</span>
</span><span id="MigrationHop.from_pymatgen-460"><a href="#MigrationHop.from_pymatgen-460"><span class="linenos">460</span></a>                <span class="n">structure</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-461"><a href="#MigrationHop.from_pymatgen-461"><span class="linenos">461</span></a>                <span class="n">number</span><span class="o">=</span><span class="n">image_number</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-462"><a href="#MigrationHop.from_pymatgen-462"><span class="linenos">462</span></a>                <span class="n">force_tangent</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-463"><a href="#MigrationHop.from_pymatgen-463"><span class="linenos">463</span></a>                <span class="n">energy</span><span class="o">=</span><span class="n">energy</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-464"><a href="#MigrationHop.from_pymatgen-464"><span class="linenos">464</span></a>                <span class="n">structure_distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-465"><a href="#MigrationHop.from_pymatgen-465"><span class="linenos">465</span></a>                <span class="n">migration_hop_id</span><span class="o">=</span><span class="n">migration_hop_id</span><span class="p">,</span>
</span><span id="MigrationHop.from_pymatgen-466"><a href="#MigrationHop.from_pymatgen-466"><span class="linenos">466</span></a>            <span class="p">)</span>
</span><span id="MigrationHop.from_pymatgen-467"><a href="#MigrationHop.from_pymatgen-467"><span class="linenos">467</span></a>            <span class="n">image_db</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="MigrationHop.from_pymatgen-468"><a href="#MigrationHop.from_pymatgen-468"><span class="linenos">468</span></a>
</span><span id="MigrationHop.from_pymatgen-469"><a href="#MigrationHop.from_pymatgen-469"><span class="linenos">469</span></a>        <span class="k">return</span> <span class="n">hop_db</span>
</span></pre></div>


    

                            </div>
                            <div id="MigrationHop.create_subclasses_from_diffusion_analysis" class="classattr">
                                        <input id="MigrationHop.create_subclasses_from_diffusion_analysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">create_subclasses_from_diffusion_analysis</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">diffusion_analysis</span><span class="p">:</span> <span class="n"><a href="#DiffusionAnalysis">simmate.database.base_data_types.nudged_elastic_band.DiffusionAnalysis</a></span>,</span><span class="param">	<span class="n">module</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">**</span><span class="n">extra_columns</span></span>)</span>

                <label class="view-source-button" for="MigrationHop.create_subclasses_from_diffusion_analysis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MigrationHop.create_subclasses_from_diffusion_analysis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-471"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-471"><span class="linenos">471</span></a>    <span class="nd">@classmethod</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-472"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-472"><span class="linenos">472</span></a>    <span class="k">def</span> <span class="nf">create_subclasses_from_diffusion_analysis</span><span class="p">(</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-473"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-473"><span class="linenos">473</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-474"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-474"><span class="linenos">474</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-475"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-475"><span class="linenos">475</span></a>        <span class="n">diffusion_analysis</span><span class="p">:</span> <span class="n">DiffusionAnalysis</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-476"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-476"><span class="linenos">476</span></a>        <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-477"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-477"><span class="linenos">477</span></a>        <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-478"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-478"><span class="linenos">478</span></a>    <span class="p">):</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-479"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-479"><span class="linenos">479</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-480"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-480"><span class="linenos">480</span></a><span class="sd">        Dynamically creates subclass of MigrationHop and MigrationImage, then</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-481"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-481"><span class="linenos">481</span></a><span class="sd">        links them to the DiffusionAnalysis table.</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-482"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-482"><span class="linenos">482</span></a>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-483"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-483"><span class="linenos">483</span></a><span class="sd">        This method should NOT be called directly because it is instead used by</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-484"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-484"><span class="linenos">484</span></a><span class="sd">        `DiffusionAnalysis.create_subclasses`.</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-485"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-485"><span class="linenos">485</span></a>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-486"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-486"><span class="linenos">486</span></a><span class="sd">        #### Parameters</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-487"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-487"><span class="linenos">487</span></a>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-488"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-488"><span class="linenos">488</span></a><span class="sd">        - `name` :</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-489"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-489"><span class="linenos">489</span></a><span class="sd">            Name of the subclass that is output.</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-490"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-490"><span class="linenos">490</span></a><span class="sd">        - `diffusion_analysis` :</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-491"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-491"><span class="linenos">491</span></a><span class="sd">            DiffusionAnalysis table that these subclasses should be associated with.</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-492"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-492"><span class="linenos">492</span></a><span class="sd">        - `module` :</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-493"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-493"><span class="linenos">493</span></a><span class="sd">            name of the module this subclass should be associated with. Typically,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-494"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-494"><span class="linenos">494</span></a><span class="sd">            you should pass __name__ to this.</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-495"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-495"><span class="linenos">495</span></a><span class="sd">        - `**extra_columns` :</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-496"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-496"><span class="linenos">496</span></a><span class="sd">            Additional columns to add to the table. The keyword will be the</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-497"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-497"><span class="linenos">497</span></a><span class="sd">            column name and the value should match django options</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-498"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-498"><span class="linenos">498</span></a><span class="sd">            (e.g. table_column.FloatField())</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-499"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-499"><span class="linenos">499</span></a>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-500"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-500"><span class="linenos">500</span></a><span class="sd">        #### Returns</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-501"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-501"><span class="linenos">501</span></a>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-502"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-502"><span class="linenos">502</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-503"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-503"><span class="linenos">503</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-504"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-504"><span class="linenos">504</span></a><span class="sd">        - `NewMigrationHopClass`:</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-505"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-505"><span class="linenos">505</span></a><span class="sd">            A subclass of MigrationHop.</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-506"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-506"><span class="linenos">506</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-507"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-507"><span class="linenos">507</span></a>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-508"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-508"><span class="linenos">508</span></a>        <span class="n">NewMigrationHopClass</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_subclass</span><span class="p">(</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-509"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-509"><span class="linenos">509</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">MigrationHop&quot;</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-510"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-510"><span class="linenos">510</span></a>            <span class="n">diffusion_analysis</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-511"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-511"><span class="linenos">511</span></a>                <span class="n">diffusion_analysis</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-512"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-512"><span class="linenos">512</span></a>                <span class="n">on_delete</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-513"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-513"><span class="linenos">513</span></a>                <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;migration_hops&quot;</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-514"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-514"><span class="linenos">514</span></a>            <span class="p">),</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-515"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-515"><span class="linenos">515</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-516"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-516"><span class="linenos">516</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-517"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-517"><span class="linenos">517</span></a>        <span class="p">)</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-518"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-518"><span class="linenos">518</span></a>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-519"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-519"><span class="linenos">519</span></a>        <span class="n">NewMigrationImageClass</span> <span class="o">=</span> <span class="n">MigrationImage</span><span class="o">.</span><span class="n">create_subclass_from_migration_hop</span><span class="p">(</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-520"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-520"><span class="linenos">520</span></a>            <span class="n">name</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-521"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-521"><span class="linenos">521</span></a>            <span class="n">NewMigrationHopClass</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-522"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-522"><span class="linenos">522</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-523"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-523"><span class="linenos">523</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-524"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-524"><span class="linenos">524</span></a>        <span class="p">)</span>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-525"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-525"><span class="linenos">525</span></a>
</span><span id="MigrationHop.create_subclasses_from_diffusion_analysis-526"><a href="#MigrationHop.create_subclasses_from_diffusion_analysis-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="n">NewMigrationHopClass</span><span class="p">,</span> <span class="n">NewMigrationImageClass</span>
</span></pre></div>


            <div class="docstring"><p>Dynamically creates subclass of MigrationHop and MigrationImage, then
links them to the DiffusionAnalysis table.</p>

<p>This method should NOT be called directly because it is instead used by
<code><a href="#DiffusionAnalysis.create_subclasses">DiffusionAnalysis.create_subclasses</a></code>.</p>

<h4 id="parameters">Parameters</h4>

<ul>
<li><code>name</code> :
Name of the subclass that is output.</li>
<li><code>diffusion_analysis</code> :
DiffusionAnalysis table that these subclasses should be associated with.</li>
<li><code>module</code> :
name of the module this subclass should be associated with. Typically,
you should pass __name__ to this.</li>
<li><code>**extra_columns</code> :
Additional columns to add to the table. The keyword will be the
column name and the value should match django options
(e.g. table_column.FloatField())</li>
</ul>

<h4 id="returns">Returns</h4>

<ul>
<li><code>NewMigrationHopClass</code>:
A subclass of MigrationHop.</li>
<li><code>NewMigrationHopClass</code>:
A subclass of MigrationHop.</li>
</ul>
</div>


                            </div>
                            <div id="MigrationHop.created_at" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">created_at</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.created_at"></a>
    
            <div class="docstring"><p>Timestamp of when this row was first added to the database table</p>
</div>


                            </div>
                            <div id="MigrationHop.updated_at" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">updated_at</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.updated_at"></a>
    
            <div class="docstring"><p>Timestamp of when this row was was lasted changed / updated</p>
</div>


                            </div>
                            <div id="MigrationHop.source" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">source</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.source"></a>
    
            <div class="docstring"><blockquote>
  <p>Note, this field is highly experimental at the moment and subject to
  change.</p>
</blockquote>

<p>This column indicates where the data came from, and it could be a number 
of things including...</p>

<ul>
<li>a third party id</li>
<li>a structure from a different Simmate datbase table</li>
<li>a transformation of another structure</li>
<li>a creation method</li>
<li>a custom submission by the user</li>
</ul>

<p>By default, this is a JSON field to account for all scenarios, but some
tables (such as those in <code><a href="../third_parties.html">simmate.database.third_parties</a></code>) this is value
should be the same for ALL entries in the table and therefore the column is
overwritten as an attribute.</p>

<p>For other tables where this is not a constant, here are some examples of
values used in this column:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="c1"># from a thirdparty database or separate table</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;MatprojStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;mp-123&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># from a random structure creator</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;PyXtalStructure&quot;</span><span class="p">}</span>

<span class="c1"># from a templated structure creator (e.g. substituition or prototypes)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;PrototypeStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;AFLOWPrototypes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># from a transformation</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;MirrorMutation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;MatprojStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;mp-123&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># from a multi-structure transformation</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;HereditaryMutation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;MatprojStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mp-123&quot;</span><span class="p">,</span> <span class="s2">&quot;mp-321&quot;</span><span class="p">],</span>
<span class="p">}</span>
</code></pre></div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>django.db.models.base.Model</dt>
                                <dd id="MigrationHop.__init__" class="function">Model</dd>
                <dd id="MigrationHop.from_db" class="function">from_db</dd>
                <dd id="MigrationHop.pk" class="variable">pk</dd>
                <dd id="MigrationHop.get_deferred_fields" class="function">get_deferred_fields</dd>
                <dd id="MigrationHop.refresh_from_db" class="function">refresh_from_db</dd>
                <dd id="MigrationHop.serializable_value" class="function">serializable_value</dd>
                <dd id="MigrationHop.save" class="function">save</dd>
                <dd id="MigrationHop.save_base" class="function">save_base</dd>
                <dd id="MigrationHop.delete" class="function">delete</dd>
                <dd id="MigrationHop.prepare_database_save" class="function">prepare_database_save</dd>
                <dd id="MigrationHop.clean" class="function">clean</dd>
                <dd id="MigrationHop.validate_unique" class="function">validate_unique</dd>
                <dd id="MigrationHop.date_error_message" class="function">date_error_message</dd>
                <dd id="MigrationHop.unique_error_message" class="function">unique_error_message</dd>
                <dd id="MigrationHop.full_clean" class="function">full_clean</dd>
                <dd id="MigrationHop.clean_fields" class="function">clean_fields</dd>
                <dd id="MigrationHop.check" class="function">check</dd>

            </div>
            <div><dt><a href="base.html#DatabaseTable">simmate.database.base_data_types.base.DatabaseTable</a></dt>
                                <dd id="MigrationHop.source_doi" class="variable"><a href="base.html#DatabaseTable.source_doi">source_doi</a></dd>
                <dd id="MigrationHop.remote_archive_link" class="variable"><a href="base.html#DatabaseTable.remote_archive_link">remote_archive_link</a></dd>
                <dd id="MigrationHop.objects" class="function"><a href="base.html#DatabaseTable.objects">objects</a></dd>
                <dd id="MigrationHop.get_table_name" class="function"><a href="base.html#DatabaseTable.get_table_name">get_table_name</a></dd>
                <dd id="MigrationHop.create_subclass" class="function"><a href="base.html#DatabaseTable.create_subclass">create_subclass</a></dd>
                <dd id="MigrationHop.from_toolkit" class="function"><a href="base.html#DatabaseTable.from_toolkit">from_toolkit</a></dd>
                <dd id="MigrationHop.update_from_toolkit" class="function"><a href="base.html#DatabaseTable.update_from_toolkit">update_from_toolkit</a></dd>
                <dd id="MigrationHop.load_archive" class="function"><a href="base.html#DatabaseTable.load_archive">load_archive</a></dd>
                <dd id="MigrationHop.load_remote_archive" class="function"><a href="base.html#DatabaseTable.load_remote_archive">load_remote_archive</a></dd>
                <dd id="MigrationHop.get_column_names" class="function"><a href="base.html#DatabaseTable.get_column_names">get_column_names</a></dd>
                <dd id="MigrationHop.show_columns" class="function"><a href="base.html#DatabaseTable.show_columns">show_columns</a></dd>
                <dd id="MigrationHop.get_mixins" class="function"><a href="base.html#DatabaseTable.get_mixins">get_mixins</a></dd>
                <dd id="MigrationHop.get_mixin_names" class="function"><a href="base.html#DatabaseTable.get_mixin_names">get_mixin_names</a></dd>
                <dd id="MigrationHop.get_extra_columns" class="function"><a href="base.html#DatabaseTable.get_extra_columns">get_extra_columns</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MigrationHop.Meta">
                            <input id="MigrationHop.Meta-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MigrationHop.Meta</span>:

                <label class="view-source-button" for="MigrationHop.Meta-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MigrationHop.Meta"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MigrationHop.Meta-222"><a href="#MigrationHop.Meta-222"><span class="linenos">222</span></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span id="MigrationHop.Meta-223"><a href="#MigrationHop.Meta-223"><span class="linenos">223</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MigrationHop.Meta-224"><a href="#MigrationHop.Meta-224"><span class="linenos">224</span></a>        <span class="n">app_label</span> <span class="o">=</span> <span class="s2">&quot;workflows&quot;</span>
</span></pre></div>


    

                            <div id="MigrationHop.Meta.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">MigrationHop.Meta</span><span class="signature pdoc-code condensed">()</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.Meta.__init__"></a>
    
    

                            </div>
                            <div id="MigrationHop.Meta.abstract" class="classattr">
                                <div class="attr variable">
            <span class="name">abstract</span><span class="default_value"> = False</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.Meta.abstract"></a>
    
    

                            </div>
                            <div id="MigrationHop.Meta.app_label" class="classattr">
                                <div class="attr variable">
            <span class="name">app_label</span><span class="default_value"> = &#39;workflows&#39;</span>

        
    </div>
    <a class="headerlink" href="#MigrationHop.Meta.app_label"></a>
    
    

                            </div>
                </section>
                <section id="MigrationImage">
                            <input id="MigrationImage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MigrationImage</span><wbr>(<span class="base"><a href="structure.html#Structure">simmate.database.base_data_types.structure.Structure</a></span>):

                <label class="view-source-button" for="MigrationImage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MigrationImage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MigrationImage-529"><a href="#MigrationImage-529"><span class="linenos">529</span></a><span class="k">class</span> <span class="nc">MigrationImage</span><span class="p">(</span><span class="n">Structure</span><span class="p">):</span>
</span><span id="MigrationImage-530"><a href="#MigrationImage-530"><span class="linenos">530</span></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span id="MigrationImage-531"><a href="#MigrationImage-531"><span class="linenos">531</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MigrationImage-532"><a href="#MigrationImage-532"><span class="linenos">532</span></a>        <span class="n">app_label</span> <span class="o">=</span> <span class="s2">&quot;workflows&quot;</span>
</span><span id="MigrationImage-533"><a href="#MigrationImage-533"><span class="linenos">533</span></a>
</span><span id="MigrationImage-534"><a href="#MigrationImage-534"><span class="linenos">534</span></a>    <span class="n">base_info</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MigrationImage-535"><a href="#MigrationImage-535"><span class="linenos">535</span></a>        <span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="MigrationImage-536"><a href="#MigrationImage-536"><span class="linenos">536</span></a>        <span class="s2">&quot;structure_string&quot;</span><span class="p">,</span>
</span><span id="MigrationImage-537"><a href="#MigrationImage-537"><span class="linenos">537</span></a>        <span class="s2">&quot;force_tangent&quot;</span><span class="p">,</span>
</span><span id="MigrationImage-538"><a href="#MigrationImage-538"><span class="linenos">538</span></a>        <span class="s2">&quot;structure_distance&quot;</span><span class="p">,</span>
</span><span id="MigrationImage-539"><a href="#MigrationImage-539"><span class="linenos">539</span></a>        <span class="s2">&quot;energy&quot;</span><span class="p">,</span>
</span><span id="MigrationImage-540"><a href="#MigrationImage-540"><span class="linenos">540</span></a>    <span class="p">]</span>
</span><span id="MigrationImage-541"><a href="#MigrationImage-541"><span class="linenos">541</span></a>
</span><span id="MigrationImage-542"><a href="#MigrationImage-542"><span class="linenos">542</span></a>    <span class="n">number</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
</span><span id="MigrationImage-543"><a href="#MigrationImage-543"><span class="linenos">543</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationImage-544"><a href="#MigrationImage-544"><span class="linenos">544</span></a><span class="sd">    The image number. Note, the starting image is always 0 and the ending</span>
</span><span id="MigrationImage-545"><a href="#MigrationImage-545"><span class="linenos">545</span></a><span class="sd">    image is always -1. The choice of -1 is because we often add the ending</span>
</span><span id="MigrationImage-546"><a href="#MigrationImage-546"><span class="linenos">546</span></a><span class="sd">    image to the database table before knowing how many midpoint images we</span>
</span><span id="MigrationImage-547"><a href="#MigrationImage-547"><span class="linenos">547</span></a><span class="sd">    are going to create.</span>
</span><span id="MigrationImage-548"><a href="#MigrationImage-548"><span class="linenos">548</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationImage-549"><a href="#MigrationImage-549"><span class="linenos">549</span></a>
</span><span id="MigrationImage-550"><a href="#MigrationImage-550"><span class="linenos">550</span></a>    <span class="n">force_tangent</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationImage-551"><a href="#MigrationImage-551"><span class="linenos">551</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationImage-552"><a href="#MigrationImage-552"><span class="linenos">552</span></a><span class="sd">    The tangent force of image. Not to be confused with forces from the Forces mix-in.</span>
</span><span id="MigrationImage-553"><a href="#MigrationImage-553"><span class="linenos">553</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationImage-554"><a href="#MigrationImage-554"><span class="linenos">554</span></a>
</span><span id="MigrationImage-555"><a href="#MigrationImage-555"><span class="linenos">555</span></a>    <span class="c1"># Note, we only care about the total energy for NEB images -- not the other</span>
</span><span id="MigrationImage-556"><a href="#MigrationImage-556"><span class="linenos">556</span></a>    <span class="c1"># fields that the Thermodynamics mix-in provides. This is why we set this</span>
</span><span id="MigrationImage-557"><a href="#MigrationImage-557"><span class="linenos">557</span></a>    <span class="c1"># field directly, rather than using the mix-in.</span>
</span><span id="MigrationImage-558"><a href="#MigrationImage-558"><span class="linenos">558</span></a>    <span class="n">energy</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationImage-559"><a href="#MigrationImage-559"><span class="linenos">559</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationImage-560"><a href="#MigrationImage-560"><span class="linenos">560</span></a><span class="sd">    The calculated total energy. Units are in eV. </span>
</span><span id="MigrationImage-561"><a href="#MigrationImage-561"><span class="linenos">561</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationImage-562"><a href="#MigrationImage-562"><span class="linenos">562</span></a>
</span><span id="MigrationImage-563"><a href="#MigrationImage-563"><span class="linenos">563</span></a>    <span class="n">structure_distance</span> <span class="o">=</span> <span class="n">table_column</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MigrationImage-564"><a href="#MigrationImage-564"><span class="linenos">564</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationImage-565"><a href="#MigrationImage-565"><span class="linenos">565</span></a><span class="sd">    The fingerprint distance of the image from the starting image. A smaller</span>
</span><span id="MigrationImage-566"><a href="#MigrationImage-566"><span class="linenos">566</span></a><span class="sd">    means the structures are more similar, with 0 being an exact match.</span>
</span><span id="MigrationImage-567"><a href="#MigrationImage-567"><span class="linenos">567</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MigrationImage-568"><a href="#MigrationImage-568"><span class="linenos">568</span></a>
</span><span id="MigrationImage-569"><a href="#MigrationImage-569"><span class="linenos">569</span></a>    <span class="c1"># We don&#39;t need the source column for the MigrationImage class because we</span>
</span><span id="MigrationImage-570"><a href="#MigrationImage-570"><span class="linenos">570</span></a>    <span class="c1"># instead stored the source on the DiffusionAnalysis object. This line</span>
</span><span id="MigrationImage-571"><a href="#MigrationImage-571"><span class="linenos">571</span></a>    <span class="c1"># deletes the source column from our Structure mix-in.</span>
</span><span id="MigrationImage-572"><a href="#MigrationImage-572"><span class="linenos">572</span></a>    <span class="n">source</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MigrationImage-573"><a href="#MigrationImage-573"><span class="linenos">573</span></a>
</span><span id="MigrationImage-574"><a href="#MigrationImage-574"><span class="linenos">574</span></a>    <span class="nd">@classmethod</span>
</span><span id="MigrationImage-575"><a href="#MigrationImage-575"><span class="linenos">575</span></a>    <span class="k">def</span> <span class="nf">create_subclass_from_migration_hop</span><span class="p">(</span>
</span><span id="MigrationImage-576"><a href="#MigrationImage-576"><span class="linenos">576</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="MigrationImage-577"><a href="#MigrationImage-577"><span class="linenos">577</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MigrationImage-578"><a href="#MigrationImage-578"><span class="linenos">578</span></a>        <span class="n">migration_hop</span><span class="p">:</span> <span class="n">MigrationHop</span><span class="p">,</span>
</span><span id="MigrationImage-579"><a href="#MigrationImage-579"><span class="linenos">579</span></a>        <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MigrationImage-580"><a href="#MigrationImage-580"><span class="linenos">580</span></a>        <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationImage-581"><a href="#MigrationImage-581"><span class="linenos">581</span></a>    <span class="p">):</span>
</span><span id="MigrationImage-582"><a href="#MigrationImage-582"><span class="linenos">582</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationImage-583"><a href="#MigrationImage-583"><span class="linenos">583</span></a><span class="sd">        Dynamically creates subclass of MigrationImage, then links it to the</span>
</span><span id="MigrationImage-584"><a href="#MigrationImage-584"><span class="linenos">584</span></a><span class="sd">        MigrationHop table.</span>
</span><span id="MigrationImage-585"><a href="#MigrationImage-585"><span class="linenos">585</span></a>
</span><span id="MigrationImage-586"><a href="#MigrationImage-586"><span class="linenos">586</span></a><span class="sd">        This method should NOT be called directly because it is instead used by</span>
</span><span id="MigrationImage-587"><a href="#MigrationImage-587"><span class="linenos">587</span></a><span class="sd">        `DiffusionAnalysis.create_subclasses`.</span>
</span><span id="MigrationImage-588"><a href="#MigrationImage-588"><span class="linenos">588</span></a>
</span><span id="MigrationImage-589"><a href="#MigrationImage-589"><span class="linenos">589</span></a><span class="sd">        #### Parameters</span>
</span><span id="MigrationImage-590"><a href="#MigrationImage-590"><span class="linenos">590</span></a>
</span><span id="MigrationImage-591"><a href="#MigrationImage-591"><span class="linenos">591</span></a><span class="sd">        - `name` :</span>
</span><span id="MigrationImage-592"><a href="#MigrationImage-592"><span class="linenos">592</span></a><span class="sd">            Name of the subclass that is output.</span>
</span><span id="MigrationImage-593"><a href="#MigrationImage-593"><span class="linenos">593</span></a><span class="sd">        - `migration_hop` :</span>
</span><span id="MigrationImage-594"><a href="#MigrationImage-594"><span class="linenos">594</span></a><span class="sd">            MigrationHop table that these images should be associated with.</span>
</span><span id="MigrationImage-595"><a href="#MigrationImage-595"><span class="linenos">595</span></a><span class="sd">        - `module` :</span>
</span><span id="MigrationImage-596"><a href="#MigrationImage-596"><span class="linenos">596</span></a><span class="sd">            name of the module this subclass should be associated with. Typically,</span>
</span><span id="MigrationImage-597"><a href="#MigrationImage-597"><span class="linenos">597</span></a><span class="sd">            you should pass __name__ to this.</span>
</span><span id="MigrationImage-598"><a href="#MigrationImage-598"><span class="linenos">598</span></a><span class="sd">        - `**extra_columns` :</span>
</span><span id="MigrationImage-599"><a href="#MigrationImage-599"><span class="linenos">599</span></a><span class="sd">            Additional columns to add to the table. The keyword will be the</span>
</span><span id="MigrationImage-600"><a href="#MigrationImage-600"><span class="linenos">600</span></a><span class="sd">            column name and the value should match django options</span>
</span><span id="MigrationImage-601"><a href="#MigrationImage-601"><span class="linenos">601</span></a><span class="sd">            (e.g. table_column.FloatField())</span>
</span><span id="MigrationImage-602"><a href="#MigrationImage-602"><span class="linenos">602</span></a>
</span><span id="MigrationImage-603"><a href="#MigrationImage-603"><span class="linenos">603</span></a><span class="sd">        #### Returns</span>
</span><span id="MigrationImage-604"><a href="#MigrationImage-604"><span class="linenos">604</span></a>
</span><span id="MigrationImage-605"><a href="#MigrationImage-605"><span class="linenos">605</span></a><span class="sd">        - `NewClass` :</span>
</span><span id="MigrationImage-606"><a href="#MigrationImage-606"><span class="linenos">606</span></a><span class="sd">            A subclass of MigrationImage.</span>
</span><span id="MigrationImage-607"><a href="#MigrationImage-607"><span class="linenos">607</span></a>
</span><span id="MigrationImage-608"><a href="#MigrationImage-608"><span class="linenos">608</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MigrationImage-609"><a href="#MigrationImage-609"><span class="linenos">609</span></a>
</span><span id="MigrationImage-610"><a href="#MigrationImage-610"><span class="linenos">610</span></a>        <span class="n">NewClass</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_subclass</span><span class="p">(</span>
</span><span id="MigrationImage-611"><a href="#MigrationImage-611"><span class="linenos">611</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">MigrationImage&quot;</span><span class="p">,</span>
</span><span id="MigrationImage-612"><a href="#MigrationImage-612"><span class="linenos">612</span></a>            <span class="n">migration_hop</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
</span><span id="MigrationImage-613"><a href="#MigrationImage-613"><span class="linenos">613</span></a>                <span class="n">migration_hop</span><span class="p">,</span>
</span><span id="MigrationImage-614"><a href="#MigrationImage-614"><span class="linenos">614</span></a>                <span class="n">on_delete</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
</span><span id="MigrationImage-615"><a href="#MigrationImage-615"><span class="linenos">615</span></a>                <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;migration_images&quot;</span><span class="p">,</span>
</span><span id="MigrationImage-616"><a href="#MigrationImage-616"><span class="linenos">616</span></a>            <span class="p">),</span>
</span><span id="MigrationImage-617"><a href="#MigrationImage-617"><span class="linenos">617</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="MigrationImage-618"><a href="#MigrationImage-618"><span class="linenos">618</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationImage-619"><a href="#MigrationImage-619"><span class="linenos">619</span></a>        <span class="p">)</span>
</span><span id="MigrationImage-620"><a href="#MigrationImage-620"><span class="linenos">620</span></a>
</span><span id="MigrationImage-621"><a href="#MigrationImage-621"><span class="linenos">621</span></a>        <span class="k">return</span> <span class="n">NewClass</span>
</span></pre></div>


            <div class="docstring"><p>The base class for defining a table in the Simmate database. All tables and
mixins inherit from this class.</p>

<p>Usage is identical to
<a href="https://docs.djangoproject.com/en/4.0/#the-model-layer">models in Django</a>
where this class only adds extra methods for convenience.</p>
</div>


                            <div id="MigrationImage.base_info" class="classattr">
                                <div class="attr variable">
            <span class="name">base_info</span><span class="annotation">: List[str]</span><span class="default_value"> = [&#39;number&#39;, &#39;structure_string&#39;, &#39;force_tangent&#39;, &#39;structure_distance&#39;, &#39;energy&#39;]</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.base_info"></a>
    
            <div class="docstring"><p>The base information for this database table and only these fields are stored
when the <code>to_archive</code> method is used. Using the columns in this list, all 
other columns for this table can be calculated, so the columns in this list 
are effectively the "raw data".</p>
</div>


                            </div>
                            <div id="MigrationImage.number" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">number</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.number"></a>
    
            <div class="docstring"><p>The image number. Note, the starting image is always 0 and the ending
image is always -1. The choice of -1 is because we often add the ending
image to the database table before knowing how many midpoint images we
are going to create.</p>
</div>


                            </div>
                            <div id="MigrationImage.force_tangent" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">force_tangent</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.force_tangent"></a>
    
            <div class="docstring"><p>The tangent force of image. Not to be confused with forces from the Forces mix-in.</p>
</div>


                            </div>
                            <div id="MigrationImage.energy" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">energy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.energy"></a>
    
            <div class="docstring"><p>The calculated total energy. Units are in eV.</p>
</div>


                            </div>
                            <div id="MigrationImage.structure_distance" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">structure_distance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.structure_distance"></a>
    
            <div class="docstring"><p>The fingerprint distance of the image from the starting image. A smaller
means the structures are more similar, with 0 being an exact match.</p>
</div>


                            </div>
                            <div id="MigrationImage.source" class="classattr">
                                <div class="attr variable">
            <span class="name">source</span><span class="default_value"> = None</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.source"></a>
    
            <div class="docstring"><blockquote>
  <p>Note, this field is highly experimental at the moment and subject to
  change.</p>
</blockquote>

<p>This column indicates where the data came from, and it could be a number 
of things including...</p>

<ul>
<li>a third party id</li>
<li>a structure from a different Simmate datbase table</li>
<li>a transformation of another structure</li>
<li>a creation method</li>
<li>a custom submission by the user</li>
</ul>

<p>By default, this is a JSON field to account for all scenarios, but some
tables (such as those in <code><a href="../third_parties.html">simmate.database.third_parties</a></code>) this is value
should be the same for ALL entries in the table and therefore the column is
overwritten as an attribute.</p>

<p>For other tables where this is not a constant, here are some examples of
values used in this column:</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="c1"># from a thirdparty database or separate table</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;MatprojStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;mp-123&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># from a random structure creator</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;PyXtalStructure&quot;</span><span class="p">}</span>

<span class="c1"># from a templated structure creator (e.g. substituition or prototypes)</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;PrototypeStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;AFLOWPrototypes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># from a transformation</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;MirrorMutation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;MatprojStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;mp-123&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># from a multi-structure transformation</span>
<span class="n">source</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;HereditaryMutation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;MatprojStructure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mp-123&quot;</span><span class="p">,</span> <span class="s2">&quot;mp-321&quot;</span><span class="p">],</span>
<span class="p">}</span>
</code></pre></div>
</div>


                            </div>
                            <div id="MigrationImage.create_subclass_from_migration_hop" class="classattr">
                                        <input id="MigrationImage.create_subclass_from_migration_hop-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">create_subclass_from_migration_hop</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">migration_hop</span><span class="p">:</span> <span class="n"><a href="#MigrationHop">simmate.database.base_data_types.nudged_elastic_band.MigrationHop</a></span>,</span><span class="param">	<span class="n">module</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">**</span><span class="n">extra_columns</span></span>)</span>

                <label class="view-source-button" for="MigrationImage.create_subclass_from_migration_hop-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MigrationImage.create_subclass_from_migration_hop"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MigrationImage.create_subclass_from_migration_hop-574"><a href="#MigrationImage.create_subclass_from_migration_hop-574"><span class="linenos">574</span></a>    <span class="nd">@classmethod</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-575"><a href="#MigrationImage.create_subclass_from_migration_hop-575"><span class="linenos">575</span></a>    <span class="k">def</span> <span class="nf">create_subclass_from_migration_hop</span><span class="p">(</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-576"><a href="#MigrationImage.create_subclass_from_migration_hop-576"><span class="linenos">576</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-577"><a href="#MigrationImage.create_subclass_from_migration_hop-577"><span class="linenos">577</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-578"><a href="#MigrationImage.create_subclass_from_migration_hop-578"><span class="linenos">578</span></a>        <span class="n">migration_hop</span><span class="p">:</span> <span class="n">MigrationHop</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-579"><a href="#MigrationImage.create_subclass_from_migration_hop-579"><span class="linenos">579</span></a>        <span class="n">module</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-580"><a href="#MigrationImage.create_subclass_from_migration_hop-580"><span class="linenos">580</span></a>        <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-581"><a href="#MigrationImage.create_subclass_from_migration_hop-581"><span class="linenos">581</span></a>    <span class="p">):</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-582"><a href="#MigrationImage.create_subclass_from_migration_hop-582"><span class="linenos">582</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-583"><a href="#MigrationImage.create_subclass_from_migration_hop-583"><span class="linenos">583</span></a><span class="sd">        Dynamically creates subclass of MigrationImage, then links it to the</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-584"><a href="#MigrationImage.create_subclass_from_migration_hop-584"><span class="linenos">584</span></a><span class="sd">        MigrationHop table.</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-585"><a href="#MigrationImage.create_subclass_from_migration_hop-585"><span class="linenos">585</span></a>
</span><span id="MigrationImage.create_subclass_from_migration_hop-586"><a href="#MigrationImage.create_subclass_from_migration_hop-586"><span class="linenos">586</span></a><span class="sd">        This method should NOT be called directly because it is instead used by</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-587"><a href="#MigrationImage.create_subclass_from_migration_hop-587"><span class="linenos">587</span></a><span class="sd">        `DiffusionAnalysis.create_subclasses`.</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-588"><a href="#MigrationImage.create_subclass_from_migration_hop-588"><span class="linenos">588</span></a>
</span><span id="MigrationImage.create_subclass_from_migration_hop-589"><a href="#MigrationImage.create_subclass_from_migration_hop-589"><span class="linenos">589</span></a><span class="sd">        #### Parameters</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-590"><a href="#MigrationImage.create_subclass_from_migration_hop-590"><span class="linenos">590</span></a>
</span><span id="MigrationImage.create_subclass_from_migration_hop-591"><a href="#MigrationImage.create_subclass_from_migration_hop-591"><span class="linenos">591</span></a><span class="sd">        - `name` :</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-592"><a href="#MigrationImage.create_subclass_from_migration_hop-592"><span class="linenos">592</span></a><span class="sd">            Name of the subclass that is output.</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-593"><a href="#MigrationImage.create_subclass_from_migration_hop-593"><span class="linenos">593</span></a><span class="sd">        - `migration_hop` :</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-594"><a href="#MigrationImage.create_subclass_from_migration_hop-594"><span class="linenos">594</span></a><span class="sd">            MigrationHop table that these images should be associated with.</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-595"><a href="#MigrationImage.create_subclass_from_migration_hop-595"><span class="linenos">595</span></a><span class="sd">        - `module` :</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-596"><a href="#MigrationImage.create_subclass_from_migration_hop-596"><span class="linenos">596</span></a><span class="sd">            name of the module this subclass should be associated with. Typically,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-597"><a href="#MigrationImage.create_subclass_from_migration_hop-597"><span class="linenos">597</span></a><span class="sd">            you should pass __name__ to this.</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-598"><a href="#MigrationImage.create_subclass_from_migration_hop-598"><span class="linenos">598</span></a><span class="sd">        - `**extra_columns` :</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-599"><a href="#MigrationImage.create_subclass_from_migration_hop-599"><span class="linenos">599</span></a><span class="sd">            Additional columns to add to the table. The keyword will be the</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-600"><a href="#MigrationImage.create_subclass_from_migration_hop-600"><span class="linenos">600</span></a><span class="sd">            column name and the value should match django options</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-601"><a href="#MigrationImage.create_subclass_from_migration_hop-601"><span class="linenos">601</span></a><span class="sd">            (e.g. table_column.FloatField())</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-602"><a href="#MigrationImage.create_subclass_from_migration_hop-602"><span class="linenos">602</span></a>
</span><span id="MigrationImage.create_subclass_from_migration_hop-603"><a href="#MigrationImage.create_subclass_from_migration_hop-603"><span class="linenos">603</span></a><span class="sd">        #### Returns</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-604"><a href="#MigrationImage.create_subclass_from_migration_hop-604"><span class="linenos">604</span></a>
</span><span id="MigrationImage.create_subclass_from_migration_hop-605"><a href="#MigrationImage.create_subclass_from_migration_hop-605"><span class="linenos">605</span></a><span class="sd">        - `NewClass` :</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-606"><a href="#MigrationImage.create_subclass_from_migration_hop-606"><span class="linenos">606</span></a><span class="sd">            A subclass of MigrationImage.</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-607"><a href="#MigrationImage.create_subclass_from_migration_hop-607"><span class="linenos">607</span></a>
</span><span id="MigrationImage.create_subclass_from_migration_hop-608"><a href="#MigrationImage.create_subclass_from_migration_hop-608"><span class="linenos">608</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-609"><a href="#MigrationImage.create_subclass_from_migration_hop-609"><span class="linenos">609</span></a>
</span><span id="MigrationImage.create_subclass_from_migration_hop-610"><a href="#MigrationImage.create_subclass_from_migration_hop-610"><span class="linenos">610</span></a>        <span class="n">NewClass</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_subclass</span><span class="p">(</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-611"><a href="#MigrationImage.create_subclass_from_migration_hop-611"><span class="linenos">611</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">MigrationImage&quot;</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-612"><a href="#MigrationImage.create_subclass_from_migration_hop-612"><span class="linenos">612</span></a>            <span class="n">migration_hop</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-613"><a href="#MigrationImage.create_subclass_from_migration_hop-613"><span class="linenos">613</span></a>                <span class="n">migration_hop</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-614"><a href="#MigrationImage.create_subclass_from_migration_hop-614"><span class="linenos">614</span></a>                <span class="n">on_delete</span><span class="o">=</span><span class="n">table_column</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-615"><a href="#MigrationImage.create_subclass_from_migration_hop-615"><span class="linenos">615</span></a>                <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;migration_images&quot;</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-616"><a href="#MigrationImage.create_subclass_from_migration_hop-616"><span class="linenos">616</span></a>            <span class="p">),</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-617"><a href="#MigrationImage.create_subclass_from_migration_hop-617"><span class="linenos">617</span></a>            <span class="n">module</span><span class="o">=</span><span class="n">module</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-618"><a href="#MigrationImage.create_subclass_from_migration_hop-618"><span class="linenos">618</span></a>            <span class="o">**</span><span class="n">extra_columns</span><span class="p">,</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-619"><a href="#MigrationImage.create_subclass_from_migration_hop-619"><span class="linenos">619</span></a>        <span class="p">)</span>
</span><span id="MigrationImage.create_subclass_from_migration_hop-620"><a href="#MigrationImage.create_subclass_from_migration_hop-620"><span class="linenos">620</span></a>
</span><span id="MigrationImage.create_subclass_from_migration_hop-621"><a href="#MigrationImage.create_subclass_from_migration_hop-621"><span class="linenos">621</span></a>        <span class="k">return</span> <span class="n">NewClass</span>
</span></pre></div>


            <div class="docstring"><p>Dynamically creates subclass of MigrationImage, then links it to the
MigrationHop table.</p>

<p>This method should NOT be called directly because it is instead used by
<code><a href="#DiffusionAnalysis.create_subclasses">DiffusionAnalysis.create_subclasses</a></code>.</p>

<h4 id="parameters">Parameters</h4>

<ul>
<li><code>name</code> :
Name of the subclass that is output.</li>
<li><code>migration_hop</code> :
MigrationHop table that these images should be associated with.</li>
<li><code>module</code> :
name of the module this subclass should be associated with. Typically,
you should pass __name__ to this.</li>
<li><code>**extra_columns</code> :
Additional columns to add to the table. The keyword will be the
column name and the value should match django options
(e.g. table_column.FloatField())</li>
</ul>

<h4 id="returns">Returns</h4>

<ul>
<li><code>NewClass</code> :
A subclass of MigrationImage.</li>
</ul>
</div>


                            </div>
                            <div id="MigrationImage.structure_string" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">structure_string</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.structure_string"></a>
    
            <div class="docstring"><p>The core structure information, which is written to a string and in a 
compressed format using the <code><a href="#MigrationImage.from_toolkit">from_toolkit</a></code> method. To get back to our toolkit
structure object, use the <code><a href="#MigrationImage.to_toolkit">to_toolkit</a></code> method.</p>
</div>


                            </div>
                            <div id="MigrationImage.nsites" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nsites</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.nsites"></a>
    
            <div class="docstring"><p>The total number of sites in the unitcell. (e.g. Y2CF2 has 5 sites)</p>
</div>


                            </div>
                            <div id="MigrationImage.nelements" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nelements</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.nelements"></a>
    
            <div class="docstring"><p>The total number of unique elements. (e.g. Y2CF2 has 3 elements)</p>
</div>


                            </div>
                            <div id="MigrationImage.elements" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">elements</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.elements"></a>
    
            <div class="docstring"><p>List of elements in the structure (ex: ["Y", "C", "F"])</p>
</div>


                            </div>
                            <div id="MigrationImage.chemical_system" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">chemical_system</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.chemical_system"></a>
    
            <div class="docstring"><p>the base chemical system (ex: "Y-C-F")</p>

<p>Note: be careful when searching for elements! Running chemical_system__contains="C"
on this field won't do what you expect -- because it will return structures
containing Ca, Cs, Ce, Cl, and so on. If you want to search for structures
that contain a specific element, use elements__contains='"C"' instead. The
odd use of quotes '"C"' is required here!</p>
</div>


                            </div>
                            <div id="MigrationImage.density" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">density</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.density"></a>
    
            <div class="docstring"><p>The density of the crystal in g/cm^3</p>
</div>


                            </div>
                            <div id="MigrationImage.density_atomic" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">density_atomic</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.density_atomic"></a>
    
            <div class="docstring"><p>The density of atoms in the crystal in atoms/Angstom^3</p>
</div>


                            </div>
                            <div id="MigrationImage.volume" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">volume</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.volume"></a>
    
            <div class="docstring"><p>The volume of the unitcell in Angstom^3</p>

<p>Note: in most cases, <code><a href="#MigrationImage.volume_molar">volume_molar</a></code> should be used instead! This is because
volumne is highly dependent on the symmetry and the arbitray unitcell. If 
you are truly after small volumes of the unitcell, it is likely you really 
just want to search by spacegroup.</p>
</div>


                            </div>
                            <div id="MigrationImage.volume_molar" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">volume_molar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.volume_molar"></a>
    
            <div class="docstring"><p>The molar volume of the crystal in cm^3/mol</p>
</div>


                            </div>
                            <div id="MigrationImage.formula_full" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">formula_full</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.formula_full"></a>
    
            <div class="docstring"><p>The chemical formula with elements sorted by electronegativity (ex: Li4 Fe4 P4 O16)</p>
</div>


                            </div>
                            <div id="MigrationImage.formula_reduced" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">formula_reduced</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.formula_reduced"></a>
    
            <div class="docstring"><p>The reduced chemical formula. (ex: Li4Fe4P4O16 --> LiFePO4)</p>
</div>


                            </div>
                            <div id="MigrationImage.formula_anonymous" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">formula_anonymous</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.formula_anonymous"></a>
    
            <div class="docstring"><p>An anonymized formula. Unique species are arranged in ordering of 
amounts and assigned ascending alphabets. Useful for prototyping formulas. 
For example, all stoichiometric perovskites have anonymized_formula ABC3.</p>
</div>


                            </div>
                            <div id="MigrationImage.spacegroup" class="classattr">
                                <div class="attr variable">
            <span class="name">spacegroup</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.spacegroup"></a>
    
            <div class="docstring"><p>Spacegroup information. Points to a separate database table that has additional
columns:
<code><a href="symmetry.html#Spacegroup">simmate.database.base_data_types.symmetry.Spacegroup</a></code></p>
</div>


                            </div>
                            <div id="MigrationImage.created_at" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">created_at</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.created_at"></a>
    
            <div class="docstring"><p>Timestamp of when this row was first added to the database table</p>
</div>


                            </div>
                            <div id="MigrationImage.updated_at" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">updated_at</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.updated_at"></a>
    
            <div class="docstring"><p>Timestamp of when this row was was lasted changed / updated</p>
</div>


                            </div>
                            <div id="MigrationImage.spacegroup_id" class="classattr">
                                <div class="attr variable">
            <span class="name">spacegroup_id</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.spacegroup_id"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>django.db.models.base.Model</dt>
                                <dd id="MigrationImage.__init__" class="function">Model</dd>
                <dd id="MigrationImage.from_db" class="function">from_db</dd>
                <dd id="MigrationImage.pk" class="variable">pk</dd>
                <dd id="MigrationImage.get_deferred_fields" class="function">get_deferred_fields</dd>
                <dd id="MigrationImage.refresh_from_db" class="function">refresh_from_db</dd>
                <dd id="MigrationImage.serializable_value" class="function">serializable_value</dd>
                <dd id="MigrationImage.save" class="function">save</dd>
                <dd id="MigrationImage.save_base" class="function">save_base</dd>
                <dd id="MigrationImage.delete" class="function">delete</dd>
                <dd id="MigrationImage.prepare_database_save" class="function">prepare_database_save</dd>
                <dd id="MigrationImage.clean" class="function">clean</dd>
                <dd id="MigrationImage.validate_unique" class="function">validate_unique</dd>
                <dd id="MigrationImage.date_error_message" class="function">date_error_message</dd>
                <dd id="MigrationImage.unique_error_message" class="function">unique_error_message</dd>
                <dd id="MigrationImage.full_clean" class="function">full_clean</dd>
                <dd id="MigrationImage.clean_fields" class="function">clean_fields</dd>
                <dd id="MigrationImage.check" class="function">check</dd>

            </div>
            <div><dt><a href="structure.html#Structure">simmate.database.base_data_types.structure.Structure</a></dt>
                                <dd id="MigrationImage.to_toolkit" class="function"><a href="structure.html#Structure.to_toolkit">to_toolkit</a></dd>

            </div>
            <div><dt><a href="base.html#DatabaseTable">simmate.database.base_data_types.base.DatabaseTable</a></dt>
                                <dd id="MigrationImage.source_doi" class="variable"><a href="base.html#DatabaseTable.source_doi">source_doi</a></dd>
                <dd id="MigrationImage.remote_archive_link" class="variable"><a href="base.html#DatabaseTable.remote_archive_link">remote_archive_link</a></dd>
                <dd id="MigrationImage.objects" class="function"><a href="base.html#DatabaseTable.objects">objects</a></dd>
                <dd id="MigrationImage.get_table_name" class="function"><a href="base.html#DatabaseTable.get_table_name">get_table_name</a></dd>
                <dd id="MigrationImage.create_subclass" class="function"><a href="base.html#DatabaseTable.create_subclass">create_subclass</a></dd>
                <dd id="MigrationImage.from_toolkit" class="function"><a href="base.html#DatabaseTable.from_toolkit">from_toolkit</a></dd>
                <dd id="MigrationImage.update_from_toolkit" class="function"><a href="base.html#DatabaseTable.update_from_toolkit">update_from_toolkit</a></dd>
                <dd id="MigrationImage.load_archive" class="function"><a href="base.html#DatabaseTable.load_archive">load_archive</a></dd>
                <dd id="MigrationImage.load_remote_archive" class="function"><a href="base.html#DatabaseTable.load_remote_archive">load_remote_archive</a></dd>
                <dd id="MigrationImage.get_column_names" class="function"><a href="base.html#DatabaseTable.get_column_names">get_column_names</a></dd>
                <dd id="MigrationImage.show_columns" class="function"><a href="base.html#DatabaseTable.show_columns">show_columns</a></dd>
                <dd id="MigrationImage.get_mixins" class="function"><a href="base.html#DatabaseTable.get_mixins">get_mixins</a></dd>
                <dd id="MigrationImage.get_mixin_names" class="function"><a href="base.html#DatabaseTable.get_mixin_names">get_mixin_names</a></dd>
                <dd id="MigrationImage.get_extra_columns" class="function"><a href="base.html#DatabaseTable.get_extra_columns">get_extra_columns</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MigrationImage.Meta">
                            <input id="MigrationImage.Meta-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MigrationImage.Meta</span>:

                <label class="view-source-button" for="MigrationImage.Meta-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MigrationImage.Meta"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MigrationImage.Meta-530"><a href="#MigrationImage.Meta-530"><span class="linenos">530</span></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
</span><span id="MigrationImage.Meta-531"><a href="#MigrationImage.Meta-531"><span class="linenos">531</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MigrationImage.Meta-532"><a href="#MigrationImage.Meta-532"><span class="linenos">532</span></a>        <span class="n">app_label</span> <span class="o">=</span> <span class="s2">&quot;workflows&quot;</span>
</span></pre></div>


    

                            <div id="MigrationImage.Meta.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">MigrationImage.Meta</span><span class="signature pdoc-code condensed">()</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.Meta.__init__"></a>
    
    

                            </div>
                            <div id="MigrationImage.Meta.abstract" class="classattr">
                                <div class="attr variable">
            <span class="name">abstract</span><span class="default_value"> = False</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.Meta.abstract"></a>
    
    

                            </div>
                            <div id="MigrationImage.Meta.app_label" class="classattr">
                                <div class="attr variable">
            <span class="name">app_label</span><span class="default_value"> = &#39;workflows&#39;</span>

        
    </div>
    <a class="headerlink" href="#MigrationImage.Meta.app_label"></a>
    
    

                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>