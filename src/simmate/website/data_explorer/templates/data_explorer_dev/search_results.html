{% load humanize %}
<div id="search-results" class="row">
    {% if page.object_list %}
        {% load chemical_formula_filter %}
        <div class="alert alert-primary d-flex align-items-center mt-2"
             role="alert">
            <i class="mdi mdi-check-circle"></i>&nbsp;&nbsp;
            <div>
                Showing <b>{{ page.start_index }}-{{ page.end_index }}</b> of
                {% with total=page.paginator.count %}
                    <b>
                        {# linting is disabled for this line to stop it from adding a space #}
                        {# djlint:off #}
                            {% if total == 10000 %}&gt;{% endif %}{{ total|intcomma }}
                        
                        {# djlint:on #}
                    </b> filtered results.
                    {% if total == 10000 %}
                        We limit searches to 10k results for our Web UI and API. Switch to Python or SQL if you need the full dataset.
                    {% endif %}
                    {# (total counts too slow) The full dataset has <b>{{ ncalculations_possible|intcomma }}</b> entries. #}
                {% endwith %}
            </div>
        </div>
        {% if "Structure" in filterset_mixins %}
            <table id="SearchResultsTable"
                   class="table table-striped"
                   style="width:100%">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Dashboards</th>
                        <th>Full Formula</th>
                        <th>Spacegroup</th>
                        <th>Density</th>
                    </tr>
                </thead>
                <tbody>
                    {% for calculation in calculations %}
                        <tr>
                            <td>{{ calculation.id }}</td>
                            <td>
                                <a href="{{ calculation.id }}">simmate</a> / <a href="{{ calculation.external_link }}" target="_blank">provider</a>
                            </td>
                            <td>{{ calculation.formula_full | chemical_formula }}</td>
                            <td>{{ calculation.spacegroup.number }}</td>
                            <td>{{ calculation.density | floatformat:3 }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
        {% if "Molecule" in filterset_mixins %}
            {% for calculation in calculations %}
                <div class="col-auto">
                    <div class="card border-secondary border ribbon-box" style="width: 12rem;">
                        <div class="card-body">
                            <div class="row">
                                <div class="py-1 text-light bg-primary text-center fw-bold rounded col-12">id = {{ calculation.id }}</div>
                            </div>
                            <div class="row text-center my-2">
                                <div class="col-12">
                                    <script>doodle_molecule('{{ calculation.sdf_str }}', {{ calculation.id }}, 100)</script>
                                </div>
                            </div>
                            <div class="row text-center">
                                <div class="col">
                                    <a role="button"
                                       class="btn btn-outline-primary btn-sm"
                                       href="{{ calculation.id }}">View  <i class="mdi mdi-open-in-new"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
        {% include "data_explorer_dev/pagination.html" %}
    {% else %}
        <div class="alert alert-danger d-flex align-items-center p-2" role="alert">
            <div>
                <i class="mdi mdi-alert-circle"></i>&nbsp;&nbsp;<b>No entries were found that match your search criteria!</b>
            </div>
        </div>
    {% endif %}
</div>
